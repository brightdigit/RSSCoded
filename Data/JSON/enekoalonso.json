{
  "version": "https://jsonfeed.org/version/1",
  "title": "enekoalonso.com",
  "home_page_url": "https://www.enekoalonso.com/",
  "description": "You are reading An Over-Engineered Blog, the personal site of Eneko Alonso. All content included and any opinions expressed on this site are personal and do not represent any of his current or past employers.",
  "items": [
    {
      "guid": "https://www.enekoalonso.com/articles/writing-aws-sqs-producers-and-consumers-in-swift-demo-",
      "url": "https://www.enekoalonso.com/articles/writing-aws-sqs-producers-and-consumers-in-swift-demo-",
      "title": "Writing AWS SQS producers and consumers in Swift (Demo)",
      "content_html": "<p>I published on GitHub an example of an <a href=\"https://github.com/eneko/SQS-Swift-Demo\">AWS SQS producer and consumer application written in Swift</a>.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/108947754-f747ca00-7615-11eb-937d-a39b92e7077a.png\" alt=\"hero\" /></p>\n\n<p>This demo is pretty simple, but illustrates how to send messages to SQS and how to poll for messages.</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>┌──────────────────┐        ┌──────────────────────┐        ┌──────────────────┐\n│                  │        │         AWS          │        │                  │\n│     Producer     │───────▶│ Simple Queue Service │───────▶│     Consumer     │\n│                  │        │                      │        │                  │\n└──────────────────┘        └──────────────────────┘        └──────────────────┘\n</code></pre></div></div>\n\n<p>SQS is an amazing service from AWS, with many cool features, including:</p>\n<ul>\n  <li>Message retention: messages are persisted on disk, until a consumer reads the message (not forever, there is a retention window)</li>\n  <li>Multiple consumers can read from the queue to parallelize and distribute work loads</li>\n  <li>Multiple producers can queue messages, which can be buffered until consumers are able to process them</li>\n  <li>Messages can be out of order, or sequential (FIFO)</li>\n</ul>\n\n<h2 id=\"producer\">Producer</h2>\n\n<p>The producer cli takes arguments from the command line to send messages:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">import</span> <span class=\"kt\">SotoSQS</span>\n\n<span class=\"k\">let</span> <span class=\"nv\">arguments</span> <span class=\"o\">=</span> <span class=\"kt\">ProcessInfo</span><span class=\"o\">.</span><span class=\"n\">processInfo</span><span class=\"o\">.</span><span class=\"n\">arguments</span>\n<span class=\"k\">guard</span> <span class=\"n\">arguments</span><span class=\"o\">.</span><span class=\"n\">count</span> <span class=\"o\">&gt;</span> <span class=\"mi\">1</span> <span class=\"k\">else</span> <span class=\"p\">{</span>\n    <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"s\">\"Nothing to send\"</span><span class=\"p\">)</span>\n    <span class=\"nf\">exit</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">let</span> <span class=\"nv\">client</span> <span class=\"o\">=</span> <span class=\"kt\">AWSClient</span><span class=\"p\">(</span><span class=\"nv\">httpClientProvider</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">createNew</span><span class=\"p\">)</span>\n<span class=\"k\">defer</span> <span class=\"p\">{</span> <span class=\"k\">try</span><span class=\"p\">?</span> <span class=\"n\">client</span><span class=\"o\">.</span><span class=\"nf\">syncShutdown</span><span class=\"p\">()</span> <span class=\"p\">}</span>\n<span class=\"k\">let</span> <span class=\"nv\">sqs</span> <span class=\"o\">=</span> <span class=\"kt\">SQS</span><span class=\"p\">(</span><span class=\"nv\">client</span><span class=\"p\">:</span> <span class=\"n\">client</span><span class=\"p\">,</span> <span class=\"nv\">region</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">uswest2</span><span class=\"p\">)</span>\n<span class=\"k\">let</span> <span class=\"nv\">queue</span> <span class=\"o\">=</span> <span class=\"s\">\"https://sqs.us-west-2.amazonaws.com/&lt;account&gt;/sqs-swift-demo\"</span>\n\n<span class=\"k\">for</span> <span class=\"n\">message</span> <span class=\"k\">in</span> <span class=\"n\">arguments</span><span class=\"o\">.</span><span class=\"nf\">dropFirst</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">input</span> <span class=\"o\">=</span> <span class=\"kt\">SQS</span><span class=\"o\">.</span><span class=\"kt\">SendMessageRequest</span><span class=\"p\">(</span><span class=\"nv\">messageBody</span><span class=\"p\">:</span> <span class=\"n\">message</span><span class=\"p\">,</span> <span class=\"nv\">queueUrl</span><span class=\"p\">:</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n    <span class=\"k\">let</span> <span class=\"nv\">result</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"n\">sqs</span><span class=\"o\">.</span><span class=\"nf\">sendMessage</span><span class=\"p\">(</span><span class=\"n\">input</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">wait</span><span class=\"p\">()</span>\n    <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">result</span><span class=\"o\">.</span><span class=\"n\">messageId</span> <span class=\"p\">??</span> <span class=\"s\">\"[No id]\"</span><span class=\"p\">)</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<h2 id=\"consumer\">Consumer</h2>\n\n<p>The consumer cli loops forever, waiting for messages to arrive.</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">import</span> <span class=\"kt\">SotoSQS</span>\n\n<span class=\"k\">let</span> <span class=\"nv\">client</span> <span class=\"o\">=</span> <span class=\"kt\">AWSClient</span><span class=\"p\">(</span><span class=\"nv\">httpClientProvider</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">createNew</span><span class=\"p\">)</span>\n<span class=\"k\">defer</span> <span class=\"p\">{</span> <span class=\"k\">try</span><span class=\"p\">?</span> <span class=\"n\">client</span><span class=\"o\">.</span><span class=\"nf\">syncShutdown</span><span class=\"p\">()</span> <span class=\"p\">}</span>\n<span class=\"k\">let</span> <span class=\"nv\">sqs</span> <span class=\"o\">=</span> <span class=\"kt\">SQS</span><span class=\"p\">(</span><span class=\"nv\">client</span><span class=\"p\">:</span> <span class=\"n\">client</span><span class=\"p\">,</span> <span class=\"nv\">region</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">uswest2</span><span class=\"p\">)</span>\n<span class=\"k\">let</span> <span class=\"nv\">queue</span> <span class=\"o\">=</span> <span class=\"s\">\"https://sqs.us-west-2.amazonaws.com/&lt;account&gt;/sqs-swift-demo\"</span>\n\n<span class=\"c1\">// Poll for messages, waiting for up to 10 seconds</span>\n<span class=\"k\">let</span> <span class=\"nv\">request</span> <span class=\"o\">=</span> <span class=\"kt\">SQS</span><span class=\"o\">.</span><span class=\"kt\">ReceiveMessageRequest</span><span class=\"p\">(</span><span class=\"nv\">queueUrl</span><span class=\"p\">:</span> <span class=\"n\">queue</span><span class=\"p\">,</span> <span class=\"nv\">waitTimeSeconds</span><span class=\"p\">:</span> <span class=\"mi\">10</span><span class=\"p\">)</span>\n\n<span class=\"c1\">// Fetch messages forever, until interrupted or terminated</span>\n<span class=\"k\">while</span> <span class=\"kc\">true</span> <span class=\"p\">{</span>\n    <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"s\">\"Polling for messages...\"</span><span class=\"p\">)</span>\n    <span class=\"k\">let</span> <span class=\"nv\">result</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"n\">sqs</span><span class=\"o\">.</span><span class=\"nf\">receiveMessage</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">wait</span><span class=\"p\">()</span>\n    <span class=\"k\">for</span> <span class=\"n\">message</span> <span class=\"k\">in</span> <span class=\"n\">result</span><span class=\"o\">.</span><span class=\"n\">messages</span> <span class=\"p\">??</span> <span class=\"p\">[]</span> <span class=\"p\">{</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"s\">\"Message Id:\"</span><span class=\"p\">,</span> <span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">messageId</span> <span class=\"p\">??</span> <span class=\"s\">\"[no id]\"</span><span class=\"p\">)</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"s\">\"Content:\"</span><span class=\"p\">,</span> <span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">body</span> <span class=\"p\">??</span> <span class=\"s\">\"[no message]\"</span><span class=\"p\">)</span>\n\n        <span class=\"k\">if</span> <span class=\"k\">let</span> <span class=\"nv\">handle</span> <span class=\"o\">=</span> <span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">receiptHandle</span> <span class=\"p\">{</span>\n            <span class=\"k\">let</span> <span class=\"nv\">deleteRequest</span> <span class=\"o\">=</span> <span class=\"kt\">SQS</span><span class=\"o\">.</span><span class=\"kt\">DeleteMessageRequest</span><span class=\"p\">(</span><span class=\"nv\">queueUrl</span><span class=\"p\">:</span> <span class=\"n\">queue</span><span class=\"p\">,</span> <span class=\"nv\">receiptHandle</span><span class=\"p\">:</span> <span class=\"n\">handle</span><span class=\"p\">)</span>\n            <span class=\"n\">_</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"n\">sqs</span><span class=\"o\">.</span><span class=\"nf\">deleteMessage</span><span class=\"p\">(</span><span class=\"n\">deleteRequest</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">wait</span><span class=\"p\">()</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/27\">Issue #27</a>)</p>\n    <p>First draft: 2021-02-23</p>\n    <p>Published on: 2021-02-23</p>\n    <p>Last update: 2021-02-23</p>\n</div>",
      "summary": "<p>I published on GitHub an example of an <a href=\"https://github.com/eneko/SQS-Swift-Demo\">AWS SQS producer and consumer application written in Swift</a>.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/108947754-f747ca00-7615-11eb-937d-a39b92e7077a.png\" alt=\"hero\" /></p>\n\n<p>This demo is pretty simple, but illustrates how to send messages to SQS and how to poll for messages.</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>┌──────────────────┐        ┌──────────────────────┐        ┌──────────────────┐\n│                  │        │         AWS          │        │                  │\n│     Producer     │───────▶│ Simple Queue Service │───────▶│     Consumer     │\n│                  │        │                      │        │                  │\n└──────────────────┘        └──────────────────────┘        └──────────────────┘\n</code></pre></div></div>\n\n<p>SQS is an amazing service from AWS, with many cool features, including:</p>\n<ul>\n  <li>Message retention: messages are persisted on disk, until a consumer reads the message (not forever, there is a retention window)</li>\n  <li>Multiple consumers can read from the queue to parallelize and distribute work loads</li>\n  <li>Multiple producers can queue messages, which can be buffered until consumers are able to process them</li>\n  <li>Messages can be out of order, or sequential (FIFO)</li>\n</ul>\n\n<h2 id=\"producer\">Producer</h2>\n\n<p>The producer cli takes arguments from the command line to send messages:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">import</span> <span class=\"kt\">SotoSQS</span>\n\n<span class=\"k\">let</span> <span class=\"nv\">arguments</span> <span class=\"o\">=</span> <span class=\"kt\">ProcessInfo</span><span class=\"o\">.</span><span class=\"n\">processInfo</span><span class=\"o\">.</span><span class=\"n\">arguments</span>\n<span class=\"k\">guard</span> <span class=\"n\">arguments</span><span class=\"o\">.</span><span class=\"n\">count</span> <span class=\"o\">&gt;</span> <span class=\"mi\">1</span> <span class=\"k\">else</span> <span class=\"p\">{</span>\n    <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"s\">\"Nothing to send\"</span><span class=\"p\">)</span>\n    <span class=\"nf\">exit</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">let</span> <span class=\"nv\">client</span> <span class=\"o\">=</span> <span class=\"kt\">AWSClient</span><span class=\"p\">(</span><span class=\"nv\">httpClientProvider</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">createNew</span><span class=\"p\">)</span>\n<span class=\"k\">defer</span> <span class=\"p\">{</span> <span class=\"k\">try</span><span class=\"p\">?</span> <span class=\"n\">client</span><span class=\"o\">.</span><span class=\"nf\">syncShutdown</span><span class=\"p\">()</span> <span class=\"p\">}</span>\n<span class=\"k\">let</span> <span class=\"nv\">sqs</span> <span class=\"o\">=</span> <span class=\"kt\">SQS</span><span class=\"p\">(</span><span class=\"nv\">client</span><span class=\"p\">:</span> <span class=\"n\">client</span><span class=\"p\">,</span> <span class=\"nv\">region</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">uswest2</span><span class=\"p\">)</span>\n<span class=\"k\">let</span> <span class=\"nv\">queue</span> <span class=\"o\">=</span> <span class=\"s\">\"https://sqs.us-west-2.amazonaws.com/&lt;account&gt;/sqs-swift-demo\"</span>\n\n<span class=\"k\">for</span> <span class=\"n\">message</span> <span class=\"k\">in</span> <span class=\"n\">arguments</span><span class=\"o\">.</span><span class=\"nf\">dropFirst</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">input</span> <span class=\"o\">=</span> <span class=\"kt\">SQS</span><span class=\"o\">.</span><span class=\"kt\">SendMessageRequest</span><span class=\"p\">(</span><span class=\"nv\">messageBody</span><span class=\"p\">:</span> <span class=\"n\">message</span><span class=\"p\">,</span> <span class=\"nv\">queueUrl</span><span class=\"p\">:</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n    <span class=\"k\">let</span> <span class=\"nv\">result</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"n\">sqs</span><span class=\"o\">.</span><span class=\"nf\">sendMessage</span><span class=\"p\">(</span><span class=\"n\">input</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">wait</span><span class=\"p\">()</span>\n    <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">result</span><span class=\"o\">.</span><span class=\"n\">messageId</span> <span class=\"p\">??</span> <span class=\"s\">\"[No id]\"</span><span class=\"p\">)</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<h2 id=\"consumer\">Consumer</h2>\n\n<p>The consumer cli loops forever, waiting for messages to arrive.</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">import</span> <span class=\"kt\">SotoSQS</span>\n\n<span class=\"k\">let</span> <span class=\"nv\">client</span> <span class=\"o\">=</span> <span class=\"kt\">AWSClient</span><span class=\"p\">(</span><span class=\"nv\">httpClientProvider</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">createNew</span><span class=\"p\">)</span>\n<span class=\"k\">defer</span> <span class=\"p\">{</span> <span class=\"k\">try</span><span class=\"p\">?</span> <span class=\"n\">client</span><span class=\"o\">.</span><span class=\"nf\">syncShutdown</span><span class=\"p\">()</span> <span class=\"p\">}</span>\n<span class=\"k\">let</span> <span class=\"nv\">sqs</span> <span class=\"o\">=</span> <span class=\"kt\">SQS</span><span class=\"p\">(</span><span class=\"nv\">client</span><span class=\"p\">:</span> <span class=\"n\">client</span><span class=\"p\">,</span> <span class=\"nv\">region</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">uswest2</span><span class=\"p\">)</span>\n<span class=\"k\">let</span> <span class=\"nv\">queue</span> <span class=\"o\">=</span> <span class=\"s\">\"https://sqs.us-west-2.amazonaws.com/&lt;account&gt;/sqs-swift-demo\"</span>\n\n<span class=\"c1\">// Poll for messages, waiting for up to 10 seconds</span>\n<span class=\"k\">let</span> <span class=\"nv\">request</span> <span class=\"o\">=</span> <span class=\"kt\">SQS</span><span class=\"o\">.</span><span class=\"kt\">ReceiveMessageRequest</span><span class=\"p\">(</span><span class=\"nv\">queueUrl</span><span class=\"p\">:</span> <span class=\"n\">queue</span><span class=\"p\">,</span> <span class=\"nv\">waitTimeSeconds</span><span class=\"p\">:</span> <span class=\"mi\">10</span><span class=\"p\">)</span>\n\n<span class=\"c1\">// Fetch messages forever, until interrupted or terminated</span>\n<span class=\"k\">while</span> <span class=\"kc\">true</span> <span class=\"p\">{</span>\n    <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"s\">\"Polling for messages...\"</span><span class=\"p\">)</span>\n    <span class=\"k\">let</span> <span class=\"nv\">result</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"n\">sqs</span><span class=\"o\">.</span><span class=\"nf\">receiveMessage</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">wait</span><span class=\"p\">()</span>\n    <span class=\"k\">for</span> <span class=\"n\">message</span> <span class=\"k\">in</span> <span class=\"n\">result</span><span class=\"o\">.</span><span class=\"n\">messages</span> <span class=\"p\">??</span> <span class=\"p\">[]</span> <span class=\"p\">{</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"s\">\"Message Id:\"</span><span class=\"p\">,</span> <span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">messageId</span> <span class=\"p\">??</span> <span class=\"s\">\"[no id]\"</span><span class=\"p\">)</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"s\">\"Content:\"</span><span class=\"p\">,</span> <span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">body</span> <span class=\"p\">??</span> <span class=\"s\">\"[no message]\"</span><span class=\"p\">)</span>\n\n        <span class=\"k\">if</span> <span class=\"k\">let</span> <span class=\"nv\">handle</span> <span class=\"o\">=</span> <span class=\"n\">message</span><span class=\"o\">.</span><span class=\"n\">receiptHandle</span> <span class=\"p\">{</span>\n            <span class=\"k\">let</span> <span class=\"nv\">deleteRequest</span> <span class=\"o\">=</span> <span class=\"kt\">SQS</span><span class=\"o\">.</span><span class=\"kt\">DeleteMessageRequest</span><span class=\"p\">(</span><span class=\"nv\">queueUrl</span><span class=\"p\">:</span> <span class=\"n\">queue</span><span class=\"p\">,</span> <span class=\"nv\">receiptHandle</span><span class=\"p\">:</span> <span class=\"n\">handle</span><span class=\"p\">)</span>\n            <span class=\"n\">_</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"n\">sqs</span><span class=\"o\">.</span><span class=\"nf\">deleteMessage</span><span class=\"p\">(</span><span class=\"n\">deleteRequest</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">wait</span><span class=\"p\">()</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/27\">Issue #27</a>)</p>\n    <p>First draft: 2021-02-23</p>\n    <p>Published on: 2021-02-23</p>\n    <p>Last update: 2021-02-23</p>\n</div>",
      "date_published": "2021-02-23T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/distributing-and-consuming-swiftui-views-with-swift-package-manager",
      "url": "https://www.enekoalonso.com/articles/distributing-and-consuming-swiftui-views-with-swift-package-manager",
      "title": "Distributing and Consuming SwiftUI views with Swift Package Manager",
      "content_html": "<p>It is possible to embed SwiftUI views in Swift packages with Swift Package Manager, so they can be distributed, online or internally in your organization, and used across multiple applications.</p>\n\n<h2 id=\"benefits\">Benefits</h2>\n\n<p>Moving SwiftUI views to libraries has many benefits:</p>\n<ul>\n  <li>Improved modularization</li>\n  <li>Reduced dependencies</li>\n  <li>Improved reusability</li>\n  <li>Improved replaceability</li>\n  <li>Improved collaboration</li>\n</ul>\n\n<h3 id=\"improved-modularization\">Improved Modularization</h3>\n<p>Modularization brings many benefits, as described below. Putting SwiftUI views in separate modules is a great way to improve modularization.</p>\n\n<h3 id=\"reduced-dependencies\">Reduced Dependencies</h3>\n<p>Placing views (or any other code) in separate modules forces us into a pattern of removing dependencies. This is good. Having less dependencies means we have to write less interfaces and mocks to test our code.</p>\n\n<h3 id=\"improved-reusability\">Improved Reusability</h3>\n<p>Putting our views (or any other code) in libraries makes it super easy to use them in multiple apps. Specially in the case of open source, we also let other people use our views and libraries in their own projects.</p>\n\n<h3 id=\"improved-replaceability\">Improved Replaceability</h3>\n<p>Because of the reduced number of dependencies, replacing views will be much easier down the road. Dependencies are the source of many problems, including making our code hard to replace.</p>\n\n<h3 id=\"improved-collaboration\">Improved Collaboration</h3>\n<p>Separating your views from the rest of your application makes it much easier to delegate work. Different developers or even teams can work on separate views and other libraries.</p>\n\n<h2 id=\"example\">Example</h2>\n\n<p>One SwiftUI library I published is <a href=\"https://github.com/eneko/Stripes\">Stripes</a>, a simple SwiftUI view to compose stripped backgrounds and other patterns.</p>\n\n<p>Let’s see how to use it in our tool to <a href=\"https://www.enekoalonso.com/articles/creating-ios-application-icons-with-swiftui\">generate iOS Application Icons with SwiftUI</a>.</p>\n\n<h3 id=\"add-stripes-dependency\">Add Stripes Dependency</h3>\n\n<p>In the case of the command line tool to generate application icons, I had a Swift package with the command line executable, and also a <em>faux</em> Xcode project for live previews. I will add Stripes to both.</p>\n\n<h4 id=\"add-swift-package-to-the-project-for-xcode-projects\">Add Swift Package to the project (for Xcode projects)</h4>\n<p><img src=\"https://user-images.githubusercontent.com/32922/105638084-b3e71980-5e25-11eb-8e16-9afd37580d9b.png\" alt=\"Screen Shot 2021-01-24 at 8 49 50 AM\" /></p>\n\n<h4 id=\"add-the-library-to-the-target-for-xcode-projects\">Add the library to the target (for Xcode projects)</h4>\n<p><img src=\"https://user-images.githubusercontent.com/32922/105638094-ba759100-5e25-11eb-838e-6c051b6da134.png\" alt=\"Screen Shot 2021-01-24 at 8 50 10 AM\" /></p>\n\n<h4 id=\"add-the-dependency-to-the-package-for-packages\">Add the dependency to the package (for Packages)</h4>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">package</span> <span class=\"o\">=</span> <span class=\"kt\">Package</span><span class=\"p\">(</span>\n    <span class=\"nv\">name</span><span class=\"p\">:</span> <span class=\"s\">\"ConsoleUI\"</span><span class=\"p\">,</span>\n    <span class=\"nv\">platforms</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"o\">.</span><span class=\"nf\">macOS</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">v10_15</span><span class=\"p\">)</span>\n    <span class=\"p\">],</span>\n    <span class=\"nv\">products</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"o\">.</span><span class=\"nf\">executable</span><span class=\"p\">(</span><span class=\"nv\">name</span><span class=\"p\">:</span> <span class=\"s\">\"consoleui\"</span><span class=\"p\">,</span> <span class=\"nv\">targets</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s\">\"ConsoleUI\"</span><span class=\"p\">])</span>\n    <span class=\"p\">],</span>\n    <span class=\"nv\">dependencies</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"o\">.</span><span class=\"nf\">package</span><span class=\"p\">(</span><span class=\"nv\">url</span><span class=\"p\">:</span> <span class=\"s\">\"https://github.com/eneko/Stripes\"</span><span class=\"p\">,</span> <span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"s\">\"0.2.0\"</span><span class=\"p\">)</span>\n    <span class=\"p\">],</span>\n    <span class=\"nv\">targets</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"o\">.</span><span class=\"nf\">target</span><span class=\"p\">(</span><span class=\"nv\">name</span><span class=\"p\">:</span> <span class=\"s\">\"ConsoleUI\"</span><span class=\"p\">,</span> <span class=\"nv\">dependencies</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s\">\"Stripes\"</span><span class=\"p\">]),</span>\n        <span class=\"o\">.</span><span class=\"nf\">testTarget</span><span class=\"p\">(</span><span class=\"nv\">name</span><span class=\"p\">:</span> <span class=\"s\">\"ConsoleUITests\"</span><span class=\"p\">,</span> <span class=\"nv\">dependencies</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s\">\"ConsoleUI\"</span><span class=\"p\">])</span>\n    <span class=\"p\">]</span>\n<span class=\"p\">)</span>\n</code></pre></div></div>\n\n<h3 id=\"use-stripes-in-our-icon-generator-tool\">Use Stripes in our icon generator tool</h3>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">import</span> <span class=\"kt\">SwiftUI</span>\n<span class=\"kd\">import</span> <span class=\"kt\">Stripes</span>\n\n<span class=\"kd\">struct</span> <span class=\"kt\">MySwiftUIView</span> <span class=\"p\">:</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientStart</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.9098039269</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.4784313738</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.6431372762</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientEnd</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.3647058904</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.06666667014</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.9686274529</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"k\">let</span> <span class=\"nv\">petalLength</span><span class=\"p\">:</span> <span class=\"kt\">CGFloat</span> <span class=\"o\">=</span> <span class=\"mi\">400</span>\n\n    <span class=\"k\">var</span> <span class=\"nv\">body</span><span class=\"p\">:</span> <span class=\"kd\">some</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n        <span class=\"kt\">ZStack</span> <span class=\"p\">{</span>\n            <span class=\"kt\">LinearGradient</span><span class=\"p\">(</span><span class=\"nv\">gradient</span><span class=\"p\">:</span> <span class=\"kt\">Gradient</span><span class=\"p\">(</span><span class=\"nv\">colors</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"n\">gradientStart</span><span class=\"p\">,</span> <span class=\"n\">gradientEnd</span><span class=\"p\">]),</span>\n                           <span class=\"nv\">startPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">top</span><span class=\"p\">,</span> <span class=\"nv\">endPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">bottom</span><span class=\"p\">)</span>\n\n            <span class=\"kt\">Stripes</span><span class=\"p\">(</span><span class=\"nv\">config</span><span class=\"p\">:</span> <span class=\"kt\">StripesConfig</span><span class=\"p\">(</span><span class=\"nv\">background</span><span class=\"p\">:</span> <span class=\"kt\">Color</span><span class=\"o\">.</span><span class=\"n\">white</span><span class=\"o\">.</span><span class=\"nf\">opacity</span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"p\">),</span>\n                                          <span class=\"nv\">foreground</span><span class=\"p\">:</span> <span class=\"kt\">Color</span><span class=\"o\">.</span><span class=\"n\">white</span><span class=\"o\">.</span><span class=\"nf\">opacity</span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"p\">),</span>\n                                          <span class=\"nv\">degrees</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span>\n                                          <span class=\"nv\">barWidth</span><span class=\"p\">:</span> <span class=\"mi\">258</span><span class=\"p\">,</span>\n                                          <span class=\"nv\">barSpacing</span><span class=\"p\">:</span> <span class=\"mi\">100</span><span class=\"p\">))</span>\n\n            <span class=\"kt\">ForEach</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"o\">..&lt;</span><span class=\"mi\">8</span><span class=\"p\">)</span> <span class=\"p\">{</span> <span class=\"n\">index</span> <span class=\"k\">in</span>\n                <span class=\"kt\">RoundedRectangle</span><span class=\"p\">(</span><span class=\"nv\">cornerRadius</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">frame</span><span class=\"p\">(</span><span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">offset</span><span class=\"p\">(</span><span class=\"nv\">x</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"nv\">y</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">opacity</span><span class=\"p\">(</span><span class=\"mf\">0.4</span> <span class=\"o\">+</span> <span class=\"mf\">0.05</span> <span class=\"o\">*</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">))</span>\n                    <span class=\"o\">.</span><span class=\"nf\">rotationEffect</span><span class=\"p\">(</span><span class=\"kt\">Angle</span><span class=\"p\">(</span><span class=\"nv\">degrees</span><span class=\"p\">:</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">)</span> <span class=\"o\">*</span> <span class=\"mi\">45</span><span class=\"p\">))</span>\n            <span class=\"p\">}</span>\n\n            <span class=\"kt\">ForEach</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"o\">..&lt;</span><span class=\"mi\">8</span><span class=\"p\">)</span> <span class=\"p\">{</span> <span class=\"n\">index</span> <span class=\"k\">in</span>\n                <span class=\"kt\">Circle</span><span class=\"p\">()</span>\n                    <span class=\"o\">.</span><span class=\"nf\">frame</span><span class=\"p\">(</span><span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">4</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">offset</span><span class=\"p\">(</span><span class=\"nv\">x</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">*</span> <span class=\"mf\">0.75</span><span class=\"p\">,</span> <span class=\"nv\">y</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">opacity</span><span class=\"p\">(</span><span class=\"mf\">0.4</span> <span class=\"o\">+</span> <span class=\"mf\">0.05</span> <span class=\"o\">*</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">))</span>\n                    <span class=\"o\">.</span><span class=\"nf\">rotationEffect</span><span class=\"p\">(</span><span class=\"kt\">Angle</span><span class=\"p\">(</span><span class=\"nv\">degrees</span><span class=\"p\">:</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">)</span> <span class=\"o\">*</span> <span class=\"mi\">45</span><span class=\"p\">))</span>\n            <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105638282-af6f3080-5e26-11eb-9157-cb7b57290b0b.png\" alt=\"Screen Shot 2021-01-24 at 9 29 02 AM\" /></p>\n\n<p>Here is the final icon image, from the example above:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105638699-f5c58f00-5e28-11eb-8f51-385950a83043.png\" alt=\"test\" /></p>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/25\">Issue #25</a>)</p>\n    <p>First draft: 2021-01-24</p>\n    <p>Published on: 2021-01-24</p>\n    <p>Last update: 2021-01-24</p>\n</div>",
      "summary": "<p>It is possible to embed SwiftUI views in Swift packages with Swift Package Manager, so they can be distributed, online or internally in your organization, and used across multiple applications.</p>\n\n<h2 id=\"benefits\">Benefits</h2>\n\n<p>Moving SwiftUI views to libraries has many benefits:</p>\n<ul>\n  <li>Improved modularization</li>\n  <li>Reduced dependencies</li>\n  <li>Improved reusability</li>\n  <li>Improved replaceability</li>\n  <li>Improved collaboration</li>\n</ul>\n\n<h3 id=\"improved-modularization\">Improved Modularization</h3>\n<p>Modularization brings many benefits, as described below. Putting SwiftUI views in separate modules is a great way to improve modularization.</p>\n\n<h3 id=\"reduced-dependencies\">Reduced Dependencies</h3>\n<p>Placing views (or any other code) in separate modules forces us into a pattern of removing dependencies. This is good. Having less dependencies means we have to write less interfaces and mocks to test our code.</p>\n\n<h3 id=\"improved-reusability\">Improved Reusability</h3>\n<p>Putting our views (or any other code) in libraries makes it super easy to use them in multiple apps. Specially in the case of open source, we also let other people use our views and libraries in their own projects.</p>\n\n<h3 id=\"improved-replaceability\">Improved Replaceability</h3>\n<p>Because of the reduced number of dependencies, replacing views will be much easier down the road. Dependencies are the source of many problems, including making our code hard to replace.</p>\n\n<h3 id=\"improved-collaboration\">Improved Collaboration</h3>\n<p>Separating your views from the rest of your application makes it much easier to delegate work. Different developers or even teams can work on separate views and other libraries.</p>\n\n<h2 id=\"example\">Example</h2>\n\n<p>One SwiftUI library I published is <a href=\"https://github.com/eneko/Stripes\">Stripes</a>, a simple SwiftUI view to compose stripped backgrounds and other patterns.</p>\n\n<p>Let’s see how to use it in our tool to <a href=\"https://www.enekoalonso.com/articles/creating-ios-application-icons-with-swiftui\">generate iOS Application Icons with SwiftUI</a>.</p>\n\n<h3 id=\"add-stripes-dependency\">Add Stripes Dependency</h3>\n\n<p>In the case of the command line tool to generate application icons, I had a Swift package with the command line executable, and also a <em>faux</em> Xcode project for live previews. I will add Stripes to both.</p>\n\n<h4 id=\"add-swift-package-to-the-project-for-xcode-projects\">Add Swift Package to the project (for Xcode projects)</h4>\n<p><img src=\"https://user-images.githubusercontent.com/32922/105638084-b3e71980-5e25-11eb-8e16-9afd37580d9b.png\" alt=\"Screen Shot 2021-01-24 at 8 49 50 AM\" /></p>\n\n<h4 id=\"add-the-library-to-the-target-for-xcode-projects\">Add the library to the target (for Xcode projects)</h4>\n<p><img src=\"https://user-images.githubusercontent.com/32922/105638094-ba759100-5e25-11eb-838e-6c051b6da134.png\" alt=\"Screen Shot 2021-01-24 at 8 50 10 AM\" /></p>\n\n<h4 id=\"add-the-dependency-to-the-package-for-packages\">Add the dependency to the package (for Packages)</h4>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">package</span> <span class=\"o\">=</span> <span class=\"kt\">Package</span><span class=\"p\">(</span>\n    <span class=\"nv\">name</span><span class=\"p\">:</span> <span class=\"s\">\"ConsoleUI\"</span><span class=\"p\">,</span>\n    <span class=\"nv\">platforms</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"o\">.</span><span class=\"nf\">macOS</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">v10_15</span><span class=\"p\">)</span>\n    <span class=\"p\">],</span>\n    <span class=\"nv\">products</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"o\">.</span><span class=\"nf\">executable</span><span class=\"p\">(</span><span class=\"nv\">name</span><span class=\"p\">:</span> <span class=\"s\">\"consoleui\"</span><span class=\"p\">,</span> <span class=\"nv\">targets</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s\">\"ConsoleUI\"</span><span class=\"p\">])</span>\n    <span class=\"p\">],</span>\n    <span class=\"nv\">dependencies</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"o\">.</span><span class=\"nf\">package</span><span class=\"p\">(</span><span class=\"nv\">url</span><span class=\"p\">:</span> <span class=\"s\">\"https://github.com/eneko/Stripes\"</span><span class=\"p\">,</span> <span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"s\">\"0.2.0\"</span><span class=\"p\">)</span>\n    <span class=\"p\">],</span>\n    <span class=\"nv\">targets</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"o\">.</span><span class=\"nf\">target</span><span class=\"p\">(</span><span class=\"nv\">name</span><span class=\"p\">:</span> <span class=\"s\">\"ConsoleUI\"</span><span class=\"p\">,</span> <span class=\"nv\">dependencies</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s\">\"Stripes\"</span><span class=\"p\">]),</span>\n        <span class=\"o\">.</span><span class=\"nf\">testTarget</span><span class=\"p\">(</span><span class=\"nv\">name</span><span class=\"p\">:</span> <span class=\"s\">\"ConsoleUITests\"</span><span class=\"p\">,</span> <span class=\"nv\">dependencies</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s\">\"ConsoleUI\"</span><span class=\"p\">])</span>\n    <span class=\"p\">]</span>\n<span class=\"p\">)</span>\n</code></pre></div></div>\n\n<h3 id=\"use-stripes-in-our-icon-generator-tool\">Use Stripes in our icon generator tool</h3>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">import</span> <span class=\"kt\">SwiftUI</span>\n<span class=\"kd\">import</span> <span class=\"kt\">Stripes</span>\n\n<span class=\"kd\">struct</span> <span class=\"kt\">MySwiftUIView</span> <span class=\"p\">:</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientStart</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.9098039269</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.4784313738</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.6431372762</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientEnd</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.3647058904</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.06666667014</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.9686274529</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"k\">let</span> <span class=\"nv\">petalLength</span><span class=\"p\">:</span> <span class=\"kt\">CGFloat</span> <span class=\"o\">=</span> <span class=\"mi\">400</span>\n\n    <span class=\"k\">var</span> <span class=\"nv\">body</span><span class=\"p\">:</span> <span class=\"kd\">some</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n        <span class=\"kt\">ZStack</span> <span class=\"p\">{</span>\n            <span class=\"kt\">LinearGradient</span><span class=\"p\">(</span><span class=\"nv\">gradient</span><span class=\"p\">:</span> <span class=\"kt\">Gradient</span><span class=\"p\">(</span><span class=\"nv\">colors</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"n\">gradientStart</span><span class=\"p\">,</span> <span class=\"n\">gradientEnd</span><span class=\"p\">]),</span>\n                           <span class=\"nv\">startPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">top</span><span class=\"p\">,</span> <span class=\"nv\">endPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">bottom</span><span class=\"p\">)</span>\n\n            <span class=\"kt\">Stripes</span><span class=\"p\">(</span><span class=\"nv\">config</span><span class=\"p\">:</span> <span class=\"kt\">StripesConfig</span><span class=\"p\">(</span><span class=\"nv\">background</span><span class=\"p\">:</span> <span class=\"kt\">Color</span><span class=\"o\">.</span><span class=\"n\">white</span><span class=\"o\">.</span><span class=\"nf\">opacity</span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"p\">),</span>\n                                          <span class=\"nv\">foreground</span><span class=\"p\">:</span> <span class=\"kt\">Color</span><span class=\"o\">.</span><span class=\"n\">white</span><span class=\"o\">.</span><span class=\"nf\">opacity</span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"p\">),</span>\n                                          <span class=\"nv\">degrees</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span>\n                                          <span class=\"nv\">barWidth</span><span class=\"p\">:</span> <span class=\"mi\">258</span><span class=\"p\">,</span>\n                                          <span class=\"nv\">barSpacing</span><span class=\"p\">:</span> <span class=\"mi\">100</span><span class=\"p\">))</span>\n\n            <span class=\"kt\">ForEach</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"o\">..&lt;</span><span class=\"mi\">8</span><span class=\"p\">)</span> <span class=\"p\">{</span> <span class=\"n\">index</span> <span class=\"k\">in</span>\n                <span class=\"kt\">RoundedRectangle</span><span class=\"p\">(</span><span class=\"nv\">cornerRadius</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">frame</span><span class=\"p\">(</span><span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">offset</span><span class=\"p\">(</span><span class=\"nv\">x</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"nv\">y</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">opacity</span><span class=\"p\">(</span><span class=\"mf\">0.4</span> <span class=\"o\">+</span> <span class=\"mf\">0.05</span> <span class=\"o\">*</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">))</span>\n                    <span class=\"o\">.</span><span class=\"nf\">rotationEffect</span><span class=\"p\">(</span><span class=\"kt\">Angle</span><span class=\"p\">(</span><span class=\"nv\">degrees</span><span class=\"p\">:</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">)</span> <span class=\"o\">*</span> <span class=\"mi\">45</span><span class=\"p\">))</span>\n            <span class=\"p\">}</span>\n\n            <span class=\"kt\">ForEach</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"o\">..&lt;</span><span class=\"mi\">8</span><span class=\"p\">)</span> <span class=\"p\">{</span> <span class=\"n\">index</span> <span class=\"k\">in</span>\n                <span class=\"kt\">Circle</span><span class=\"p\">()</span>\n                    <span class=\"o\">.</span><span class=\"nf\">frame</span><span class=\"p\">(</span><span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">4</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">offset</span><span class=\"p\">(</span><span class=\"nv\">x</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">*</span> <span class=\"mf\">0.75</span><span class=\"p\">,</span> <span class=\"nv\">y</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">opacity</span><span class=\"p\">(</span><span class=\"mf\">0.4</span> <span class=\"o\">+</span> <span class=\"mf\">0.05</span> <span class=\"o\">*</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">))</span>\n                    <span class=\"o\">.</span><span class=\"nf\">rotationEffect</span><span class=\"p\">(</span><span class=\"kt\">Angle</span><span class=\"p\">(</span><span class=\"nv\">degrees</span><span class=\"p\">:</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">)</span> <span class=\"o\">*</span> <span class=\"mi\">45</span><span class=\"p\">))</span>\n            <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105638282-af6f3080-5e26-11eb-9157-cb7b57290b0b.png\" alt=\"Screen Shot 2021-01-24 at 9 29 02 AM\" /></p>\n\n<p>Here is the final icon image, from the example above:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105638699-f5c58f00-5e28-11eb-8f51-385950a83043.png\" alt=\"test\" /></p>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/25\">Issue #25</a>)</p>\n    <p>First draft: 2021-01-24</p>\n    <p>Published on: 2021-01-24</p>\n    <p>Last update: 2021-01-24</p>\n</div>",
      "date_published": "2021-01-24T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/creating-ios-application-icons-with-swiftui",
      "url": "https://www.enekoalonso.com/articles/creating-ios-application-icons-with-swiftui",
      "title": "Creating iOS Application Icons with SwiftUI",
      "content_html": "<p>SwiftUI was introduced to the world at WWDC in June 2019. While the main goal for SwiftUI is to build rich user interfaces on iOS and other Apple platforms, it can also be used to do other fun things.</p>\n\n<p>I couldn’t resist using SwiftUI from the command line, and I wrote about it in <a href=\"https://medium.com/@eneko/rasterizing-swiftui-views-from-the-command-line-80d974356c4a\">Rasterizing SwiftUI views from the command line</a> to showcase how to generate static images (PNG, JPEG, etc). I published the code in GitHub at <a href=\"https://github.com/eneko/ConsoleUI\">ConsoleUI</a>.</p>\n\n<p>Last December I used this same technique to generate social media preview images for this blog. I wrote <a href=\"https://www.enekoalonso.com/articles/issue-13\">Generating Social Media preview images with SwiftUI and GitHub Actions</a> so other people like you could do it too.</p>\n\n<p>Today, I’m writing about generating application icons for iOS with SwiftUI. You guessed it: from the command line.</p>\n\n<h2 id=\"getting-started\">Getting started</h2>\n\n<p>You can start by cloning my <a href=\"https://github.com/eneko/ConsoleUI\">ConsoleUI</a> repo, which I have updated today to run on Xcode 12.4 with the latest SwiftUI available. Feel free to begin with an empty project too. If you do this, you’d probably want to follow the steps on the README file from that repo, or refer back to my first article on this topic.</p>\n\n<p>Xcode does not support live previews on Swift packages yet (FB8979344). To allow for realtime previews follow these steps:</p>\n\n<ol>\n  <li>Generate an Xcode project (<code class=\"language-plaintext highlighter-rouge\">swift package generate-xcodeproj</code>)</li>\n  <li>Add a macOS target to the project</li>\n  <li>Add your view to the macOS target (target <code class=\"language-plaintext highlighter-rouge\">Foo</code> on the screenshot below)</li>\n</ol>\n\n<p>The generated project and target files don’t need to be committed to your repository, but you can do it if that makes it easier for later use.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105608907-b6c90800-5d5a-11eb-80d9-32de73138e75.png\" alt=\"MySwiftUIView\" /></p>\n\n<p>If you cloned <code class=\"language-plaintext highlighter-rouge\">ConsoleUI</code>, at this point you should be able to run the following commands:</p>\n\n<div class=\"language-sh highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>swift build                  <span class=\"c\"># build project</span>\nswift run <span class=\"o\">&amp;&amp;</span> open test.png   <span class=\"c\"># rasterize image and open in Preview app</span>\nswift <span class=\"nb\">test</span>                   <span class=\"c\"># run tests</span>\n</code></pre></div></div>\n\n<h2 id=\"drawing-app-icons\">Drawing App Icons</h2>\n\n<p>This is why we are here, right? Let’s draw some cool app icons for iOS.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105609174-5935bb00-5d5c-11eb-92d9-90e73f3b2629.png\" alt=\"Screen Shot 2021-01-23 at 9 21 05 AM\" /></p>\n\n<p><a href=\"https://developer.apple.com/design/human-interface-guidelines/ios/icons-and-images/app-icon/\">App Icon Design Guidelines</a> state icons should be a PNG image with the largest size of 1024 x 1024 pixels (@1x) for the App Store.</p>\n\n<p>We will update our view to match those dimensions, both on the rasterization code and the SwiftUI preview:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">wrapper</span> <span class=\"o\">=</span> <span class=\"kt\">NSHostingView</span><span class=\"p\">(</span><span class=\"nv\">rootView</span><span class=\"p\">:</span> <span class=\"kt\">MySwiftUIView</span><span class=\"p\">())</span>\n<span class=\"n\">wrapper</span><span class=\"o\">.</span><span class=\"n\">frame</span> <span class=\"o\">=</span> <span class=\"kt\">CGRect</span><span class=\"p\">(</span><span class=\"nv\">x</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"nv\">y</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"mi\">1024</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"mi\">1024</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"cp\">#if DEBUG</span>\n<span class=\"kd\">struct</span> <span class=\"kt\">MySwiftUIView_Previews</span> <span class=\"p\">:</span> <span class=\"kt\">PreviewProvider</span> <span class=\"p\">{</span>\n    <span class=\"kd\">static</span> <span class=\"k\">var</span> <span class=\"nv\">previews</span><span class=\"p\">:</span> <span class=\"kd\">some</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n        <span class=\"kt\">MySwiftUIView</span><span class=\"p\">()</span>\n            <span class=\"o\">.</span><span class=\"nf\">frame</span><span class=\"p\">(</span><span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"mi\">1024</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"mi\">1024</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n<span class=\"cp\">#endif</span>\n</code></pre></div></div>\n\n<p>We now should have a nice square to draw on.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105609268-ff81c080-5d5c-11eb-95e1-326db1a5c820.png\" alt=\"Screen Shot 2021-01-23 at 9 25 48 AM\" /></p>\n\n<p>Equally, running <code class=\"language-plaintext highlighter-rouge\">swift run</code> from the terminal should now generate a 1024 x 1204 PNG image as output.</p>\n\n<h2 id=\"gradient-backgrounds\">Gradient Backgrounds</h2>\n\n<p>It’s pretty common for app icons to have a gradient background. <a href=\"https://www.hackingwithswift.com/quick-start/swiftui/how-to-render-a-gradient\">Gradients are pretty easy to do in SwiftUI</a>, lets add some:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">MySwiftUIView</span> <span class=\"p\">:</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientStart</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.9098039269</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.4784313738</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.6431372762</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientEnd</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.3647058904</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.06666667014</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.9686274529</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n\n    <span class=\"k\">var</span> <span class=\"nv\">body</span><span class=\"p\">:</span> <span class=\"kd\">some</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n        <span class=\"kt\">ZStack</span> <span class=\"p\">{</span>\n            <span class=\"kt\">LinearGradient</span><span class=\"p\">(</span><span class=\"nv\">gradient</span><span class=\"p\">:</span> <span class=\"kt\">Gradient</span><span class=\"p\">(</span><span class=\"nv\">colors</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"n\">gradientStart</span><span class=\"p\">,</span> <span class=\"n\">gradientEnd</span><span class=\"p\">]),</span>\n                           <span class=\"nv\">startPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">top</span><span class=\"p\">,</span> <span class=\"nv\">endPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">bottom</span><span class=\"p\">)</span>\n            <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"s\">\"Hello, world!\"</span><span class=\"p\">)</span>\n                <span class=\"o\">.</span><span class=\"nf\">foregroundColor</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">white</span><span class=\"p\">)</span>\n                <span class=\"o\">.</span><span class=\"nf\">font</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">largeTitle</span><span class=\"p\">)</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105609873-feeb2900-5d60-11eb-8781-5f2f1c281ef9.png\" alt=\"Screen Shot 2021-01-23 at 9 33 58 AM\" /></p>\n\n<h2 id=\"drawing-paths\">Drawing Paths</h2>\n\n<p>Drawing paths in SwiftUI is a pleasure. There are pretty good articles with great examples online (some examples: <a href=\"https://schwiftyui.com/swiftui/paths-in-swiftui/\">Paths in SwiftUI</a>, <a href=\"https://www.objc.io/blog/2019/08/20/paths-vs-shapes/\">SwiftUI: Paths vs. Shapes</a>).</p>\n\n<p>Here is an example of drawing overlapping squares, as illustrated by Paul Hudson on <a href=\"https://www.hackingwithswift.com/quick-start/swiftui/how-to-draw-a-custom-path\">How to draw a custom path</a>.</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">SpiroSquare</span><span class=\"p\">:</span> <span class=\"kt\">Shape</span> <span class=\"p\">{</span>\n    <span class=\"kd\">func</span> <span class=\"nf\">path</span><span class=\"p\">(</span><span class=\"k\">in</span> <span class=\"nv\">rect</span><span class=\"p\">:</span> <span class=\"kt\">CGRect</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">Path</span> <span class=\"p\">{</span>\n        <span class=\"k\">var</span> <span class=\"nv\">path</span> <span class=\"o\">=</span> <span class=\"kt\">Path</span><span class=\"p\">()</span>\n\n        <span class=\"k\">let</span> <span class=\"nv\">rotations</span> <span class=\"o\">=</span> <span class=\"mi\">5</span>\n        <span class=\"k\">let</span> <span class=\"nv\">amount</span> <span class=\"o\">=</span> <span class=\"o\">.</span><span class=\"n\">pi</span> <span class=\"o\">/</span> <span class=\"kt\">CGFloat</span><span class=\"p\">(</span><span class=\"n\">rotations</span><span class=\"p\">)</span>\n        <span class=\"k\">let</span> <span class=\"nv\">transform</span> <span class=\"o\">=</span> <span class=\"kt\">CGAffineTransform</span><span class=\"p\">(</span><span class=\"nv\">rotationAngle</span><span class=\"p\">:</span> <span class=\"n\">amount</span><span class=\"p\">)</span>\n\n        <span class=\"k\">for</span> <span class=\"n\">_</span> <span class=\"k\">in</span> <span class=\"mi\">0</span> <span class=\"o\">..&lt;</span> <span class=\"n\">rotations</span> <span class=\"p\">{</span>\n            <span class=\"n\">path</span> <span class=\"o\">=</span> <span class=\"n\">path</span><span class=\"o\">.</span><span class=\"nf\">applying</span><span class=\"p\">(</span><span class=\"n\">transform</span><span class=\"p\">)</span>\n            <span class=\"n\">path</span><span class=\"o\">.</span><span class=\"nf\">addRect</span><span class=\"p\">(</span><span class=\"kt\">CGRect</span><span class=\"p\">(</span><span class=\"nv\">x</span><span class=\"p\">:</span> <span class=\"o\">-</span><span class=\"n\">rect</span><span class=\"o\">.</span><span class=\"n\">width</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"nv\">y</span><span class=\"p\">:</span> <span class=\"o\">-</span><span class=\"n\">rect</span><span class=\"o\">.</span><span class=\"n\">height</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"n\">rect</span><span class=\"o\">.</span><span class=\"n\">width</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"n\">rect</span><span class=\"o\">.</span><span class=\"n\">height</span><span class=\"p\">))</span>\n        <span class=\"p\">}</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">path</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n\n<span class=\"kd\">struct</span> <span class=\"kt\">MySwiftUIView</span> <span class=\"p\">:</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientStart</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.9098039269</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.4784313738</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.6431372762</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientEnd</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.3647058904</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.06666667014</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.9686274529</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n\n    <span class=\"k\">var</span> <span class=\"nv\">body</span><span class=\"p\">:</span> <span class=\"kd\">some</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n        <span class=\"kt\">ZStack</span> <span class=\"p\">{</span>\n            <span class=\"kt\">LinearGradient</span><span class=\"p\">(</span><span class=\"nv\">gradient</span><span class=\"p\">:</span> <span class=\"kt\">Gradient</span><span class=\"p\">(</span><span class=\"nv\">colors</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"n\">gradientStart</span><span class=\"p\">,</span> <span class=\"n\">gradientEnd</span><span class=\"p\">]),</span>\n                           <span class=\"nv\">startPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">top</span><span class=\"p\">,</span> <span class=\"nv\">endPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">bottom</span><span class=\"p\">)</span>\n            <span class=\"kt\">SpiroSquare</span><span class=\"p\">()</span>\n                <span class=\"o\">.</span><span class=\"nf\">stroke</span><span class=\"p\">(</span><span class=\"nv\">lineWidth</span><span class=\"p\">:</span> <span class=\"mi\">8</span><span class=\"p\">)</span>\n                <span class=\"o\">.</span><span class=\"nf\">frame</span><span class=\"p\">(</span><span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"mi\">600</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"mi\">600</span><span class=\"p\">)</span>\n                <span class=\"o\">.</span><span class=\"nf\">offset</span><span class=\"p\">(</span><span class=\"nv\">x</span><span class=\"p\">:</span> <span class=\"mi\">300</span><span class=\"p\">,</span> <span class=\"nv\">y</span><span class=\"p\">:</span> <span class=\"mi\">300</span><span class=\"p\">)</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>When we run our rasterizer from the command line with <code class=\"language-plaintext highlighter-rouge\">swift run</code>, we get this pretty icon:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105609630-73bd6380-5d5f-11eb-84b3-6652fca591f5.png\" alt=\"Generated App Icon\" /></p>\n\n<h2 id=\"drawing-shapes\">Drawing Shapes</h2>\n\n<p>Besides paths, we can also use shapes to compose our icon.</p>\n\n<p>For example, using rounded rectangle, we can replicate (to some extent) the Photos app icon shape:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">MySwiftUIView</span> <span class=\"p\">:</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientStart</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.9098039269</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.4784313738</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.6431372762</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientEnd</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.3647058904</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.06666667014</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.9686274529</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"k\">let</span> <span class=\"nv\">petalLength</span><span class=\"p\">:</span> <span class=\"kt\">CGFloat</span> <span class=\"o\">=</span> <span class=\"mi\">400</span>\n\n    <span class=\"k\">var</span> <span class=\"nv\">body</span><span class=\"p\">:</span> <span class=\"kd\">some</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n        <span class=\"kt\">ZStack</span> <span class=\"p\">{</span>\n            <span class=\"kt\">LinearGradient</span><span class=\"p\">(</span><span class=\"nv\">gradient</span><span class=\"p\">:</span> <span class=\"kt\">Gradient</span><span class=\"p\">(</span><span class=\"nv\">colors</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"n\">gradientStart</span><span class=\"p\">,</span> <span class=\"n\">gradientEnd</span><span class=\"p\">]),</span>\n                           <span class=\"nv\">startPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">top</span><span class=\"p\">,</span> <span class=\"nv\">endPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">bottom</span><span class=\"p\">)</span>\n\n            <span class=\"kt\">ForEach</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"o\">..&lt;</span><span class=\"mi\">8</span><span class=\"p\">)</span> <span class=\"p\">{</span> <span class=\"n\">index</span> <span class=\"k\">in</span>\n                <span class=\"kt\">RoundedRectangle</span><span class=\"p\">(</span><span class=\"nv\">cornerRadius</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">frame</span><span class=\"p\">(</span><span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">offset</span><span class=\"p\">(</span><span class=\"nv\">x</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"nv\">y</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">opacity</span><span class=\"p\">(</span><span class=\"mf\">0.7</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">rotationEffect</span><span class=\"p\">(</span><span class=\"kt\">Angle</span><span class=\"p\">(</span><span class=\"nv\">degrees</span><span class=\"p\">:</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">)</span> <span class=\"o\">*</span> <span class=\"mi\">45</span><span class=\"p\">))</span>\n            <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>Live preview:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105609830-bdf31480-5d60-11eb-9e9c-1556278fcca8.png\" alt=\"Screen Shot 2021-01-23 at 9 50 43 AM\" /></p>\n\n<p>And generated PNG icon image:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105609832-c1869b80-5d60-11eb-9a26-8f6112024936.png\" alt=\"Generated App Icon\" /></p>\n\n<p>There you go, hope you found this useful. If you do and end up using this technique, please ping me on Twitter, I cannot wait to see the app icons you create in SwiftUI.</p>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/24\">Issue #24</a>)</p>\n    <p>First draft: 2021-01-23</p>\n    <p>Published on: 2021-01-23</p>\n    <p>Last update: 2021-01-23</p>\n</div>",
      "summary": "<p>SwiftUI was introduced to the world at WWDC in June 2019. While the main goal for SwiftUI is to build rich user interfaces on iOS and other Apple platforms, it can also be used to do other fun things.</p>\n\n<p>I couldn’t resist using SwiftUI from the command line, and I wrote about it in <a href=\"https://medium.com/@eneko/rasterizing-swiftui-views-from-the-command-line-80d974356c4a\">Rasterizing SwiftUI views from the command line</a> to showcase how to generate static images (PNG, JPEG, etc). I published the code in GitHub at <a href=\"https://github.com/eneko/ConsoleUI\">ConsoleUI</a>.</p>\n\n<p>Last December I used this same technique to generate social media preview images for this blog. I wrote <a href=\"https://www.enekoalonso.com/articles/issue-13\">Generating Social Media preview images with SwiftUI and GitHub Actions</a> so other people like you could do it too.</p>\n\n<p>Today, I’m writing about generating application icons for iOS with SwiftUI. You guessed it: from the command line.</p>\n\n<h2 id=\"getting-started\">Getting started</h2>\n\n<p>You can start by cloning my <a href=\"https://github.com/eneko/ConsoleUI\">ConsoleUI</a> repo, which I have updated today to run on Xcode 12.4 with the latest SwiftUI available. Feel free to begin with an empty project too. If you do this, you’d probably want to follow the steps on the README file from that repo, or refer back to my first article on this topic.</p>\n\n<p>Xcode does not support live previews on Swift packages yet (FB8979344). To allow for realtime previews follow these steps:</p>\n\n<ol>\n  <li>Generate an Xcode project (<code class=\"language-plaintext highlighter-rouge\">swift package generate-xcodeproj</code>)</li>\n  <li>Add a macOS target to the project</li>\n  <li>Add your view to the macOS target (target <code class=\"language-plaintext highlighter-rouge\">Foo</code> on the screenshot below)</li>\n</ol>\n\n<p>The generated project and target files don’t need to be committed to your repository, but you can do it if that makes it easier for later use.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105608907-b6c90800-5d5a-11eb-80d9-32de73138e75.png\" alt=\"MySwiftUIView\" /></p>\n\n<p>If you cloned <code class=\"language-plaintext highlighter-rouge\">ConsoleUI</code>, at this point you should be able to run the following commands:</p>\n\n<div class=\"language-sh highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>swift build                  <span class=\"c\"># build project</span>\nswift run <span class=\"o\">&amp;&amp;</span> open test.png   <span class=\"c\"># rasterize image and open in Preview app</span>\nswift <span class=\"nb\">test</span>                   <span class=\"c\"># run tests</span>\n</code></pre></div></div>\n\n<h2 id=\"drawing-app-icons\">Drawing App Icons</h2>\n\n<p>This is why we are here, right? Let’s draw some cool app icons for iOS.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105609174-5935bb00-5d5c-11eb-92d9-90e73f3b2629.png\" alt=\"Screen Shot 2021-01-23 at 9 21 05 AM\" /></p>\n\n<p><a href=\"https://developer.apple.com/design/human-interface-guidelines/ios/icons-and-images/app-icon/\">App Icon Design Guidelines</a> state icons should be a PNG image with the largest size of 1024 x 1024 pixels (@1x) for the App Store.</p>\n\n<p>We will update our view to match those dimensions, both on the rasterization code and the SwiftUI preview:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">wrapper</span> <span class=\"o\">=</span> <span class=\"kt\">NSHostingView</span><span class=\"p\">(</span><span class=\"nv\">rootView</span><span class=\"p\">:</span> <span class=\"kt\">MySwiftUIView</span><span class=\"p\">())</span>\n<span class=\"n\">wrapper</span><span class=\"o\">.</span><span class=\"n\">frame</span> <span class=\"o\">=</span> <span class=\"kt\">CGRect</span><span class=\"p\">(</span><span class=\"nv\">x</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"nv\">y</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"mi\">1024</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"mi\">1024</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"cp\">#if DEBUG</span>\n<span class=\"kd\">struct</span> <span class=\"kt\">MySwiftUIView_Previews</span> <span class=\"p\">:</span> <span class=\"kt\">PreviewProvider</span> <span class=\"p\">{</span>\n    <span class=\"kd\">static</span> <span class=\"k\">var</span> <span class=\"nv\">previews</span><span class=\"p\">:</span> <span class=\"kd\">some</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n        <span class=\"kt\">MySwiftUIView</span><span class=\"p\">()</span>\n            <span class=\"o\">.</span><span class=\"nf\">frame</span><span class=\"p\">(</span><span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"mi\">1024</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"mi\">1024</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n<span class=\"cp\">#endif</span>\n</code></pre></div></div>\n\n<p>We now should have a nice square to draw on.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105609268-ff81c080-5d5c-11eb-95e1-326db1a5c820.png\" alt=\"Screen Shot 2021-01-23 at 9 25 48 AM\" /></p>\n\n<p>Equally, running <code class=\"language-plaintext highlighter-rouge\">swift run</code> from the terminal should now generate a 1024 x 1204 PNG image as output.</p>\n\n<h2 id=\"gradient-backgrounds\">Gradient Backgrounds</h2>\n\n<p>It’s pretty common for app icons to have a gradient background. <a href=\"https://www.hackingwithswift.com/quick-start/swiftui/how-to-render-a-gradient\">Gradients are pretty easy to do in SwiftUI</a>, lets add some:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">MySwiftUIView</span> <span class=\"p\">:</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientStart</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.9098039269</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.4784313738</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.6431372762</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientEnd</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.3647058904</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.06666667014</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.9686274529</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n\n    <span class=\"k\">var</span> <span class=\"nv\">body</span><span class=\"p\">:</span> <span class=\"kd\">some</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n        <span class=\"kt\">ZStack</span> <span class=\"p\">{</span>\n            <span class=\"kt\">LinearGradient</span><span class=\"p\">(</span><span class=\"nv\">gradient</span><span class=\"p\">:</span> <span class=\"kt\">Gradient</span><span class=\"p\">(</span><span class=\"nv\">colors</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"n\">gradientStart</span><span class=\"p\">,</span> <span class=\"n\">gradientEnd</span><span class=\"p\">]),</span>\n                           <span class=\"nv\">startPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">top</span><span class=\"p\">,</span> <span class=\"nv\">endPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">bottom</span><span class=\"p\">)</span>\n            <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"s\">\"Hello, world!\"</span><span class=\"p\">)</span>\n                <span class=\"o\">.</span><span class=\"nf\">foregroundColor</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">white</span><span class=\"p\">)</span>\n                <span class=\"o\">.</span><span class=\"nf\">font</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">largeTitle</span><span class=\"p\">)</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105609873-feeb2900-5d60-11eb-8781-5f2f1c281ef9.png\" alt=\"Screen Shot 2021-01-23 at 9 33 58 AM\" /></p>\n\n<h2 id=\"drawing-paths\">Drawing Paths</h2>\n\n<p>Drawing paths in SwiftUI is a pleasure. There are pretty good articles with great examples online (some examples: <a href=\"https://schwiftyui.com/swiftui/paths-in-swiftui/\">Paths in SwiftUI</a>, <a href=\"https://www.objc.io/blog/2019/08/20/paths-vs-shapes/\">SwiftUI: Paths vs. Shapes</a>).</p>\n\n<p>Here is an example of drawing overlapping squares, as illustrated by Paul Hudson on <a href=\"https://www.hackingwithswift.com/quick-start/swiftui/how-to-draw-a-custom-path\">How to draw a custom path</a>.</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">SpiroSquare</span><span class=\"p\">:</span> <span class=\"kt\">Shape</span> <span class=\"p\">{</span>\n    <span class=\"kd\">func</span> <span class=\"nf\">path</span><span class=\"p\">(</span><span class=\"k\">in</span> <span class=\"nv\">rect</span><span class=\"p\">:</span> <span class=\"kt\">CGRect</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">Path</span> <span class=\"p\">{</span>\n        <span class=\"k\">var</span> <span class=\"nv\">path</span> <span class=\"o\">=</span> <span class=\"kt\">Path</span><span class=\"p\">()</span>\n\n        <span class=\"k\">let</span> <span class=\"nv\">rotations</span> <span class=\"o\">=</span> <span class=\"mi\">5</span>\n        <span class=\"k\">let</span> <span class=\"nv\">amount</span> <span class=\"o\">=</span> <span class=\"o\">.</span><span class=\"n\">pi</span> <span class=\"o\">/</span> <span class=\"kt\">CGFloat</span><span class=\"p\">(</span><span class=\"n\">rotations</span><span class=\"p\">)</span>\n        <span class=\"k\">let</span> <span class=\"nv\">transform</span> <span class=\"o\">=</span> <span class=\"kt\">CGAffineTransform</span><span class=\"p\">(</span><span class=\"nv\">rotationAngle</span><span class=\"p\">:</span> <span class=\"n\">amount</span><span class=\"p\">)</span>\n\n        <span class=\"k\">for</span> <span class=\"n\">_</span> <span class=\"k\">in</span> <span class=\"mi\">0</span> <span class=\"o\">..&lt;</span> <span class=\"n\">rotations</span> <span class=\"p\">{</span>\n            <span class=\"n\">path</span> <span class=\"o\">=</span> <span class=\"n\">path</span><span class=\"o\">.</span><span class=\"nf\">applying</span><span class=\"p\">(</span><span class=\"n\">transform</span><span class=\"p\">)</span>\n            <span class=\"n\">path</span><span class=\"o\">.</span><span class=\"nf\">addRect</span><span class=\"p\">(</span><span class=\"kt\">CGRect</span><span class=\"p\">(</span><span class=\"nv\">x</span><span class=\"p\">:</span> <span class=\"o\">-</span><span class=\"n\">rect</span><span class=\"o\">.</span><span class=\"n\">width</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"nv\">y</span><span class=\"p\">:</span> <span class=\"o\">-</span><span class=\"n\">rect</span><span class=\"o\">.</span><span class=\"n\">height</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"n\">rect</span><span class=\"o\">.</span><span class=\"n\">width</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"n\">rect</span><span class=\"o\">.</span><span class=\"n\">height</span><span class=\"p\">))</span>\n        <span class=\"p\">}</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">path</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n\n<span class=\"kd\">struct</span> <span class=\"kt\">MySwiftUIView</span> <span class=\"p\">:</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientStart</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.9098039269</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.4784313738</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.6431372762</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientEnd</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.3647058904</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.06666667014</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.9686274529</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n\n    <span class=\"k\">var</span> <span class=\"nv\">body</span><span class=\"p\">:</span> <span class=\"kd\">some</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n        <span class=\"kt\">ZStack</span> <span class=\"p\">{</span>\n            <span class=\"kt\">LinearGradient</span><span class=\"p\">(</span><span class=\"nv\">gradient</span><span class=\"p\">:</span> <span class=\"kt\">Gradient</span><span class=\"p\">(</span><span class=\"nv\">colors</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"n\">gradientStart</span><span class=\"p\">,</span> <span class=\"n\">gradientEnd</span><span class=\"p\">]),</span>\n                           <span class=\"nv\">startPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">top</span><span class=\"p\">,</span> <span class=\"nv\">endPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">bottom</span><span class=\"p\">)</span>\n            <span class=\"kt\">SpiroSquare</span><span class=\"p\">()</span>\n                <span class=\"o\">.</span><span class=\"nf\">stroke</span><span class=\"p\">(</span><span class=\"nv\">lineWidth</span><span class=\"p\">:</span> <span class=\"mi\">8</span><span class=\"p\">)</span>\n                <span class=\"o\">.</span><span class=\"nf\">frame</span><span class=\"p\">(</span><span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"mi\">600</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"mi\">600</span><span class=\"p\">)</span>\n                <span class=\"o\">.</span><span class=\"nf\">offset</span><span class=\"p\">(</span><span class=\"nv\">x</span><span class=\"p\">:</span> <span class=\"mi\">300</span><span class=\"p\">,</span> <span class=\"nv\">y</span><span class=\"p\">:</span> <span class=\"mi\">300</span><span class=\"p\">)</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>When we run our rasterizer from the command line with <code class=\"language-plaintext highlighter-rouge\">swift run</code>, we get this pretty icon:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105609630-73bd6380-5d5f-11eb-84b3-6652fca591f5.png\" alt=\"Generated App Icon\" /></p>\n\n<h2 id=\"drawing-shapes\">Drawing Shapes</h2>\n\n<p>Besides paths, we can also use shapes to compose our icon.</p>\n\n<p>For example, using rounded rectangle, we can replicate (to some extent) the Photos app icon shape:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">MySwiftUIView</span> <span class=\"p\">:</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientStart</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.9098039269</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.4784313738</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.6431372762</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"k\">let</span> <span class=\"nv\">gradientEnd</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.3647058904</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.06666667014</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mf\">0.9686274529</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"k\">let</span> <span class=\"nv\">petalLength</span><span class=\"p\">:</span> <span class=\"kt\">CGFloat</span> <span class=\"o\">=</span> <span class=\"mi\">400</span>\n\n    <span class=\"k\">var</span> <span class=\"nv\">body</span><span class=\"p\">:</span> <span class=\"kd\">some</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n        <span class=\"kt\">ZStack</span> <span class=\"p\">{</span>\n            <span class=\"kt\">LinearGradient</span><span class=\"p\">(</span><span class=\"nv\">gradient</span><span class=\"p\">:</span> <span class=\"kt\">Gradient</span><span class=\"p\">(</span><span class=\"nv\">colors</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"n\">gradientStart</span><span class=\"p\">,</span> <span class=\"n\">gradientEnd</span><span class=\"p\">]),</span>\n                           <span class=\"nv\">startPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">top</span><span class=\"p\">,</span> <span class=\"nv\">endPoint</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">bottom</span><span class=\"p\">)</span>\n\n            <span class=\"kt\">ForEach</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"o\">..&lt;</span><span class=\"mi\">8</span><span class=\"p\">)</span> <span class=\"p\">{</span> <span class=\"n\">index</span> <span class=\"k\">in</span>\n                <span class=\"kt\">RoundedRectangle</span><span class=\"p\">(</span><span class=\"nv\">cornerRadius</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">frame</span><span class=\"p\">(</span><span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">offset</span><span class=\"p\">(</span><span class=\"nv\">x</span><span class=\"p\">:</span> <span class=\"n\">petalLength</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"nv\">y</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">opacity</span><span class=\"p\">(</span><span class=\"mf\">0.7</span><span class=\"p\">)</span>\n                    <span class=\"o\">.</span><span class=\"nf\">rotationEffect</span><span class=\"p\">(</span><span class=\"kt\">Angle</span><span class=\"p\">(</span><span class=\"nv\">degrees</span><span class=\"p\">:</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"p\">)</span> <span class=\"o\">*</span> <span class=\"mi\">45</span><span class=\"p\">))</span>\n            <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>Live preview:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105609830-bdf31480-5d60-11eb-9e9c-1556278fcca8.png\" alt=\"Screen Shot 2021-01-23 at 9 50 43 AM\" /></p>\n\n<p>And generated PNG icon image:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/105609832-c1869b80-5d60-11eb-9a26-8f6112024936.png\" alt=\"Generated App Icon\" /></p>\n\n<p>There you go, hope you found this useful. If you do and end up using this technique, please ping me on Twitter, I cannot wait to see the app icons you create in SwiftUI.</p>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/24\">Issue #24</a>)</p>\n    <p>First draft: 2021-01-23</p>\n    <p>Published on: 2021-01-23</p>\n    <p>Last update: 2021-01-23</p>\n</div>",
      "date_published": "2021-01-23T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-23",
      "url": "https://www.enekoalonso.com/articles/issue-23",
      "title": "Dealing with camelCase, snake_case, PascalCase, kebab-case and other custom JSON property names in Swift",
      "content_html": "<p>Swift’s <a href=\"https://developer.apple.com/documentation/swift/codable\"><code class=\"language-plaintext highlighter-rouge\">Codable</code></a> protocol (together with <code class=\"language-plaintext highlighter-rouge\">Encodable</code> and <code class=\"language-plaintext highlighter-rouge\">Decodable</code>) was introduced in Xcode 9 with Swift 4. This changed for good how we encode and decode JSON. In this article I’m hoping to show you how to make this experience better, when dealing with JSON keys in other formats.</p>\n\n<h2 id=\"encodingdecoding-json-with-camelcase-keys\">Encoding/Decoding JSON with <code class=\"language-plaintext highlighter-rouge\">camelCase</code> keys</h2>\n\n<p>If we are lucky, the JSON we work with will follow Swift naming conventions.</p>\n\n<blockquote>\n  <p>Names of types and protocols are UpperCamelCase. Everything else is lowerCamelCase.</p>\n\n  <p><a href=\"https://swift.org/documentation/api-design-guidelines/#conventions\">Swift API Design Guidelines - Conventions</a></p>\n</blockquote>\n\n<p>This convention uses lower camel case (<code class=\"language-plaintext highlighter-rouge\">camelCase</code>) for object/struct property names. In this scenario, we can encode/decode JSON objects straight out of the box, without any modifications.</p>\n\n<p>Given the following Swift structure:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">Device</span><span class=\"p\">:</span> <span class=\"kt\">Codable</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">deviceName</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">deviceModel</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>And the following JSON:</p>\n<div class=\"language-json highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"nl\">\"deviceName\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"iPhone 12 Pro\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"nl\">\"deviceModel\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"iPhone\"</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<p>We can decode it as follows:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">device</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"kt\">JSONDecoder</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"nf\">decode</span><span class=\"p\">(</span><span class=\"kt\">Device</span><span class=\"o\">.</span><span class=\"k\">self</span><span class=\"p\">,</span> <span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">json</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">deviceName</span><span class=\"p\">)</span> <span class=\"c1\">// iPhone 12 Pro</span>\n</code></pre></div></div>\n\n<p>Nothing new here, pretty straightforward 😉</p>\n\n<h2 id=\"encodingdecoding-json-with-snake_case-keys\">Encoding/Decoding JSON with <code class=\"language-plaintext highlighter-rouge\">snake_case</code> keys</h2>\n\n<p>Snake case is the standard <a href=\"https://en.wikipedia.org/wiki/Snake_case\">naming convention in some programming languages</a>, like Python and Ruby. Thus, is pretty common to see <code class=\"language-plaintext highlighter-rouge\">snake_case</code> used for JSON properties.</p>\n\n<p>Fortunately, Swift includes an out-of-the-box solution to parse JSON in this format. <a href=\"https://developer.apple.com/documentation/foundation/jsondecoder/keydecodingstrategy\"><code class=\"language-plaintext highlighter-rouge\">JSONDecoder.KeyDecodingStrategy</code></a> includes a convenient <code class=\"language-plaintext highlighter-rouge\">convertFromSnakeCase</code> option (see <code class=\"language-plaintext highlighter-rouge\">convertToSnakeCase</code> for <code class=\"language-plaintext highlighter-rouge\">JSONEncoder</code>)</p>\n\n<p>Given the following JSON:</p>\n<div class=\"language-json highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"nl\">\"device_name\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"iPhone 12 Pro\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"nl\">\"device_model\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"iPhone\"</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<p>We can decode it as follows:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">decoder</span> <span class=\"o\">=</span> <span class=\"kt\">JSONDecoder</span><span class=\"p\">()</span>\n<span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"n\">keyDecodingStrategy</span> <span class=\"o\">=</span> <span class=\"o\">.</span><span class=\"n\">convertFromSnakeCase</span>\n<span class=\"k\">let</span> <span class=\"nv\">device</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"nf\">decode</span><span class=\"p\">(</span><span class=\"kt\">Device</span><span class=\"o\">.</span><span class=\"k\">self</span><span class=\"p\">,</span> <span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">json</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">deviceName</span><span class=\"p\">)</span> <span class=\"c1\">// iPhone 12 Pro</span>\n</code></pre></div></div>\n\n<p>Pretty cool. One line of code, and we are all set 🎉</p>\n\n<h2 id=\"encodingdecoding-json-with-custom-case-keys\">Encoding/Decoding JSON with <code class=\"language-plaintext highlighter-rouge\">CuSToM-CaSe</code> keys</h2>\n\n<p>What about other common cases? While <code class=\"language-plaintext highlighter-rouge\">lowerCamelCase</code> and <code class=\"language-plaintext highlighter-rouge\">snake_case</code> might be the two most popular formats for JSON object keys, some programming languages might have different conventions.</p>\n\n<p>For example, <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/inside-a-program/identifier-names#naming-conventions\">C# uses <code class=\"language-plaintext highlighter-rouge\">PascalCase</code> for property names</a>, and it’s common for C# APIs to return JSON in this format.</p>\n\n<p>Example JSON with <code class=\"language-plaintext highlighter-rouge\">PascalCase</code> keys:</p>\n<div class=\"language-json highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"nl\">\"DeviceName\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"iPhone 12 Pro\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"nl\">\"DeviceModel\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"iPhone\"</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<p>A common way to handle these keys is by defining a <code class=\"language-plaintext highlighter-rouge\">CodingKeys</code> enumeration conforming to <code class=\"language-plaintext highlighter-rouge\">String &amp; CodingKey</code>, as shown in <a href=\"https://developer.apple.com/documentation/foundation/archives_and_serialization/encoding_and_decoding_custom_types\">Apple documentation examples</a> and many other articles.</p>\n\n<p>Following this pattern, we would update our Swift structure as follows:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">Device</span><span class=\"p\">:</span> <span class=\"kt\">Codable</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">deviceName</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">deviceModel</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n\n    <span class=\"kd\">enum</span> <span class=\"kt\">CodingKeys</span><span class=\"p\">:</span> <span class=\"kt\">String</span><span class=\"p\">,</span> <span class=\"kt\">CodingKey</span> <span class=\"p\">{</span>\n        <span class=\"k\">case</span> <span class=\"n\">deviceName</span> <span class=\"o\">=</span> <span class=\"s\">\"DeviceName\"</span>\n        <span class=\"k\">case</span> <span class=\"n\">deviceModel</span> <span class=\"o\">=</span> <span class=\"s\">\"DeviceModel\"</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>By defining these custom keys, we can decode it as before:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">device</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"kt\">JSONDecoder</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"nf\">decode</span><span class=\"p\">(</span><span class=\"kt\">Device</span><span class=\"o\">.</span><span class=\"k\">self</span><span class=\"p\">,</span> <span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">json</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">deviceName</span><span class=\"p\">)</span> <span class=\"c1\">// iPhone 12 Pro</span>\n</code></pre></div></div>\n\n<p>This is great, but… it has obvious downsides. For large data objects and specially large APIs, it can be tedious and repetitive to type down the coding keys for each property. Imagine having hundreds of properties among dozens of data transfer objects. Lots of boilerplate. While there are generator tools that can generate these coding keys for you, it is still not ideal.</p>\n\n<p>My recommendation would be to define coding keys <em>only</em> when working with inconsistent APIs and JSON payloads. This is, when there is a mix of formats and some properties use different formats. Sadly, this happens, and there are many APIs out there that lack any sense of consistency. In these scenarios, manually defining coding keys is the way to go.</p>\n\n<h3 id=\"so-what-is-the-alternative\">So, what is the alternative?</h3>\n\n<p>Depending on the JSON key format, we could update our Swift structure to match, as long as the format is valid Swift code (hyphens are not allowed in property names, but underscores are).</p>\n\n<p>Here is an example for <code class=\"language-plaintext highlighter-rouge\">PascalCase</code>:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">Device</span><span class=\"p\">:</span> <span class=\"kt\">Codable</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">DeviceName</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">DeviceModel</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>An another example for <code class=\"language-plaintext highlighter-rouge\">snake_case</code>:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">Device</span><span class=\"p\">:</span> <span class=\"kt\">Codable</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">device_name</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">device_model</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>Both of these are valid Swift code, but we are breaking naming conventions and introducing inconsistency in our code. There are cases where this is totally fine. However, in many cases, this would be considered bad practice and, if you have a linter or code formatter, you might find yourself adding rule exceptions.</p>\n\n<h3 id=\"how-can-we-do-better\">How can we do better?</h3>\n\n<p>Fortunately, both <code class=\"language-plaintext highlighter-rouge\">JSONEncoder</code> and <code class=\"language-plaintext highlighter-rouge\">JSONDecoder</code> allow for defining custom key encoding/decoding strategies. This can be a little tricky the first time, but it is worth the effort, specially if, as mentioned, the API you are working with is pretty consistent in a given format.</p>\n\n<h2 id=\"defining-custom-key-decoding-strategies\">Defining Custom Key Decoding Strategies</h2>\n\n<p>Going back to the above scenario where the JSON has keys in <code class=\"language-plaintext highlighter-rouge\">PascalCase</code> format, we can define a custom strategy as follows. Here is our original bare structure, without manually defined coding keys:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">Device</span><span class=\"p\">:</span> <span class=\"kt\">Codable</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">deviceName</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">deviceModel</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>To define a custom strategy, first we will define a custom <code class=\"language-plaintext highlighter-rouge\">CustomKey</code> type. This is because the strategy must return a type that conforms to <code class=\"language-plaintext highlighter-rouge\">CodingKey</code> (same concept as the enumeration), and we cannot make instances of a protocol.</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">CustomKey</span><span class=\"p\">:</span> <span class=\"kt\">CodingKey</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">stringValue</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">intValue</span><span class=\"p\">:</span> <span class=\"kt\">Int</span><span class=\"p\">?</span>\n\n    <span class=\"nf\">init</span><span class=\"p\">(</span><span class=\"nv\">stringValue</span><span class=\"p\">:</span> <span class=\"kt\">String</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"k\">self</span><span class=\"o\">.</span><span class=\"n\">stringValue</span> <span class=\"o\">=</span> <span class=\"n\">stringValue</span>\n        <span class=\"n\">intValue</span> <span class=\"o\">=</span> <span class=\"kc\">nil</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"nf\">init</span><span class=\"p\">(</span><span class=\"nv\">intValue</span><span class=\"p\">:</span> <span class=\"kt\">Int</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"k\">self</span><span class=\"o\">.</span><span class=\"n\">intValue</span> <span class=\"o\">=</span> <span class=\"n\">intValue</span>\n        <span class=\"n\">stringValue</span> <span class=\"o\">=</span> <span class=\"kt\">String</span><span class=\"p\">(</span><span class=\"n\">intValue</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>Then we can use it to decode any type as follows:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">decoder</span> <span class=\"o\">=</span> <span class=\"kt\">JSONDecoder</span><span class=\"p\">()</span>\n<span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"n\">keyDecodingStrategy</span> <span class=\"o\">=</span> <span class=\"o\">.</span><span class=\"n\">custom</span> <span class=\"p\">{</span> <span class=\"n\">keys</span> <span class=\"k\">in</span>\n    <span class=\"k\">let</span> <span class=\"nv\">last</span> <span class=\"o\">=</span> <span class=\"n\">keys</span><span class=\"o\">.</span><span class=\"n\">last</span><span class=\"o\">!.</span><span class=\"n\">stringValue</span>\n    <span class=\"k\">return</span> <span class=\"kt\">CustomKey</span><span class=\"p\">(</span><span class=\"nv\">stringValue</span><span class=\"p\">:</span> <span class=\"n\">last</span><span class=\"o\">.</span><span class=\"nf\">prefix</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">lowercased</span><span class=\"p\">()</span> <span class=\"o\">+</span> <span class=\"n\">last</span><span class=\"o\">.</span><span class=\"nf\">dropFirst</span><span class=\"p\">())</span>\n<span class=\"p\">}</span>\n<span class=\"k\">let</span> <span class=\"nv\">device</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"nf\">decode</span><span class=\"p\">(</span><span class=\"kt\">Device</span><span class=\"o\">.</span><span class=\"k\">self</span><span class=\"p\">,</span> <span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">json</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">deviceName</span><span class=\"p\">)</span> <span class=\"c1\">// iPhone 12 Pro</span>\n</code></pre></div></div>\n\n<p>Our custom strategy converts from <code class=\"language-plaintext highlighter-rouge\">PascalCase</code> to <code class=\"language-plaintext highlighter-rouge\">camelCase</code> to map any properties from C# naming convention to Swift.</p>\n\n<p>The take away in this example is that we only need to define this once for all our data models and API endpoints consumed. As we develop our applications, we can keep adding and updating our data models without having to manually type or generate coding keys.</p>\n\n<p>We can take this a step further by defining a specific <code class=\"language-plaintext highlighter-rouge\">PascalCaseKey</code> type to encapsulate our conversion logic:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">PascalCaseKey</span><span class=\"p\">:</span> <span class=\"kt\">CodingKey</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">stringValue</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">intValue</span><span class=\"p\">:</span> <span class=\"kt\">Int</span><span class=\"p\">?</span>\n\n    <span class=\"nf\">init</span><span class=\"p\">(</span><span class=\"nv\">stringValue</span><span class=\"p\">:</span> <span class=\"kt\">String</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"k\">self</span><span class=\"o\">.</span><span class=\"n\">stringValue</span> <span class=\"o\">=</span> <span class=\"n\">stringValue</span><span class=\"o\">.</span><span class=\"nf\">prefix</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">lowercased</span><span class=\"p\">()</span> <span class=\"o\">+</span> <span class=\"n\">stringValue</span><span class=\"o\">.</span><span class=\"nf\">dropFirst</span><span class=\"p\">()</span>\n        <span class=\"n\">intValue</span> <span class=\"o\">=</span> <span class=\"kc\">nil</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"nf\">init</span><span class=\"p\">(</span><span class=\"nv\">intValue</span><span class=\"p\">:</span> <span class=\"kt\">Int</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"n\">stringValue</span> <span class=\"o\">=</span> <span class=\"kt\">String</span><span class=\"p\">(</span><span class=\"n\">intValue</span><span class=\"p\">)</span>\n        <span class=\"k\">self</span><span class=\"o\">.</span><span class=\"n\">intValue</span> <span class=\"o\">=</span> <span class=\"n\">intValue</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>Then we can use it as follows:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">decoder</span> <span class=\"o\">=</span> <span class=\"kt\">JSONDecoder</span><span class=\"p\">()</span>\n<span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"n\">keyDecodingStrategy</span> <span class=\"o\">=</span> <span class=\"o\">.</span><span class=\"n\">custom</span> <span class=\"p\">{</span> <span class=\"n\">keys</span> <span class=\"k\">in</span> <span class=\"kt\">PascalCaseKey</span><span class=\"p\">(</span><span class=\"nv\">stringValue</span><span class=\"p\">:</span> <span class=\"n\">keys</span><span class=\"o\">.</span><span class=\"n\">last</span><span class=\"o\">!.</span><span class=\"n\">stringValue</span><span class=\"p\">)</span> <span class=\"p\">}</span>\n<span class=\"k\">let</span> <span class=\"nv\">device</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"nf\">decode</span><span class=\"p\">(</span><span class=\"kt\">Device</span><span class=\"o\">.</span><span class=\"k\">self</span><span class=\"p\">,</span> <span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">json</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">deviceName</span><span class=\"p\">)</span> <span class=\"c1\">// iPhone 12 Pro</span>\n</code></pre></div></div>\n\n<p>This is a very efficient way of defining a custom strategy for decoding JSON keys. As long as you can convert your keys to match your Swift property names, you can implement this for any key format.</p>\n\n<h2 id=\"extending-jsondecoder-with-custom-key-decoding-strategies\">Extending <code class=\"language-plaintext highlighter-rouge\">JSONDecoder</code> with Custom Key Decoding Strategies</h2>\n\n<p>If you are working on a framework or library, or simply would rather provide a simple solution for your application, it is possible to extend <code class=\"language-plaintext highlighter-rouge\">JSONDecoder</code> (and <code class=\"language-plaintext highlighter-rouge\">JSONEncoder</code>) to add custom key decoding/encoding strategies.</p>\n\n<p>Based on the examples above, we can write this extension:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">extension</span> <span class=\"kt\">JSONDecoder</span><span class=\"o\">.</span><span class=\"kt\">KeyDecodingStrategy</span> <span class=\"p\">{</span>\n    <span class=\"kd\">static</span> <span class=\"k\">var</span> <span class=\"nv\">convertFromPascalCase</span><span class=\"p\">:</span> <span class=\"k\">Self</span> <span class=\"p\">{</span>\n        <span class=\"o\">.</span><span class=\"n\">custom</span> <span class=\"p\">{</span> <span class=\"n\">keys</span> <span class=\"k\">in</span>\n            <span class=\"kt\">PascalCaseKey</span><span class=\"p\">(</span><span class=\"nv\">stringValue</span><span class=\"p\">:</span> <span class=\"n\">keys</span><span class=\"o\">.</span><span class=\"n\">last</span><span class=\"o\">!.</span><span class=\"n\">stringValue</span><span class=\"p\">)</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>And use it as follows:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">decoder</span> <span class=\"o\">=</span> <span class=\"kt\">JSONDecoder</span><span class=\"p\">()</span>\n<span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"n\">keyDecodingStrategy</span> <span class=\"o\">=</span> <span class=\"o\">.</span><span class=\"n\">convertFromPascalCase</span>\n<span class=\"k\">let</span> <span class=\"nv\">device</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"nf\">decode</span><span class=\"p\">(</span><span class=\"kt\">Device</span><span class=\"o\">.</span><span class=\"k\">self</span><span class=\"p\">,</span> <span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">json</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">deviceName</span><span class=\"p\">)</span> <span class=\"c1\">// iPhone 12 Pro</span>\n</code></pre></div></div>\n\n<p>Hurray! No more manually defining coding keys for our data models 🎉</p>\n\n<p>Using this technique we can create API clients, persistence layers or any other code that works with JSON, and fully encapsulate and abstract the JSON key format, without exposing it to the rest of the application and without defining coding keys for each model property.</p>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/23\">Issue #23</a>)</p>\n    <p>First draft: 2021-01-13</p>\n    <p>Published on: 2021-01-14</p>\n    <p>Last update: 2021-01-14</p>\n</div>",
      "summary": "<p>Swift’s <a href=\"https://developer.apple.com/documentation/swift/codable\"><code class=\"language-plaintext highlighter-rouge\">Codable</code></a> protocol (together with <code class=\"language-plaintext highlighter-rouge\">Encodable</code> and <code class=\"language-plaintext highlighter-rouge\">Decodable</code>) was introduced in Xcode 9 with Swift 4. This changed for good how we encode and decode JSON. In this article I’m hoping to show you how to make this experience better, when dealing with JSON keys in other formats.</p>\n\n<h2 id=\"encodingdecoding-json-with-camelcase-keys\">Encoding/Decoding JSON with <code class=\"language-plaintext highlighter-rouge\">camelCase</code> keys</h2>\n\n<p>If we are lucky, the JSON we work with will follow Swift naming conventions.</p>\n\n<blockquote>\n  <p>Names of types and protocols are UpperCamelCase. Everything else is lowerCamelCase.</p>\n\n  <p><a href=\"https://swift.org/documentation/api-design-guidelines/#conventions\">Swift API Design Guidelines - Conventions</a></p>\n</blockquote>\n\n<p>This convention uses lower camel case (<code class=\"language-plaintext highlighter-rouge\">camelCase</code>) for object/struct property names. In this scenario, we can encode/decode JSON objects straight out of the box, without any modifications.</p>\n\n<p>Given the following Swift structure:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">Device</span><span class=\"p\">:</span> <span class=\"kt\">Codable</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">deviceName</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">deviceModel</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>And the following JSON:</p>\n<div class=\"language-json highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"nl\">\"deviceName\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"iPhone 12 Pro\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"nl\">\"deviceModel\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"iPhone\"</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<p>We can decode it as follows:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">device</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"kt\">JSONDecoder</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"nf\">decode</span><span class=\"p\">(</span><span class=\"kt\">Device</span><span class=\"o\">.</span><span class=\"k\">self</span><span class=\"p\">,</span> <span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">json</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">deviceName</span><span class=\"p\">)</span> <span class=\"c1\">// iPhone 12 Pro</span>\n</code></pre></div></div>\n\n<p>Nothing new here, pretty straightforward 😉</p>\n\n<h2 id=\"encodingdecoding-json-with-snake_case-keys\">Encoding/Decoding JSON with <code class=\"language-plaintext highlighter-rouge\">snake_case</code> keys</h2>\n\n<p>Snake case is the standard <a href=\"https://en.wikipedia.org/wiki/Snake_case\">naming convention in some programming languages</a>, like Python and Ruby. Thus, is pretty common to see <code class=\"language-plaintext highlighter-rouge\">snake_case</code> used for JSON properties.</p>\n\n<p>Fortunately, Swift includes an out-of-the-box solution to parse JSON in this format. <a href=\"https://developer.apple.com/documentation/foundation/jsondecoder/keydecodingstrategy\"><code class=\"language-plaintext highlighter-rouge\">JSONDecoder.KeyDecodingStrategy</code></a> includes a convenient <code class=\"language-plaintext highlighter-rouge\">convertFromSnakeCase</code> option (see <code class=\"language-plaintext highlighter-rouge\">convertToSnakeCase</code> for <code class=\"language-plaintext highlighter-rouge\">JSONEncoder</code>)</p>\n\n<p>Given the following JSON:</p>\n<div class=\"language-json highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"nl\">\"device_name\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"iPhone 12 Pro\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"nl\">\"device_model\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"iPhone\"</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<p>We can decode it as follows:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">decoder</span> <span class=\"o\">=</span> <span class=\"kt\">JSONDecoder</span><span class=\"p\">()</span>\n<span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"n\">keyDecodingStrategy</span> <span class=\"o\">=</span> <span class=\"o\">.</span><span class=\"n\">convertFromSnakeCase</span>\n<span class=\"k\">let</span> <span class=\"nv\">device</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"nf\">decode</span><span class=\"p\">(</span><span class=\"kt\">Device</span><span class=\"o\">.</span><span class=\"k\">self</span><span class=\"p\">,</span> <span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">json</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">deviceName</span><span class=\"p\">)</span> <span class=\"c1\">// iPhone 12 Pro</span>\n</code></pre></div></div>\n\n<p>Pretty cool. One line of code, and we are all set 🎉</p>\n\n<h2 id=\"encodingdecoding-json-with-custom-case-keys\">Encoding/Decoding JSON with <code class=\"language-plaintext highlighter-rouge\">CuSToM-CaSe</code> keys</h2>\n\n<p>What about other common cases? While <code class=\"language-plaintext highlighter-rouge\">lowerCamelCase</code> and <code class=\"language-plaintext highlighter-rouge\">snake_case</code> might be the two most popular formats for JSON object keys, some programming languages might have different conventions.</p>\n\n<p>For example, <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/inside-a-program/identifier-names#naming-conventions\">C# uses <code class=\"language-plaintext highlighter-rouge\">PascalCase</code> for property names</a>, and it’s common for C# APIs to return JSON in this format.</p>\n\n<p>Example JSON with <code class=\"language-plaintext highlighter-rouge\">PascalCase</code> keys:</p>\n<div class=\"language-json highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"nl\">\"DeviceName\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"iPhone 12 Pro\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"nl\">\"DeviceModel\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"iPhone\"</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<p>A common way to handle these keys is by defining a <code class=\"language-plaintext highlighter-rouge\">CodingKeys</code> enumeration conforming to <code class=\"language-plaintext highlighter-rouge\">String &amp; CodingKey</code>, as shown in <a href=\"https://developer.apple.com/documentation/foundation/archives_and_serialization/encoding_and_decoding_custom_types\">Apple documentation examples</a> and many other articles.</p>\n\n<p>Following this pattern, we would update our Swift structure as follows:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">Device</span><span class=\"p\">:</span> <span class=\"kt\">Codable</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">deviceName</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">deviceModel</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n\n    <span class=\"kd\">enum</span> <span class=\"kt\">CodingKeys</span><span class=\"p\">:</span> <span class=\"kt\">String</span><span class=\"p\">,</span> <span class=\"kt\">CodingKey</span> <span class=\"p\">{</span>\n        <span class=\"k\">case</span> <span class=\"n\">deviceName</span> <span class=\"o\">=</span> <span class=\"s\">\"DeviceName\"</span>\n        <span class=\"k\">case</span> <span class=\"n\">deviceModel</span> <span class=\"o\">=</span> <span class=\"s\">\"DeviceModel\"</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>By defining these custom keys, we can decode it as before:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">device</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"kt\">JSONDecoder</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"nf\">decode</span><span class=\"p\">(</span><span class=\"kt\">Device</span><span class=\"o\">.</span><span class=\"k\">self</span><span class=\"p\">,</span> <span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">json</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">deviceName</span><span class=\"p\">)</span> <span class=\"c1\">// iPhone 12 Pro</span>\n</code></pre></div></div>\n\n<p>This is great, but… it has obvious downsides. For large data objects and specially large APIs, it can be tedious and repetitive to type down the coding keys for each property. Imagine having hundreds of properties among dozens of data transfer objects. Lots of boilerplate. While there are generator tools that can generate these coding keys for you, it is still not ideal.</p>\n\n<p>My recommendation would be to define coding keys <em>only</em> when working with inconsistent APIs and JSON payloads. This is, when there is a mix of formats and some properties use different formats. Sadly, this happens, and there are many APIs out there that lack any sense of consistency. In these scenarios, manually defining coding keys is the way to go.</p>\n\n<h3 id=\"so-what-is-the-alternative\">So, what is the alternative?</h3>\n\n<p>Depending on the JSON key format, we could update our Swift structure to match, as long as the format is valid Swift code (hyphens are not allowed in property names, but underscores are).</p>\n\n<p>Here is an example for <code class=\"language-plaintext highlighter-rouge\">PascalCase</code>:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">Device</span><span class=\"p\">:</span> <span class=\"kt\">Codable</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">DeviceName</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">DeviceModel</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>An another example for <code class=\"language-plaintext highlighter-rouge\">snake_case</code>:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">Device</span><span class=\"p\">:</span> <span class=\"kt\">Codable</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">device_name</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">device_model</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>Both of these are valid Swift code, but we are breaking naming conventions and introducing inconsistency in our code. There are cases where this is totally fine. However, in many cases, this would be considered bad practice and, if you have a linter or code formatter, you might find yourself adding rule exceptions.</p>\n\n<h3 id=\"how-can-we-do-better\">How can we do better?</h3>\n\n<p>Fortunately, both <code class=\"language-plaintext highlighter-rouge\">JSONEncoder</code> and <code class=\"language-plaintext highlighter-rouge\">JSONDecoder</code> allow for defining custom key encoding/decoding strategies. This can be a little tricky the first time, but it is worth the effort, specially if, as mentioned, the API you are working with is pretty consistent in a given format.</p>\n\n<h2 id=\"defining-custom-key-decoding-strategies\">Defining Custom Key Decoding Strategies</h2>\n\n<p>Going back to the above scenario where the JSON has keys in <code class=\"language-plaintext highlighter-rouge\">PascalCase</code> format, we can define a custom strategy as follows. Here is our original bare structure, without manually defined coding keys:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">Device</span><span class=\"p\">:</span> <span class=\"kt\">Codable</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">deviceName</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">deviceModel</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>To define a custom strategy, first we will define a custom <code class=\"language-plaintext highlighter-rouge\">CustomKey</code> type. This is because the strategy must return a type that conforms to <code class=\"language-plaintext highlighter-rouge\">CodingKey</code> (same concept as the enumeration), and we cannot make instances of a protocol.</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">CustomKey</span><span class=\"p\">:</span> <span class=\"kt\">CodingKey</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">stringValue</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">intValue</span><span class=\"p\">:</span> <span class=\"kt\">Int</span><span class=\"p\">?</span>\n\n    <span class=\"nf\">init</span><span class=\"p\">(</span><span class=\"nv\">stringValue</span><span class=\"p\">:</span> <span class=\"kt\">String</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"k\">self</span><span class=\"o\">.</span><span class=\"n\">stringValue</span> <span class=\"o\">=</span> <span class=\"n\">stringValue</span>\n        <span class=\"n\">intValue</span> <span class=\"o\">=</span> <span class=\"kc\">nil</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"nf\">init</span><span class=\"p\">(</span><span class=\"nv\">intValue</span><span class=\"p\">:</span> <span class=\"kt\">Int</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"k\">self</span><span class=\"o\">.</span><span class=\"n\">intValue</span> <span class=\"o\">=</span> <span class=\"n\">intValue</span>\n        <span class=\"n\">stringValue</span> <span class=\"o\">=</span> <span class=\"kt\">String</span><span class=\"p\">(</span><span class=\"n\">intValue</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>Then we can use it to decode any type as follows:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">decoder</span> <span class=\"o\">=</span> <span class=\"kt\">JSONDecoder</span><span class=\"p\">()</span>\n<span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"n\">keyDecodingStrategy</span> <span class=\"o\">=</span> <span class=\"o\">.</span><span class=\"n\">custom</span> <span class=\"p\">{</span> <span class=\"n\">keys</span> <span class=\"k\">in</span>\n    <span class=\"k\">let</span> <span class=\"nv\">last</span> <span class=\"o\">=</span> <span class=\"n\">keys</span><span class=\"o\">.</span><span class=\"n\">last</span><span class=\"o\">!.</span><span class=\"n\">stringValue</span>\n    <span class=\"k\">return</span> <span class=\"kt\">CustomKey</span><span class=\"p\">(</span><span class=\"nv\">stringValue</span><span class=\"p\">:</span> <span class=\"n\">last</span><span class=\"o\">.</span><span class=\"nf\">prefix</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">lowercased</span><span class=\"p\">()</span> <span class=\"o\">+</span> <span class=\"n\">last</span><span class=\"o\">.</span><span class=\"nf\">dropFirst</span><span class=\"p\">())</span>\n<span class=\"p\">}</span>\n<span class=\"k\">let</span> <span class=\"nv\">device</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"nf\">decode</span><span class=\"p\">(</span><span class=\"kt\">Device</span><span class=\"o\">.</span><span class=\"k\">self</span><span class=\"p\">,</span> <span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">json</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">deviceName</span><span class=\"p\">)</span> <span class=\"c1\">// iPhone 12 Pro</span>\n</code></pre></div></div>\n\n<p>Our custom strategy converts from <code class=\"language-plaintext highlighter-rouge\">PascalCase</code> to <code class=\"language-plaintext highlighter-rouge\">camelCase</code> to map any properties from C# naming convention to Swift.</p>\n\n<p>The take away in this example is that we only need to define this once for all our data models and API endpoints consumed. As we develop our applications, we can keep adding and updating our data models without having to manually type or generate coding keys.</p>\n\n<p>We can take this a step further by defining a specific <code class=\"language-plaintext highlighter-rouge\">PascalCaseKey</code> type to encapsulate our conversion logic:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">PascalCaseKey</span><span class=\"p\">:</span> <span class=\"kt\">CodingKey</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">stringValue</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">intValue</span><span class=\"p\">:</span> <span class=\"kt\">Int</span><span class=\"p\">?</span>\n\n    <span class=\"nf\">init</span><span class=\"p\">(</span><span class=\"nv\">stringValue</span><span class=\"p\">:</span> <span class=\"kt\">String</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"k\">self</span><span class=\"o\">.</span><span class=\"n\">stringValue</span> <span class=\"o\">=</span> <span class=\"n\">stringValue</span><span class=\"o\">.</span><span class=\"nf\">prefix</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">lowercased</span><span class=\"p\">()</span> <span class=\"o\">+</span> <span class=\"n\">stringValue</span><span class=\"o\">.</span><span class=\"nf\">dropFirst</span><span class=\"p\">()</span>\n        <span class=\"n\">intValue</span> <span class=\"o\">=</span> <span class=\"kc\">nil</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"nf\">init</span><span class=\"p\">(</span><span class=\"nv\">intValue</span><span class=\"p\">:</span> <span class=\"kt\">Int</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"n\">stringValue</span> <span class=\"o\">=</span> <span class=\"kt\">String</span><span class=\"p\">(</span><span class=\"n\">intValue</span><span class=\"p\">)</span>\n        <span class=\"k\">self</span><span class=\"o\">.</span><span class=\"n\">intValue</span> <span class=\"o\">=</span> <span class=\"n\">intValue</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>Then we can use it as follows:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">decoder</span> <span class=\"o\">=</span> <span class=\"kt\">JSONDecoder</span><span class=\"p\">()</span>\n<span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"n\">keyDecodingStrategy</span> <span class=\"o\">=</span> <span class=\"o\">.</span><span class=\"n\">custom</span> <span class=\"p\">{</span> <span class=\"n\">keys</span> <span class=\"k\">in</span> <span class=\"kt\">PascalCaseKey</span><span class=\"p\">(</span><span class=\"nv\">stringValue</span><span class=\"p\">:</span> <span class=\"n\">keys</span><span class=\"o\">.</span><span class=\"n\">last</span><span class=\"o\">!.</span><span class=\"n\">stringValue</span><span class=\"p\">)</span> <span class=\"p\">}</span>\n<span class=\"k\">let</span> <span class=\"nv\">device</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"nf\">decode</span><span class=\"p\">(</span><span class=\"kt\">Device</span><span class=\"o\">.</span><span class=\"k\">self</span><span class=\"p\">,</span> <span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">json</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">deviceName</span><span class=\"p\">)</span> <span class=\"c1\">// iPhone 12 Pro</span>\n</code></pre></div></div>\n\n<p>This is a very efficient way of defining a custom strategy for decoding JSON keys. As long as you can convert your keys to match your Swift property names, you can implement this for any key format.</p>\n\n<h2 id=\"extending-jsondecoder-with-custom-key-decoding-strategies\">Extending <code class=\"language-plaintext highlighter-rouge\">JSONDecoder</code> with Custom Key Decoding Strategies</h2>\n\n<p>If you are working on a framework or library, or simply would rather provide a simple solution for your application, it is possible to extend <code class=\"language-plaintext highlighter-rouge\">JSONDecoder</code> (and <code class=\"language-plaintext highlighter-rouge\">JSONEncoder</code>) to add custom key decoding/encoding strategies.</p>\n\n<p>Based on the examples above, we can write this extension:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">extension</span> <span class=\"kt\">JSONDecoder</span><span class=\"o\">.</span><span class=\"kt\">KeyDecodingStrategy</span> <span class=\"p\">{</span>\n    <span class=\"kd\">static</span> <span class=\"k\">var</span> <span class=\"nv\">convertFromPascalCase</span><span class=\"p\">:</span> <span class=\"k\">Self</span> <span class=\"p\">{</span>\n        <span class=\"o\">.</span><span class=\"n\">custom</span> <span class=\"p\">{</span> <span class=\"n\">keys</span> <span class=\"k\">in</span>\n            <span class=\"kt\">PascalCaseKey</span><span class=\"p\">(</span><span class=\"nv\">stringValue</span><span class=\"p\">:</span> <span class=\"n\">keys</span><span class=\"o\">.</span><span class=\"n\">last</span><span class=\"o\">!.</span><span class=\"n\">stringValue</span><span class=\"p\">)</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>And use it as follows:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">decoder</span> <span class=\"o\">=</span> <span class=\"kt\">JSONDecoder</span><span class=\"p\">()</span>\n<span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"n\">keyDecodingStrategy</span> <span class=\"o\">=</span> <span class=\"o\">.</span><span class=\"n\">convertFromPascalCase</span>\n<span class=\"k\">let</span> <span class=\"nv\">device</span> <span class=\"o\">=</span> <span class=\"k\">try</span> <span class=\"n\">decoder</span><span class=\"o\">.</span><span class=\"nf\">decode</span><span class=\"p\">(</span><span class=\"kt\">Device</span><span class=\"o\">.</span><span class=\"k\">self</span><span class=\"p\">,</span> <span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">json</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">device</span><span class=\"o\">.</span><span class=\"n\">deviceName</span><span class=\"p\">)</span> <span class=\"c1\">// iPhone 12 Pro</span>\n</code></pre></div></div>\n\n<p>Hurray! No more manually defining coding keys for our data models 🎉</p>\n\n<p>Using this technique we can create API clients, persistence layers or any other code that works with JSON, and fully encapsulate and abstract the JSON key format, without exposing it to the rest of the application and without defining coding keys for each model property.</p>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/23\">Issue #23</a>)</p>\n    <p>First draft: 2021-01-13</p>\n    <p>Published on: 2021-01-14</p>\n    <p>Last update: 2021-01-14</p>\n</div>",
      "date_published": "2021-01-14T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-22",
      "url": "https://www.enekoalonso.com/articles/issue-22",
      "title": "Using regular expressions in Xcode to search and replace text",
      "content_html": "<p>I had to convert a long list of error codes from C# to a Swift enum, and thought this would be a great opportunity to use regular expressions.</p>\n\n<p>Error codes looked like this example:</p>\n<pre><code class=\"language-C#\">ConsumerSchedulingInfoNotFound = 304,\n</code></pre>\n\n<p>I’m using an enum with <code class=\"language-plaintext highlighter-rouge\">String</code> rawValue, so it can be easily initialized from JSON. The same error code in the enum would look like this:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">case</span> <span class=\"n\">consumerSchedulingInfoNotFound</span> <span class=\"o\">=</span> <span class=\"s\">\"ConsumerSchedulingInfoNotFound\"</span>\n</code></pre></div></div>\n\n<p>Doing this conversion manually over a list of over a hundred error codes would be tedious. Regular expressions to the rescue!</p>\n\n<h2 id=\"using-regular-expressions-to-search-text-in-xcode\">Using Regular Expressions to search text in Xcode</h2>\n\n<p>In the search panel, click on the “Text” label and a dropdown will appear:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103937671-f26a9d80-50dd-11eb-80bf-e4ddfbe43c07.png\" alt=\"Screen Shot 2021-01-07 at 11 44 49 AM\" /></p>\n\n<p>Select “Regular Expression”:\n<img src=\"https://user-images.githubusercontent.com/32922/103937689-fac2d880-50dd-11eb-8be6-a43cefdd27e3.png\" alt=\"Screen Shot 2021-01-07 at 11 45 01 AM\" /></p>\n\n<p>In my case, I used the following expression:</p>\n\n<pre><code class=\"language-regex\">(\\w+) = \\d+,\n</code></pre>\n\n<p>The first part on the left, <code class=\"language-plaintext highlighter-rouge\">\\w+</code>, fill match any “word” characters. The ‘+’ indicates there must be one letter, or more. It is wrapped into parenthesis to indicate we want to capture the value. In regular expressions, parenthesis are capture groups.</p>\n\n<p>The rest of the expression matches the equal symbol, with spaces, and an integer number (again, one or more digits) followed by a comma. All the text in the expression will be replaced.</p>\n\n<p>To enter search/replace form, tap on “Find” and a dropdown will appear. Select “Replace”:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103938086-92282b80-50de-11eb-87b0-645a1db9553a.png\" alt=\"Screen Shot 2021-01-07 at 11 50 26 AM\" /></p>\n\n<h2 id=\"replacing-text-in-xcode-using-captured-values-from-regular-expressions\">Replacing text in Xcode using captured values from regular expressions</h2>\n\n<p>In the replacement text box we can now use the captured groups from the search expression. In my case, the replacement looks as follows:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>case $1 = \"$1\"\n</code></pre></div></div>\n\n<p><code class=\"language-plaintext highlighter-rouge\">$1</code> denotes the first capture group. Note <code class=\"language-plaintext highlighter-rouge\">$0</code> is available too, but that contains the entire matched text. If we had multiple capture groups (multiple sets of parenthesis), we would use <code class=\"language-plaintext highlighter-rouge\">$2</code>, <code class=\"language-plaintext highlighter-rouge\">$3</code>, etc.</p>\n\n<p>The enum case name will have the error code, and the raw value string will use the same value, between double quotes.</p>\n\n<h2 id=\"uppercase--lowercase-with-regular-expressions-in-xcode\">Uppercase &amp; lowercase with regular expressions in Xcode</h2>\n\n<p>Unfortunately, Xcode does not seem to support <a href=\"https://www.boost.org/doc/libs/1_44_0/libs/regex/doc/html/boost_regex/format/perl_format.html\">Boost escape codes for regular expressions</a>, so I might have to manually lowercase the first letter of the error code. Swift does not require doing this, but I prefer this syntax.</p>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/22\">Issue #22</a>)</p>\n    <p>First draft: 2021-01-07</p>\n    <p>Published on: 2021-01-07</p>\n    <p>Last update: 2021-01-07</p>\n</div>",
      "summary": "<p>I had to convert a long list of error codes from C# to a Swift enum, and thought this would be a great opportunity to use regular expressions.</p>\n\n<p>Error codes looked like this example:</p>\n<pre><code class=\"language-C#\">ConsumerSchedulingInfoNotFound = 304,\n</code></pre>\n\n<p>I’m using an enum with <code class=\"language-plaintext highlighter-rouge\">String</code> rawValue, so it can be easily initialized from JSON. The same error code in the enum would look like this:</p>\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">case</span> <span class=\"n\">consumerSchedulingInfoNotFound</span> <span class=\"o\">=</span> <span class=\"s\">\"ConsumerSchedulingInfoNotFound\"</span>\n</code></pre></div></div>\n\n<p>Doing this conversion manually over a list of over a hundred error codes would be tedious. Regular expressions to the rescue!</p>\n\n<h2 id=\"using-regular-expressions-to-search-text-in-xcode\">Using Regular Expressions to search text in Xcode</h2>\n\n<p>In the search panel, click on the “Text” label and a dropdown will appear:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103937671-f26a9d80-50dd-11eb-80bf-e4ddfbe43c07.png\" alt=\"Screen Shot 2021-01-07 at 11 44 49 AM\" /></p>\n\n<p>Select “Regular Expression”:\n<img src=\"https://user-images.githubusercontent.com/32922/103937689-fac2d880-50dd-11eb-8be6-a43cefdd27e3.png\" alt=\"Screen Shot 2021-01-07 at 11 45 01 AM\" /></p>\n\n<p>In my case, I used the following expression:</p>\n\n<pre><code class=\"language-regex\">(\\w+) = \\d+,\n</code></pre>\n\n<p>The first part on the left, <code class=\"language-plaintext highlighter-rouge\">\\w+</code>, fill match any “word” characters. The ‘+’ indicates there must be one letter, or more. It is wrapped into parenthesis to indicate we want to capture the value. In regular expressions, parenthesis are capture groups.</p>\n\n<p>The rest of the expression matches the equal symbol, with spaces, and an integer number (again, one or more digits) followed by a comma. All the text in the expression will be replaced.</p>\n\n<p>To enter search/replace form, tap on “Find” and a dropdown will appear. Select “Replace”:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103938086-92282b80-50de-11eb-87b0-645a1db9553a.png\" alt=\"Screen Shot 2021-01-07 at 11 50 26 AM\" /></p>\n\n<h2 id=\"replacing-text-in-xcode-using-captured-values-from-regular-expressions\">Replacing text in Xcode using captured values from regular expressions</h2>\n\n<p>In the replacement text box we can now use the captured groups from the search expression. In my case, the replacement looks as follows:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>case $1 = \"$1\"\n</code></pre></div></div>\n\n<p><code class=\"language-plaintext highlighter-rouge\">$1</code> denotes the first capture group. Note <code class=\"language-plaintext highlighter-rouge\">$0</code> is available too, but that contains the entire matched text. If we had multiple capture groups (multiple sets of parenthesis), we would use <code class=\"language-plaintext highlighter-rouge\">$2</code>, <code class=\"language-plaintext highlighter-rouge\">$3</code>, etc.</p>\n\n<p>The enum case name will have the error code, and the raw value string will use the same value, between double quotes.</p>\n\n<h2 id=\"uppercase--lowercase-with-regular-expressions-in-xcode\">Uppercase &amp; lowercase with regular expressions in Xcode</h2>\n\n<p>Unfortunately, Xcode does not seem to support <a href=\"https://www.boost.org/doc/libs/1_44_0/libs/regex/doc/html/boost_regex/format/perl_format.html\">Boost escape codes for regular expressions</a>, so I might have to manually lowercase the first letter of the error code. Swift does not require doing this, but I prefer this syntax.</p>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/22\">Issue #22</a>)</p>\n    <p>First draft: 2021-01-07</p>\n    <p>Published on: 2021-01-07</p>\n    <p>Last update: 2021-01-07</p>\n</div>",
      "date_published": "2021-01-07T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-20",
      "url": "https://www.enekoalonso.com/articles/issue-20",
      "title": "Using GitHub label colors for social media image background",
      "content_html": "<p>After I started using GitHub Actions to generate social media preview images for my blog, I wanted to use them on my home page. This part was easy, but wasn’t too fond on the result: too many blue rectangles 😅</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103723611-50d13800-4f87-11eb-9135-b4a6e1774e8b.png\" alt=\"Screen Shot 2021-01-03 at 6 24 54 PM\" /></p>\n\n<p>I figured I could use the color from GitHub labels associated to the blog article, to set different background colors for the images. Since articles can have multiple tags, I made a list of tags by priority. Maybe, for another day, I will combine the colors in some way, like merging colors, using them in different areas of the image.</p>\n\n<p>I wrote a quick conversion method from hex color string to SwiftIU <code class=\"language-plaintext highlighter-rouge\">Color</code>, since GitHub label colors come in that format:</p>\n\n<div class=\"language-json highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nl\">\"labels\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n      </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"nl\">\"color\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"F05138\"</span><span class=\"p\">,</span><span class=\"w\">\n        </span><span class=\"nl\">\"default\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"kc\">false</span><span class=\"p\">,</span><span class=\"w\">\n        </span><span class=\"nl\">\"description\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"\"</span><span class=\"p\">,</span><span class=\"w\">\n        </span><span class=\"nl\">\"id\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">2614311701</span><span class=\"p\">,</span><span class=\"w\">\n        </span><span class=\"nl\">\"name\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"SwiftUI\"</span><span class=\"p\">,</span><span class=\"w\">\n        </span><span class=\"nl\">\"node_id\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"MDU6TGFiZWwyNjE0MzExNzAx\"</span><span class=\"p\">,</span><span class=\"w\">\n        </span><span class=\"nl\">\"url\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://api.github.com/repos/eneko/Blog/labels/SwiftUI\"</span><span class=\"w\">\n      </span><span class=\"p\">},</span><span class=\"w\">\n      </span><span class=\"err\">...</span><span class=\"w\">\n</span><span class=\"p\">]</span><span class=\"err\">,</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<p>Color parser:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">import</span> <span class=\"kt\">SwiftUI</span>\n\n<span class=\"kd\">public</span> <span class=\"kd\">struct</span> <span class=\"kt\">ColorParser</span> <span class=\"p\">{</span>\n\n    <span class=\"kd\">public</span> <span class=\"nf\">init</span><span class=\"p\">()</span> <span class=\"p\">{}</span>\n\n    <span class=\"kd\">public</span> <span class=\"kd\">func</span> <span class=\"nf\">parse</span><span class=\"p\">(</span><span class=\"nv\">color</span><span class=\"p\">:</span> <span class=\"kt\">String</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">Color</span> <span class=\"p\">{</span>\n        <span class=\"k\">guard</span> <span class=\"n\">color</span><span class=\"o\">.</span><span class=\"n\">count</span> <span class=\"o\">==</span> <span class=\"mi\">6</span> <span class=\"k\">else</span> <span class=\"p\">{</span>\n            <span class=\"nf\">fatalError</span><span class=\"p\">(</span><span class=\"s\">\"Expected 6 characters, got </span><span class=\"se\">\\(</span><span class=\"n\">color</span><span class=\"o\">.</span><span class=\"n\">count</span><span class=\"se\">)</span><span class=\"s\">\"</span><span class=\"p\">)</span>\n        <span class=\"p\">}</span>\n        <span class=\"k\">let</span> <span class=\"nv\">red</span> <span class=\"o\">=</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"nf\">byte</span><span class=\"p\">(</span><span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">color</span><span class=\"o\">.</span><span class=\"nf\">dropLast</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">)))</span> <span class=\"o\">/</span> <span class=\"mi\">255</span>\n        <span class=\"k\">let</span> <span class=\"nv\">green</span> <span class=\"o\">=</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"nf\">byte</span><span class=\"p\">(</span><span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">color</span><span class=\"o\">.</span><span class=\"nf\">dropFirst</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">dropLast</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">)))</span> <span class=\"o\">/</span> <span class=\"mi\">255</span>\n        <span class=\"k\">let</span> <span class=\"nv\">blue</span> <span class=\"o\">=</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"nf\">byte</span><span class=\"p\">(</span><span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">color</span><span class=\"o\">.</span><span class=\"nf\">dropFirst</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">)))</span> <span class=\"o\">/</span> <span class=\"mi\">255</span>\n        <span class=\"k\">return</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"kt\">Color</span><span class=\"o\">.</span><span class=\"kt\">RGBColorSpace</span><span class=\"o\">.</span><span class=\"n\">sRGB</span><span class=\"p\">,</span> <span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"n\">red</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"n\">green</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"n\">blue</span><span class=\"p\">,</span> <span class=\"nv\">opacity</span><span class=\"p\">:</span> <span class=\"mf\">1.0</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"kd\">public</span> <span class=\"kd\">func</span> <span class=\"nf\">byte</span><span class=\"p\">(</span><span class=\"n\">from</span> <span class=\"nv\">hex</span><span class=\"p\">:</span> <span class=\"kt\">Substring</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">UInt8</span> <span class=\"p\">{</span>\n        <span class=\"k\">return</span> <span class=\"kt\">UInt8</span><span class=\"p\">(</span><span class=\"n\">hex</span><span class=\"p\">,</span> <span class=\"nv\">radix</span><span class=\"p\">:</span> <span class=\"mi\">16</span><span class=\"p\">)</span> <span class=\"p\">??</span> <span class=\"mi\">0</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>List of colorized backgrounds, by tag priority:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>    <span class=\"c1\">/// Select colors for social media preview based on labels. Labels are prioritized as ordered below (from less common to more common).</span>\n    <span class=\"kd\">static</span> <span class=\"kd\">func</span> <span class=\"nf\">colors</span><span class=\"p\">(</span><span class=\"n\">from</span> <span class=\"nv\">issue</span><span class=\"p\">:</span> <span class=\"kt\">GitHubIssue</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"p\">(</span><span class=\"nv\">background</span><span class=\"p\">:</span> <span class=\"kt\">Color</span><span class=\"p\">,</span> <span class=\"nv\">foreground</span><span class=\"p\">:</span> <span class=\"kt\">Color</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"k\">let</span> <span class=\"nv\">customLabels</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n            <span class=\"s\">\"Challenge\"</span><span class=\"p\">,</span>\n            <span class=\"s\">\"Command Line\"</span><span class=\"p\">,</span>\n            <span class=\"s\">\"SwiftUI\"</span><span class=\"p\">,</span>\n            <span class=\"s\">\"AWS\"</span><span class=\"p\">,</span>\n            <span class=\"s\">\"Linux\"</span><span class=\"p\">,</span>\n            <span class=\"s\">\"GitHub Actions\"</span><span class=\"p\">,</span>\n            <span class=\"s\">\"Tips\"</span><span class=\"p\">,</span>\n        <span class=\"p\">]</span>\n        <span class=\"k\">for</span> <span class=\"n\">name</span> <span class=\"k\">in</span> <span class=\"n\">customLabels</span> <span class=\"p\">{</span>\n            <span class=\"k\">if</span> <span class=\"k\">let</span> <span class=\"nv\">label</span> <span class=\"o\">=</span> <span class=\"n\">issue</span><span class=\"o\">.</span><span class=\"n\">labels</span><span class=\"o\">.</span><span class=\"nf\">first</span><span class=\"p\">(</span><span class=\"nv\">where</span><span class=\"p\">:</span> <span class=\"p\">{</span> <span class=\"nv\">$0</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"n\">name</span> <span class=\"p\">})</span> <span class=\"p\">{</span>\n                <span class=\"nf\">return</span> <span class=\"p\">(</span><span class=\"nv\">background</span><span class=\"p\">:</span> <span class=\"kt\">ColorParser</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"nf\">parse</span><span class=\"p\">(</span><span class=\"nv\">color</span><span class=\"p\">:</span> <span class=\"n\">label</span><span class=\"o\">.</span><span class=\"n\">color</span><span class=\"p\">),</span> <span class=\"nv\">foreground</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">white</span><span class=\"p\">)</span>\n            <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n        <span class=\"nf\">return</span> <span class=\"p\">(</span><span class=\"nv\">background</span><span class=\"p\">:</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.1843137255</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.5411764706</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">)),</span> <span class=\"nv\">foreground</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">white</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>I’m not to fond on the idea of hardcoding the labels, but definitely want to have some prioritization. Will keep thinking about it and make improvements as needed.</p>\n\n<p>Here is the result, a bit more colorful, looking much better I would say:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103980388-aac33080-5134-11eb-93fc-aecb45b8127e.png\" alt=\"Screen Shot 2021-01-07 at 10 06 33 PM\" /></p>\n\n<p>As you can see on the screenshot, I also made other improvements, drawing triangles in SwiftUI. I’m planning on writing another post about that, hopefully will finish soon.</p>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/20\">Issue #20</a>)</p>\n    <p>First draft: 2021-01-05</p>\n    <p>Published on: 2021-01-07</p>\n    <p>Last update: 2021-01-07</p>\n</div>",
      "summary": "<p>After I started using GitHub Actions to generate social media preview images for my blog, I wanted to use them on my home page. This part was easy, but wasn’t too fond on the result: too many blue rectangles 😅</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103723611-50d13800-4f87-11eb-9135-b4a6e1774e8b.png\" alt=\"Screen Shot 2021-01-03 at 6 24 54 PM\" /></p>\n\n<p>I figured I could use the color from GitHub labels associated to the blog article, to set different background colors for the images. Since articles can have multiple tags, I made a list of tags by priority. Maybe, for another day, I will combine the colors in some way, like merging colors, using them in different areas of the image.</p>\n\n<p>I wrote a quick conversion method from hex color string to SwiftIU <code class=\"language-plaintext highlighter-rouge\">Color</code>, since GitHub label colors come in that format:</p>\n\n<div class=\"language-json highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nl\">\"labels\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n      </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"nl\">\"color\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"F05138\"</span><span class=\"p\">,</span><span class=\"w\">\n        </span><span class=\"nl\">\"default\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"kc\">false</span><span class=\"p\">,</span><span class=\"w\">\n        </span><span class=\"nl\">\"description\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"\"</span><span class=\"p\">,</span><span class=\"w\">\n        </span><span class=\"nl\">\"id\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">2614311701</span><span class=\"p\">,</span><span class=\"w\">\n        </span><span class=\"nl\">\"name\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"SwiftUI\"</span><span class=\"p\">,</span><span class=\"w\">\n        </span><span class=\"nl\">\"node_id\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"MDU6TGFiZWwyNjE0MzExNzAx\"</span><span class=\"p\">,</span><span class=\"w\">\n        </span><span class=\"nl\">\"url\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"https://api.github.com/repos/eneko/Blog/labels/SwiftUI\"</span><span class=\"w\">\n      </span><span class=\"p\">},</span><span class=\"w\">\n      </span><span class=\"err\">...</span><span class=\"w\">\n</span><span class=\"p\">]</span><span class=\"err\">,</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<p>Color parser:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">import</span> <span class=\"kt\">SwiftUI</span>\n\n<span class=\"kd\">public</span> <span class=\"kd\">struct</span> <span class=\"kt\">ColorParser</span> <span class=\"p\">{</span>\n\n    <span class=\"kd\">public</span> <span class=\"nf\">init</span><span class=\"p\">()</span> <span class=\"p\">{}</span>\n\n    <span class=\"kd\">public</span> <span class=\"kd\">func</span> <span class=\"nf\">parse</span><span class=\"p\">(</span><span class=\"nv\">color</span><span class=\"p\">:</span> <span class=\"kt\">String</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">Color</span> <span class=\"p\">{</span>\n        <span class=\"k\">guard</span> <span class=\"n\">color</span><span class=\"o\">.</span><span class=\"n\">count</span> <span class=\"o\">==</span> <span class=\"mi\">6</span> <span class=\"k\">else</span> <span class=\"p\">{</span>\n            <span class=\"nf\">fatalError</span><span class=\"p\">(</span><span class=\"s\">\"Expected 6 characters, got </span><span class=\"se\">\\(</span><span class=\"n\">color</span><span class=\"o\">.</span><span class=\"n\">count</span><span class=\"se\">)</span><span class=\"s\">\"</span><span class=\"p\">)</span>\n        <span class=\"p\">}</span>\n        <span class=\"k\">let</span> <span class=\"nv\">red</span> <span class=\"o\">=</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"nf\">byte</span><span class=\"p\">(</span><span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">color</span><span class=\"o\">.</span><span class=\"nf\">dropLast</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">)))</span> <span class=\"o\">/</span> <span class=\"mi\">255</span>\n        <span class=\"k\">let</span> <span class=\"nv\">green</span> <span class=\"o\">=</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"nf\">byte</span><span class=\"p\">(</span><span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">color</span><span class=\"o\">.</span><span class=\"nf\">dropFirst</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">dropLast</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">)))</span> <span class=\"o\">/</span> <span class=\"mi\">255</span>\n        <span class=\"k\">let</span> <span class=\"nv\">blue</span> <span class=\"o\">=</span> <span class=\"kt\">Double</span><span class=\"p\">(</span><span class=\"nf\">byte</span><span class=\"p\">(</span><span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">color</span><span class=\"o\">.</span><span class=\"nf\">dropFirst</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">)))</span> <span class=\"o\">/</span> <span class=\"mi\">255</span>\n        <span class=\"k\">return</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"kt\">Color</span><span class=\"o\">.</span><span class=\"kt\">RGBColorSpace</span><span class=\"o\">.</span><span class=\"n\">sRGB</span><span class=\"p\">,</span> <span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"n\">red</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"n\">green</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"n\">blue</span><span class=\"p\">,</span> <span class=\"nv\">opacity</span><span class=\"p\">:</span> <span class=\"mf\">1.0</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"kd\">public</span> <span class=\"kd\">func</span> <span class=\"nf\">byte</span><span class=\"p\">(</span><span class=\"n\">from</span> <span class=\"nv\">hex</span><span class=\"p\">:</span> <span class=\"kt\">Substring</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">UInt8</span> <span class=\"p\">{</span>\n        <span class=\"k\">return</span> <span class=\"kt\">UInt8</span><span class=\"p\">(</span><span class=\"n\">hex</span><span class=\"p\">,</span> <span class=\"nv\">radix</span><span class=\"p\">:</span> <span class=\"mi\">16</span><span class=\"p\">)</span> <span class=\"p\">??</span> <span class=\"mi\">0</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>List of colorized backgrounds, by tag priority:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>    <span class=\"c1\">/// Select colors for social media preview based on labels. Labels are prioritized as ordered below (from less common to more common).</span>\n    <span class=\"kd\">static</span> <span class=\"kd\">func</span> <span class=\"nf\">colors</span><span class=\"p\">(</span><span class=\"n\">from</span> <span class=\"nv\">issue</span><span class=\"p\">:</span> <span class=\"kt\">GitHubIssue</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"p\">(</span><span class=\"nv\">background</span><span class=\"p\">:</span> <span class=\"kt\">Color</span><span class=\"p\">,</span> <span class=\"nv\">foreground</span><span class=\"p\">:</span> <span class=\"kt\">Color</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"k\">let</span> <span class=\"nv\">customLabels</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n            <span class=\"s\">\"Challenge\"</span><span class=\"p\">,</span>\n            <span class=\"s\">\"Command Line\"</span><span class=\"p\">,</span>\n            <span class=\"s\">\"SwiftUI\"</span><span class=\"p\">,</span>\n            <span class=\"s\">\"AWS\"</span><span class=\"p\">,</span>\n            <span class=\"s\">\"Linux\"</span><span class=\"p\">,</span>\n            <span class=\"s\">\"GitHub Actions\"</span><span class=\"p\">,</span>\n            <span class=\"s\">\"Tips\"</span><span class=\"p\">,</span>\n        <span class=\"p\">]</span>\n        <span class=\"k\">for</span> <span class=\"n\">name</span> <span class=\"k\">in</span> <span class=\"n\">customLabels</span> <span class=\"p\">{</span>\n            <span class=\"k\">if</span> <span class=\"k\">let</span> <span class=\"nv\">label</span> <span class=\"o\">=</span> <span class=\"n\">issue</span><span class=\"o\">.</span><span class=\"n\">labels</span><span class=\"o\">.</span><span class=\"nf\">first</span><span class=\"p\">(</span><span class=\"nv\">where</span><span class=\"p\">:</span> <span class=\"p\">{</span> <span class=\"nv\">$0</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"o\">==</span> <span class=\"n\">name</span> <span class=\"p\">})</span> <span class=\"p\">{</span>\n                <span class=\"nf\">return</span> <span class=\"p\">(</span><span class=\"nv\">background</span><span class=\"p\">:</span> <span class=\"kt\">ColorParser</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"nf\">parse</span><span class=\"p\">(</span><span class=\"nv\">color</span><span class=\"p\">:</span> <span class=\"n\">label</span><span class=\"o\">.</span><span class=\"n\">color</span><span class=\"p\">),</span> <span class=\"nv\">foreground</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">white</span><span class=\"p\">)</span>\n            <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n        <span class=\"nf\">return</span> <span class=\"p\">(</span><span class=\"nv\">background</span><span class=\"p\">:</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.1843137255</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.5411764706</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">)),</span> <span class=\"nv\">foreground</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">white</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>I’m not to fond on the idea of hardcoding the labels, but definitely want to have some prioritization. Will keep thinking about it and make improvements as needed.</p>\n\n<p>Here is the result, a bit more colorful, looking much better I would say:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103980388-aac33080-5134-11eb-93fc-aecb45b8127e.png\" alt=\"Screen Shot 2021-01-07 at 10 06 33 PM\" /></p>\n\n<p>As you can see on the screenshot, I also made other improvements, drawing triangles in SwiftUI. I’m planning on writing another post about that, hopefully will finish soon.</p>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/20\">Issue #20</a>)</p>\n    <p>First draft: 2021-01-05</p>\n    <p>Published on: 2021-01-07</p>\n    <p>Last update: 2021-01-07</p>\n</div>",
      "date_published": "2021-01-07T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-18",
      "url": "https://www.enekoalonso.com/articles/issue-18",
      "title": "Preventing GitHub workflows from running when the issue is still open",
      "content_html": "<p>I’ve been working on some updates for my Blog Engine here and there. One of the updates was to prevent the <a href=\"https://github.com/eneko/Blog/blob/main/.github/workflows/issue.yml\">publishing workflow</a> from being triggered while working on an article.</p>\n\n<p>Before I was using a label Draft, and manually checking for it in my Swift code. But at that point, the only way to stop the workflow would be to make it fail.</p>\n\n<p>Instead, using <a href=\"https://docs.github.com/en/free-pro-team@latest/actions/reference/context-and-expression-syntax-for-github-actions#about-contexts-and-expressions\">action <code class=\"language-plaintext highlighter-rouge\">if</code> conditions</a>, I can check for the issue to be closed (what I treat as “published”), in which case the workflow can continue:</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"na\">jobs</span><span class=\"pi\">:</span>\n  <span class=\"na\">generateSocialPreview</span><span class=\"pi\">:</span>\n    <span class=\"na\">runs-on</span><span class=\"pi\">:</span> <span class=\"s\">macos-latest</span>\n    <span class=\"na\">if</span><span class=\"pi\">:</span> <span class=\"s\">github.event.issue.user.login == github.repository_owner &amp;&amp; github.event.issue.state == 'closed'</span>\n    <span class=\"na\">steps</span><span class=\"pi\">:</span>\n       <span class=\"pi\">-</span> <span class=\"s\">...</span>\n</code></pre></div></div>\n\n<p>Note I’m also checking the issue author is me, the owner of the <a href=\"https://github.com/eneko/Blog\">Blog</a> repo.</p>\n\n<p>As a result, the workflow run will still appear in the Actions tab, but greyed out indicating the skipped jobs:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103795954-7c8e0580-4ffb-11eb-8834-0909d615dd87.png\" alt=\"Screen Shot 2021-01-06 at 8 43 57 AM\" /></p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103795947-7ac44200-4ffb-11eb-8458-860973989556.png\" alt=\"Screen Shot 2021-01-06 at 8 43 48 AM\" /></p>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/18\">Issue #18</a>)</p>\n    <p>First draft: 2021-01-04</p>\n    <p>Published on: 2021-01-05</p>\n    <p>Last update: 2021-01-06</p>\n</div>",
      "summary": "<p>I’ve been working on some updates for my Blog Engine here and there. One of the updates was to prevent the <a href=\"https://github.com/eneko/Blog/blob/main/.github/workflows/issue.yml\">publishing workflow</a> from being triggered while working on an article.</p>\n\n<p>Before I was using a label Draft, and manually checking for it in my Swift code. But at that point, the only way to stop the workflow would be to make it fail.</p>\n\n<p>Instead, using <a href=\"https://docs.github.com/en/free-pro-team@latest/actions/reference/context-and-expression-syntax-for-github-actions#about-contexts-and-expressions\">action <code class=\"language-plaintext highlighter-rouge\">if</code> conditions</a>, I can check for the issue to be closed (what I treat as “published”), in which case the workflow can continue:</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"na\">jobs</span><span class=\"pi\">:</span>\n  <span class=\"na\">generateSocialPreview</span><span class=\"pi\">:</span>\n    <span class=\"na\">runs-on</span><span class=\"pi\">:</span> <span class=\"s\">macos-latest</span>\n    <span class=\"na\">if</span><span class=\"pi\">:</span> <span class=\"s\">github.event.issue.user.login == github.repository_owner &amp;&amp; github.event.issue.state == 'closed'</span>\n    <span class=\"na\">steps</span><span class=\"pi\">:</span>\n       <span class=\"pi\">-</span> <span class=\"s\">...</span>\n</code></pre></div></div>\n\n<p>Note I’m also checking the issue author is me, the owner of the <a href=\"https://github.com/eneko/Blog\">Blog</a> repo.</p>\n\n<p>As a result, the workflow run will still appear in the Actions tab, but greyed out indicating the skipped jobs:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103795954-7c8e0580-4ffb-11eb-8834-0909d615dd87.png\" alt=\"Screen Shot 2021-01-06 at 8 43 57 AM\" /></p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103795947-7ac44200-4ffb-11eb-8458-860973989556.png\" alt=\"Screen Shot 2021-01-06 at 8 43 48 AM\" /></p>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/18\">Issue #18</a>)</p>\n    <p>First draft: 2021-01-04</p>\n    <p>Published on: 2021-01-05</p>\n    <p>Last update: 2021-01-06</p>\n</div>",
      "date_published": "2021-01-05T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-16",
      "url": "https://www.enekoalonso.com/articles/issue-16",
      "title": "Twelve Days of Christmas",
      "content_html": "<p>I didn’t want to end the year without completing this challenge from <a href=\"https://twitter.com/scottsmithdev/status/1341395333973225473\">Scott Smith (@scottsmithdev)</a>. The challenge consists on printing out the lyrics of the song Twelve Days of Christmas without repeating any of the lyrics lines in code.</p>\n\n<h2 id=\"the-lyrics\">The Lyrics</h2>\n\n<p>I <a href=\"https://www.metrolyrics.com/twelve-days-of-christmas-lyrics-christmas-carols.html\">found the lyrics on the internet</a>, might not be exact punctuation, casing, etc.</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>🎄🎶 The Twelve Days Of Christmas 🎶🎄 \n\nOn the 1st day of Christmas\nMy true love gave to me:\nA partridge in a pear tree.\n\nOn the 2nd day of Christmas\nMy true love gave to me:\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 3rd day of Christmas\nMy true love gave to me:\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 4th day of Christmas\nMy true love gave to me:\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 5th day of Christmas\nMy true love gave to me:\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 6th day of Christmas\nMy true love gave to me:\nSix geese a-laying,\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 7th day of Christmas\nMy true love gave to me:\nSeven swans a-swimming,\nSix geese a-laying,\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 8th day of Christmas\nMy true love gave to me:\nEight maids a-milking,\nSeven swans a-swimming,\nSix geese a-laying,\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 9th day of Christmas\nMy true love gave to me:\nNine ladies dancing,\nEight maids a-milking,\nSeven swans a-swimming,\nSix geese a-laying,\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 10th day of Christmas\nMy true love gave to me:\nTen lords a-leaping,\nNine ladies dancing,\nEight maids a-milking,\nSeven swans a-swimming,\nSix geese a-laying,\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 11th day of Christmas\nMy true love gave to me:\n'Leven pipers piping,\nTen lords a-leaping,\nNine ladies dancing,\nEight maids a-milking,\nSeven swans a-swimming,\nSix geese a-laying,\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 12th day of Christmas\nMy true love gave to me:\nTwelve drummers drumming,\n'Leven pipers piping,\nTen lords a-leaping,\nNine ladies dancing,\nEight maids a-milking,\nSeven swans a-swimming,\nSix geese a-laying,\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n</code></pre></div></div>\n\n<h2 id=\"the-code\">The code</h2>\n\n<p>I implemented this as a command line executable. I used <code class=\"language-plaintext highlighter-rouge\">NumberFormatter</code>\nfor the day ordinal (unfortunatelly, there is no spelled-out ordinal fomatter). I also\nused <code class=\"language-plaintext highlighter-rouge\">usleep()</code> to slow down the print feed. Didn’t spend time trying to match\nthe song too accurately, but better than nothing 😀</p>\n\n<p>The code is relatively easy. One outer for loop for each of the twelve days, and \none reverse inner loop for repeating the lyrics down to the first day.</p>\n\n<p>Here is the source code (also published at <a href=\"https://github.com/eneko/TwelveDaysOfChristmas\">TwelveDaysOfChristmas</a>):</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">title</span> <span class=\"o\">=</span> <span class=\"s\">\"🎄🎶 The Twelve Days Of Christmas 🎶🎄\"</span>\n<span class=\"k\">let</span> <span class=\"nv\">lyrics</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"s\">\"On the %@ day of Christmas\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"My true love gave to me:\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"A partridge in a pear tree.\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"And\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Two turtle doves,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Three french hens,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Four calling birds,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Five golden rings,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Six geese a-laying,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Seven swans a-swimming,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Eight maids a-milking,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Nine ladies dancing,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Ten lords a-leaping,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"'Leven pipers piping,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Twelve drummers drumming,\"</span>\n<span class=\"p\">]</span>\n\n<span class=\"k\">let</span> <span class=\"nv\">lineSleep</span><span class=\"p\">:</span> <span class=\"kt\">UInt32</span> <span class=\"o\">=</span> <span class=\"mi\">400000</span> <span class=\"c1\">// Make zero for instant print</span>\n<span class=\"k\">let</span> <span class=\"nv\">formatter</span> <span class=\"o\">=</span> <span class=\"kt\">NumberFormatter</span><span class=\"p\">()</span>\n<span class=\"n\">formatter</span><span class=\"o\">.</span><span class=\"n\">numberStyle</span> <span class=\"o\">=</span> <span class=\"o\">.</span><span class=\"n\">ordinal</span>\n\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">title</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">()</span>\n\n<span class=\"k\">for</span> <span class=\"n\">day</span> <span class=\"k\">in</span> <span class=\"mi\">1</span><span class=\"o\">...</span><span class=\"mi\">12</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">ordinal</span> <span class=\"o\">=</span> <span class=\"n\">formatter</span><span class=\"o\">.</span><span class=\"nf\">string</span><span class=\"p\">(</span><span class=\"nv\">for</span><span class=\"p\">:</span> <span class=\"n\">day</span><span class=\"p\">)</span> <span class=\"p\">??</span> <span class=\"s\">\"\"</span>\n    <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"kt\">String</span><span class=\"p\">(</span><span class=\"nv\">format</span><span class=\"p\">:</span> <span class=\"n\">lyrics</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">ordinal</span><span class=\"p\">))</span>\n    <span class=\"nf\">usleep</span><span class=\"p\">(</span><span class=\"n\">lineSleep</span><span class=\"p\">)</span>\n    <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">lyrics</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n    <span class=\"nf\">usleep</span><span class=\"p\">(</span><span class=\"n\">lineSleep</span><span class=\"p\">)</span>\n    <span class=\"k\">var</span> <span class=\"nv\">currentLine</span> <span class=\"o\">=</span> <span class=\"n\">day</span> <span class=\"o\">+</span> <span class=\"p\">(</span><span class=\"n\">day</span> <span class=\"o\">&gt;</span> <span class=\"mi\">1</span> <span class=\"p\">?</span> <span class=\"mi\">2</span> <span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n    <span class=\"k\">repeat</span> <span class=\"p\">{</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">lyrics</span><span class=\"p\">[</span><span class=\"n\">currentLine</span><span class=\"p\">])</span>\n        <span class=\"n\">currentLine</span> <span class=\"o\">-=</span> <span class=\"mi\">1</span><span class=\"p\">;</span>\n        <span class=\"nf\">usleep</span><span class=\"p\">(</span><span class=\"n\">lineSleep</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span> <span class=\"k\">while</span> <span class=\"n\">currentLine</span> <span class=\"o\">&gt;</span> <span class=\"mi\">1</span>\n    <span class=\"nf\">print</span><span class=\"p\">()</span>\n    <span class=\"nf\">usleep</span><span class=\"p\">(</span><span class=\"mi\">3</span> <span class=\"o\">*</span> <span class=\"n\">lineSleep</span><span class=\"p\">)</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>Happy Holidays! 🎉🎄🎊🎇🎆</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/16\">Issue #16</a>)</small></i></p>",
      "summary": "<p>I didn’t want to end the year without completing this challenge from <a href=\"https://twitter.com/scottsmithdev/status/1341395333973225473\">Scott Smith (@scottsmithdev)</a>. The challenge consists on printing out the lyrics of the song Twelve Days of Christmas without repeating any of the lyrics lines in code.</p>\n\n<h2 id=\"the-lyrics\">The Lyrics</h2>\n\n<p>I <a href=\"https://www.metrolyrics.com/twelve-days-of-christmas-lyrics-christmas-carols.html\">found the lyrics on the internet</a>, might not be exact punctuation, casing, etc.</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>🎄🎶 The Twelve Days Of Christmas 🎶🎄 \n\nOn the 1st day of Christmas\nMy true love gave to me:\nA partridge in a pear tree.\n\nOn the 2nd day of Christmas\nMy true love gave to me:\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 3rd day of Christmas\nMy true love gave to me:\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 4th day of Christmas\nMy true love gave to me:\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 5th day of Christmas\nMy true love gave to me:\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 6th day of Christmas\nMy true love gave to me:\nSix geese a-laying,\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 7th day of Christmas\nMy true love gave to me:\nSeven swans a-swimming,\nSix geese a-laying,\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 8th day of Christmas\nMy true love gave to me:\nEight maids a-milking,\nSeven swans a-swimming,\nSix geese a-laying,\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 9th day of Christmas\nMy true love gave to me:\nNine ladies dancing,\nEight maids a-milking,\nSeven swans a-swimming,\nSix geese a-laying,\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 10th day of Christmas\nMy true love gave to me:\nTen lords a-leaping,\nNine ladies dancing,\nEight maids a-milking,\nSeven swans a-swimming,\nSix geese a-laying,\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 11th day of Christmas\nMy true love gave to me:\n'Leven pipers piping,\nTen lords a-leaping,\nNine ladies dancing,\nEight maids a-milking,\nSeven swans a-swimming,\nSix geese a-laying,\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n\nOn the 12th day of Christmas\nMy true love gave to me:\nTwelve drummers drumming,\n'Leven pipers piping,\nTen lords a-leaping,\nNine ladies dancing,\nEight maids a-milking,\nSeven swans a-swimming,\nSix geese a-laying,\nFive golden rings,\nFour calling birdsm,\nThree french hens,\nTwo turtle doves,\nAnd\nA partridge in a pear tree.\n</code></pre></div></div>\n\n<h2 id=\"the-code\">The code</h2>\n\n<p>I implemented this as a command line executable. I used <code class=\"language-plaintext highlighter-rouge\">NumberFormatter</code>\nfor the day ordinal (unfortunatelly, there is no spelled-out ordinal fomatter). I also\nused <code class=\"language-plaintext highlighter-rouge\">usleep()</code> to slow down the print feed. Didn’t spend time trying to match\nthe song too accurately, but better than nothing 😀</p>\n\n<p>The code is relatively easy. One outer for loop for each of the twelve days, and \none reverse inner loop for repeating the lyrics down to the first day.</p>\n\n<p>Here is the source code (also published at <a href=\"https://github.com/eneko/TwelveDaysOfChristmas\">TwelveDaysOfChristmas</a>):</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">let</span> <span class=\"nv\">title</span> <span class=\"o\">=</span> <span class=\"s\">\"🎄🎶 The Twelve Days Of Christmas 🎶🎄\"</span>\n<span class=\"k\">let</span> <span class=\"nv\">lyrics</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"s\">\"On the %@ day of Christmas\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"My true love gave to me:\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"A partridge in a pear tree.\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"And\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Two turtle doves,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Three french hens,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Four calling birds,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Five golden rings,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Six geese a-laying,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Seven swans a-swimming,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Eight maids a-milking,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Nine ladies dancing,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Ten lords a-leaping,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"'Leven pipers piping,\"</span><span class=\"p\">,</span>\n    <span class=\"s\">\"Twelve drummers drumming,\"</span>\n<span class=\"p\">]</span>\n\n<span class=\"k\">let</span> <span class=\"nv\">lineSleep</span><span class=\"p\">:</span> <span class=\"kt\">UInt32</span> <span class=\"o\">=</span> <span class=\"mi\">400000</span> <span class=\"c1\">// Make zero for instant print</span>\n<span class=\"k\">let</span> <span class=\"nv\">formatter</span> <span class=\"o\">=</span> <span class=\"kt\">NumberFormatter</span><span class=\"p\">()</span>\n<span class=\"n\">formatter</span><span class=\"o\">.</span><span class=\"n\">numberStyle</span> <span class=\"o\">=</span> <span class=\"o\">.</span><span class=\"n\">ordinal</span>\n\n<span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">title</span><span class=\"p\">)</span>\n<span class=\"nf\">print</span><span class=\"p\">()</span>\n\n<span class=\"k\">for</span> <span class=\"n\">day</span> <span class=\"k\">in</span> <span class=\"mi\">1</span><span class=\"o\">...</span><span class=\"mi\">12</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">ordinal</span> <span class=\"o\">=</span> <span class=\"n\">formatter</span><span class=\"o\">.</span><span class=\"nf\">string</span><span class=\"p\">(</span><span class=\"nv\">for</span><span class=\"p\">:</span> <span class=\"n\">day</span><span class=\"p\">)</span> <span class=\"p\">??</span> <span class=\"s\">\"\"</span>\n    <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"kt\">String</span><span class=\"p\">(</span><span class=\"nv\">format</span><span class=\"p\">:</span> <span class=\"n\">lyrics</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">ordinal</span><span class=\"p\">))</span>\n    <span class=\"nf\">usleep</span><span class=\"p\">(</span><span class=\"n\">lineSleep</span><span class=\"p\">)</span>\n    <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">lyrics</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n    <span class=\"nf\">usleep</span><span class=\"p\">(</span><span class=\"n\">lineSleep</span><span class=\"p\">)</span>\n    <span class=\"k\">var</span> <span class=\"nv\">currentLine</span> <span class=\"o\">=</span> <span class=\"n\">day</span> <span class=\"o\">+</span> <span class=\"p\">(</span><span class=\"n\">day</span> <span class=\"o\">&gt;</span> <span class=\"mi\">1</span> <span class=\"p\">?</span> <span class=\"mi\">2</span> <span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n    <span class=\"k\">repeat</span> <span class=\"p\">{</span>\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"n\">lyrics</span><span class=\"p\">[</span><span class=\"n\">currentLine</span><span class=\"p\">])</span>\n        <span class=\"n\">currentLine</span> <span class=\"o\">-=</span> <span class=\"mi\">1</span><span class=\"p\">;</span>\n        <span class=\"nf\">usleep</span><span class=\"p\">(</span><span class=\"n\">lineSleep</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span> <span class=\"k\">while</span> <span class=\"n\">currentLine</span> <span class=\"o\">&gt;</span> <span class=\"mi\">1</span>\n    <span class=\"nf\">print</span><span class=\"p\">()</span>\n    <span class=\"nf\">usleep</span><span class=\"p\">(</span><span class=\"mi\">3</span> <span class=\"o\">*</span> <span class=\"n\">lineSleep</span><span class=\"p\">)</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>Happy Holidays! 🎉🎄🎊🎇🎆</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/16\">Issue #16</a>)</small></i></p>",
      "date_published": "2020-12-31T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-15",
      "url": "https://www.enekoalonso.com/articles/issue-15",
      "title": "The power of plain text",
      "content_html": "<p>I’m sitting in the couch te-reading The Pragmatic Programmer, and couldn’t but share this quote.</p>\n\n<blockquote>\n  <p>…we believe that the best format for storing knowledge persistently is <em>plain text</em>. With plain text, we give ourselves the ability to manipulate knowledge, both manually and programmatically, using virtually every tool at our disposal.</p>\n\n  <p>The problem with most binary formats is that the context necessary to understand the data is separate from the data itself. You are artificially divorcing the data from its meaning. The data might as well be encrypted; it is absolutely meaningless without the application logic to parse it.</p>\n\n  <p>[…]</p>\n\n  <p>Human-readable forms of data, and self-describing data, will outlive all other forms of data and the applications that created them. Period. As long as the data survives, you will have a chance to be able to use it—potentially long after the original application that wrote it is defunct.</p>\n\n  <p><a href=\"https://amzn.to/3obyyiO\">The Pragmatic Programmer</a> — Chapter 3, pages 74-75</p>\n</blockquote>\n\n<p>The reasoning is solid: you can write an application to parse plain-text from 50 years ago (see <a href=\"https://tools.ietf.org/html/rfc561\">RFC 561</a> which describes Email headers, as an example), and arguably you could do it without ever reading the specification. Something like that would be really hard to do with a binary file format.</p>\n\n<p>Plain-text allows for easy interoperability: HTML, FTP and Email were the foundation of the web. XML and JSON made it possible to write programmatic interfaces without having to share application logic.</p>\n\n<p>Some examples of application document formats migrated from binary files to plain-text include Microsoft Office, and Xcode, both project and Interface Builder files.</p>\n\n<p>Using plain-text seems a good approach to keep in mind when writing applications that save documents, data or state to disk.</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/15\">Issue #15</a>)</small></i></p>",
      "summary": "<p>I’m sitting in the couch te-reading The Pragmatic Programmer, and couldn’t but share this quote.</p>\n\n<blockquote>\n  <p>…we believe that the best format for storing knowledge persistently is <em>plain text</em>. With plain text, we give ourselves the ability to manipulate knowledge, both manually and programmatically, using virtually every tool at our disposal.</p>\n\n  <p>The problem with most binary formats is that the context necessary to understand the data is separate from the data itself. You are artificially divorcing the data from its meaning. The data might as well be encrypted; it is absolutely meaningless without the application logic to parse it.</p>\n\n  <p>[…]</p>\n\n  <p>Human-readable forms of data, and self-describing data, will outlive all other forms of data and the applications that created them. Period. As long as the data survives, you will have a chance to be able to use it—potentially long after the original application that wrote it is defunct.</p>\n\n  <p><a href=\"https://amzn.to/3obyyiO\">The Pragmatic Programmer</a> — Chapter 3, pages 74-75</p>\n</blockquote>\n\n<p>The reasoning is solid: you can write an application to parse plain-text from 50 years ago (see <a href=\"https://tools.ietf.org/html/rfc561\">RFC 561</a> which describes Email headers, as an example), and arguably you could do it without ever reading the specification. Something like that would be really hard to do with a binary file format.</p>\n\n<p>Plain-text allows for easy interoperability: HTML, FTP and Email were the foundation of the web. XML and JSON made it possible to write programmatic interfaces without having to share application logic.</p>\n\n<p>Some examples of application document formats migrated from binary files to plain-text include Microsoft Office, and Xcode, both project and Interface Builder files.</p>\n\n<p>Using plain-text seems a good approach to keep in mind when writing applications that save documents, data or state to disk.</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/15\">Issue #15</a>)</small></i></p>",
      "date_published": "2020-12-28T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-14",
      "url": "https://www.enekoalonso.com/articles/issue-14",
      "title": "Making beautiful architecture diagrams with Keynote",
      "content_html": "<p>I started working on an updated architecture diagram to illustrate the current state of my Blog Engine, and decided to write about the tools I use.</p>\n\n<h2 id=\"why-keynote\">Why Keynote?</h2>\n\n<p>I am a big fan of <a href=\"https://www.graphviz.org/doc/info/lang.html\">Dot</a>, a text-based language for making undirected and directed graphs using only text. Among other things, I’ve used Dot for generating <a href=\"https://github.com/eneko/SourceDocs/blob/master/docs/Package.md\">Swift Package documentation with SourceDocs</a>, or this <a href=\"https://github.com/eneko/Bobiverse\">diagram of Bobiverse</a> (first book). Using text-based tools is great for source-control and versioning. Dot is capable of rendering really complex graphs (check their <a href=\"https://www.graphviz.org/gallery/\">example gallery</a>). However, Dot support for images is very limited, and creating (and reading) architecture diagrams is often much easier when vendor icons are used.</p>\n\n<p>For this, I found Keynote the perfect tool. There are many online editors, and other native apps to make diagrams, but they often feel slow and clunky when compared. Besides, presentations are often a great way to share knowledge, whether this is on the web, at conferences, or at your workplace, sharing knowledge and ideas with other coworkers and/or teams. Being good at making presentations can take you far.</p>\n\n<h3 id=\"presentation-templates\">Presentation templates</h3>\n\n<p>Keynote, as well as Powerpoint and other slide editors, have a good list of presentation templates. Unless using a work template, I usually go with a bare one, picking either light or dark background.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103230535-925c4600-48ea-11eb-9739-993fb82fe476.png\" alt=\"Screen Shot 2020-12-28 at 8 55 50 AM\" /></p>\n\n<h3 id=\"vendor-icons\">Vendor icons</h3>\n\n<p>If you are working with Amazon Web Services, I highly recommend downloading their <a href=\"https://aws.amazon.com/architecture/icons/\">AWS Architecture Icons</a>. I prefer downloading their PowerPoint toolkit, since it includes icons for all their services, well organized by category, but also other resources, like group and resource icons.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103230885-5a093780-48eb-11eb-9e24-e244c03fea63.png\" alt=\"Screen Shot 2020-12-28 at 9 01 47 AM\" /></p>\n\n<p>For other vendors, many companies have a Media or Brand page for press releases, with downloadable assets and instructions on how to use their logos. Here is the <a href=\"https://github.com/logos\">Media page for GitHub</a>, for example. As you can see, if you clicked on the link, they provide downloadable versions of their main logos. However, other logos, like Github Actions, are missing. In this case, I often rely on searching online for their logos, trying to find a good transparent png image.</p>\n\n<h2 id=\"lets-make-a-diagram\">Let’s make a diagram</h2>\n\n<p>I started this article saying I was working on an updated version of an architecture diagram for my Blog Engine. Well, that was kind of a lie. I hadn’t started yet, so here we go. There is really not much to it, so I’ll focus on the key parts. If anything does not make sense, let me know on <a href=\"https://twitter.com/eneko\">Twitter</a>.</p>\n\n<p>I’ll pick dark theme for this one.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103231820-9fc6ff80-48ed-11eb-9b27-d893c0b79667.png\" alt=\"Screen Shot 2020-12-28 at 9 17 09 AM\" /></p>\n\n<h3 id=\"groups\">Groups</h3>\n<p>My Blog Engine uses two GitHub repositories, the source and the destination (GitHub Pages site), a combination of Github Actions, and few AWS Services. For this, I’ll be using the group template from the AWS slides and define three groups.</p>\n\n<h3 id=\"nodes\">Nodes</h3>\n<p>From the AWS toolkit, I’ll be using nodes for SQS Queue, SQS Message, AWS Lambda and S3 Bucket. The toolkit provides two different sets of icons, for services and for service resources. Choose whichever you feel looks better. For Github Actions, I downloaded a transparent PNG from the GitHub documentation site.</p>\n\n<h3 id=\"webpage-screenshots\">Webpage screenshots</h3>\n<p>Since both the source and destination are web pages, I like representing these with actual screenshots. In this case, I took a screenshot of this source GitHub Issue, and another screenshot of the destination article on my blog.</p>\n\n<h3 id=\"connectors\">Connectors</h3>\n<p>Keynote has three types of line connector on the Shapes menu. However, the third one (the one that looks like a Bezier curve) is the only one that will actually snap to nodes and automatically adjust when the nodes are moved.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103234046-85902000-48f3-11eb-91d1-6c9fc22c944f.png\" alt=\"Screen Shot 2020-12-28 at 9 44 56 AM\" /></p>\n\n<p>You can customize the connector by selecting a head stile (arrow) and the connection style (straight, curved, angled). It’s a good idea to also give some padding to the connector, so it doesn’t touch the nodes directly.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103234061-917be200-48f3-11eb-9932-ac64ac5c397a.png\" alt=\"Screen Shot 2020-12-28 at 9 46 19 AM\" /></p>\n\n<h2 id=\"final-diagram\">Final Diagram</h2>\n<p>Here is how my diagram turned out. Maybe too dark with the black background? Not sure. What do you think?</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103234437-88d7db80-48f4-11eb-8902-927f015028e5.png\" alt=\"Screen Shot 2020-12-28 at 10 04 49 AM\" /></p>\n\n<h2 id=\"some-tips\">Some tips</h2>\n<ul>\n  <li>Make your nodes of the same kind have the same size. For example, all AWS Services should have the same size icon. If you use screenshots for webpages or mobile devices, keep their size consistent.</li>\n  <li>Do your best to align your nodes in a grid pattern. This will make the diagram much easier to read.</li>\n  <li>Use the same font size for node labels.</li>\n  <li>Make your connections (arrows) consistent: same width, same head style, same color. In some cases you might want to use dashed or dotted arrows, to indicate different behavior. In my diagram, I used a dashed arrow for serving images from S3, because these are not copied to the GitHub Pages repo.</li>\n</ul>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/14\">Issue #14</a>)</small></i></p>",
      "summary": "<p>I started working on an updated architecture diagram to illustrate the current state of my Blog Engine, and decided to write about the tools I use.</p>\n\n<h2 id=\"why-keynote\">Why Keynote?</h2>\n\n<p>I am a big fan of <a href=\"https://www.graphviz.org/doc/info/lang.html\">Dot</a>, a text-based language for making undirected and directed graphs using only text. Among other things, I’ve used Dot for generating <a href=\"https://github.com/eneko/SourceDocs/blob/master/docs/Package.md\">Swift Package documentation with SourceDocs</a>, or this <a href=\"https://github.com/eneko/Bobiverse\">diagram of Bobiverse</a> (first book). Using text-based tools is great for source-control and versioning. Dot is capable of rendering really complex graphs (check their <a href=\"https://www.graphviz.org/gallery/\">example gallery</a>). However, Dot support for images is very limited, and creating (and reading) architecture diagrams is often much easier when vendor icons are used.</p>\n\n<p>For this, I found Keynote the perfect tool. There are many online editors, and other native apps to make diagrams, but they often feel slow and clunky when compared. Besides, presentations are often a great way to share knowledge, whether this is on the web, at conferences, or at your workplace, sharing knowledge and ideas with other coworkers and/or teams. Being good at making presentations can take you far.</p>\n\n<h3 id=\"presentation-templates\">Presentation templates</h3>\n\n<p>Keynote, as well as Powerpoint and other slide editors, have a good list of presentation templates. Unless using a work template, I usually go with a bare one, picking either light or dark background.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103230535-925c4600-48ea-11eb-9739-993fb82fe476.png\" alt=\"Screen Shot 2020-12-28 at 8 55 50 AM\" /></p>\n\n<h3 id=\"vendor-icons\">Vendor icons</h3>\n\n<p>If you are working with Amazon Web Services, I highly recommend downloading their <a href=\"https://aws.amazon.com/architecture/icons/\">AWS Architecture Icons</a>. I prefer downloading their PowerPoint toolkit, since it includes icons for all their services, well organized by category, but also other resources, like group and resource icons.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103230885-5a093780-48eb-11eb-9e24-e244c03fea63.png\" alt=\"Screen Shot 2020-12-28 at 9 01 47 AM\" /></p>\n\n<p>For other vendors, many companies have a Media or Brand page for press releases, with downloadable assets and instructions on how to use their logos. Here is the <a href=\"https://github.com/logos\">Media page for GitHub</a>, for example. As you can see, if you clicked on the link, they provide downloadable versions of their main logos. However, other logos, like Github Actions, are missing. In this case, I often rely on searching online for their logos, trying to find a good transparent png image.</p>\n\n<h2 id=\"lets-make-a-diagram\">Let’s make a diagram</h2>\n\n<p>I started this article saying I was working on an updated version of an architecture diagram for my Blog Engine. Well, that was kind of a lie. I hadn’t started yet, so here we go. There is really not much to it, so I’ll focus on the key parts. If anything does not make sense, let me know on <a href=\"https://twitter.com/eneko\">Twitter</a>.</p>\n\n<p>I’ll pick dark theme for this one.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103231820-9fc6ff80-48ed-11eb-9b27-d893c0b79667.png\" alt=\"Screen Shot 2020-12-28 at 9 17 09 AM\" /></p>\n\n<h3 id=\"groups\">Groups</h3>\n<p>My Blog Engine uses two GitHub repositories, the source and the destination (GitHub Pages site), a combination of Github Actions, and few AWS Services. For this, I’ll be using the group template from the AWS slides and define three groups.</p>\n\n<h3 id=\"nodes\">Nodes</h3>\n<p>From the AWS toolkit, I’ll be using nodes for SQS Queue, SQS Message, AWS Lambda and S3 Bucket. The toolkit provides two different sets of icons, for services and for service resources. Choose whichever you feel looks better. For Github Actions, I downloaded a transparent PNG from the GitHub documentation site.</p>\n\n<h3 id=\"webpage-screenshots\">Webpage screenshots</h3>\n<p>Since both the source and destination are web pages, I like representing these with actual screenshots. In this case, I took a screenshot of this source GitHub Issue, and another screenshot of the destination article on my blog.</p>\n\n<h3 id=\"connectors\">Connectors</h3>\n<p>Keynote has three types of line connector on the Shapes menu. However, the third one (the one that looks like a Bezier curve) is the only one that will actually snap to nodes and automatically adjust when the nodes are moved.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103234046-85902000-48f3-11eb-91d1-6c9fc22c944f.png\" alt=\"Screen Shot 2020-12-28 at 9 44 56 AM\" /></p>\n\n<p>You can customize the connector by selecting a head stile (arrow) and the connection style (straight, curved, angled). It’s a good idea to also give some padding to the connector, so it doesn’t touch the nodes directly.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103234061-917be200-48f3-11eb-9932-ac64ac5c397a.png\" alt=\"Screen Shot 2020-12-28 at 9 46 19 AM\" /></p>\n\n<h2 id=\"final-diagram\">Final Diagram</h2>\n<p>Here is how my diagram turned out. Maybe too dark with the black background? Not sure. What do you think?</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103234437-88d7db80-48f4-11eb-8902-927f015028e5.png\" alt=\"Screen Shot 2020-12-28 at 10 04 49 AM\" /></p>\n\n<h2 id=\"some-tips\">Some tips</h2>\n<ul>\n  <li>Make your nodes of the same kind have the same size. For example, all AWS Services should have the same size icon. If you use screenshots for webpages or mobile devices, keep their size consistent.</li>\n  <li>Do your best to align your nodes in a grid pattern. This will make the diagram much easier to read.</li>\n  <li>Use the same font size for node labels.</li>\n  <li>Make your connections (arrows) consistent: same width, same head style, same color. In some cases you might want to use dashed or dotted arrows, to indicate different behavior. In my diagram, I used a dashed arrow for serving images from S3, because these are not copied to the GitHub Pages repo.</li>\n</ul>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/14\">Issue #14</a>)</small></i></p>",
      "date_published": "2020-12-28T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-13",
      "url": "https://www.enekoalonso.com/articles/issue-13",
      "title": "Generating Social Media preview images with SwiftUI and GitHub Actions",
      "content_html": "<p>Social Media previews look pretty neat when sharing links to your blog on social media (e.g. Twitter). These can be configured in many ways, and are often defined manually (unique image per post). Some sites use a heading image for the blog post that appears at the top of the article and in social media.</p>\n\n<h3 id=\"manually-picked-preview-images\">Manually picked preview images</h3>\n<p>Here is an example of a shared post from my blog, where the social media preview image has been manually picked:</p>\n\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">Eager to try async/await in Swift? Now you can! Here is how: <a href=\"https://t.co/PMk7E7iLhr\">https://t.co/PMk7E7iLhr</a><a href=\"https://twitter.com/hashtag/swift?src=hash&amp;ref_src=twsrc%5Etfw\">#swift</a> <a href=\"https://twitter.com/hashtag/async?src=hash&amp;ref_src=twsrc%5Etfw\">#async</a> <a href=\"https://twitter.com/hashtag/await?src=hash&amp;ref_src=twsrc%5Etfw\">#await</a></p>&mdash; Eneko Alonso (@eneko) <a href=\"https://twitter.com/eneko/status/1335799626440425472?ref_src=twsrc%5Etfw\">December 7, 2020</a></blockquote>\n<script async=\"\" src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<h3 id=\"templated-or-generated-preview-images\">Templated or generated preview images</h3>\n\n<p>Other sites automatically generate an image programmatically (or with a template). Here are some examples of templated previews, or programmatically generated ones.</p>\n\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">This approach popped up in a recent coaching session I was running. There&#39;s a few trade-offs, but I might be using this technique more in the future.<br /><br />Have you tried something like this? Is there a less obvious downside that I&#39;m missing?<a href=\"https://t.co/PZZC0iXI7L\">https://t.co/PZZC0iXI7L</a></p>&mdash; Joe Masilotti (@joemasilotti) <a href=\"https://twitter.com/joemasilotti/status/1342134689281101826?ref_src=twsrc%5Etfw\">December 24, 2020</a></blockquote>\n<script async=\"\" src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">Get started with Associated Types in Swift<a href=\"https://t.co/Gwe5cSyErr\">https://t.co/Gwe5cSyErr</a><br /><br />🤓 Associated types explained<br />💪🏼 Real case code example shared<br />🚀 Reuse code among multiple types<a href=\"https://twitter.com/hashtag/swiftlang?src=hash&amp;ref_src=twsrc%5Etfw\">#swiftlang</a> <a href=\"https://twitter.com/hashtag/iosdev?src=hash&amp;ref_src=twsrc%5Etfw\">#iosdev</a></p>&mdash; Antoine v.d. SwiftLee 🚀 (@twannl) <a href=\"https://twitter.com/twannl/status/1342802192093356033?ref_src=twsrc%5Etfw\">December 26, 2020</a></blockquote>\n<script async=\"\" src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<h2 id=\"making-a-media-preview-image-for-my-blog-from-scratch\">Making a media preview image for my blog from scratch</h2>\n\n<p>I wanted to generate the image myself, in Swift, and preferably with SwiftUI. I also wanted this to be done in the cloud, instead of my computer. If you’ve been following my posts, you might remember my goal is for me to write GitHub Issues on my <a href=\"https://github.com/eneko/Blog\">Blog</a> repo and have the workflow take it from there.</p>\n\n<h3 id=\"working-with-swiftui-previews\">Working with SwiftUI previews</h3>\n\n<p>This repository is set up as a Swift package. While SwiftUI views can be written and distributed inside Swift packages, Xcode does not support yet generating live previews without an Xcode project 😭</p>\n\n<p>So I made a bogus macOS application with my view on it, so I could code it and preview in real-time. The best thing about SwiftUI previews is being able to set up multiple previews, to try different values for blog post titles, tags, etc.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103179791-6d14fc80-4844-11eb-8875-2467ca555eab.png\" alt=\"Screen Shot 2020-12-27 at 8 50 01 AM\" /></p>\n\n<h3 id=\"swift-code\">Swift code</h3>\n\n<p>Here is the code for my SwiftUI view, as of now (might probably change by the time I finish writing this article)</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">SocialPreview</span><span class=\"p\">:</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">brandColor</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.1843137255</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.5411764706</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"k\">let</span> <span class=\"nv\">textColor</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"o\">.</span><span class=\"n\">white</span>\n    <span class=\"k\">let</span> <span class=\"nv\">dateTemplate</span> <span class=\"o\">=</span> <span class=\"kt\">DateTemplate</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"nf\">month</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">full</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">day</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"nf\">year</span><span class=\"p\">()</span>\n\n    <span class=\"k\">let</span> <span class=\"nv\">title</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">tags</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"kt\">String</span><span class=\"p\">]</span>\n    <span class=\"k\">let</span> <span class=\"nv\">date</span><span class=\"p\">:</span> <span class=\"kt\">Date</span>\n    <span class=\"k\">let</span> <span class=\"nv\">issueNumber</span><span class=\"p\">:</span> <span class=\"kt\">Int</span>\n\n    <span class=\"k\">var</span> <span class=\"nv\">body</span><span class=\"p\">:</span> <span class=\"kd\">some</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n        <span class=\"kt\">ZStack</span><span class=\"p\">{</span>\n            <span class=\"kt\">VStack</span> <span class=\"p\">{</span>\n                <span class=\"kt\">HStack</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n                    <span class=\"kt\">Spacer</span><span class=\"p\">(</span><span class=\"nv\">minLength</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n                    <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"nf\">binary</span><span class=\"p\">(</span><span class=\"nv\">title</span><span class=\"p\">:</span> <span class=\"n\">title</span><span class=\"p\">))</span>\n                        <span class=\"o\">.</span><span class=\"nf\">font</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"nf\">custom</span><span class=\"p\">(</span><span class=\"s\">\"Monaco\"</span><span class=\"p\">,</span> <span class=\"nv\">size</span><span class=\"p\">:</span> <span class=\"mi\">16</span><span class=\"p\">))</span>\n                        <span class=\"o\">.</span><span class=\"nf\">multilineTextAlignment</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">trailing</span><span class=\"p\">)</span>\n                        <span class=\"o\">.</span><span class=\"nf\">frame</span><span class=\"p\">(</span><span class=\"nv\">maxWidth</span><span class=\"p\">:</span> <span class=\"mi\">200</span><span class=\"p\">)</span>\n                <span class=\"p\">}</span>\n                <span class=\"kt\">Spacer</span><span class=\"p\">(</span><span class=\"nv\">minLength</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n            <span class=\"p\">}</span>\n            <span class=\"o\">.</span><span class=\"nf\">padding</span><span class=\"p\">()</span>\n            <span class=\"o\">.</span><span class=\"nf\">opacity</span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"p\">)</span>\n\n            <span class=\"kt\">VStack</span><span class=\"p\">(</span><span class=\"nv\">alignment</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">leading</span><span class=\"p\">,</span> <span class=\"nv\">spacing</span><span class=\"p\">:</span> <span class=\"mi\">10</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n                <span class=\"kt\">Spacer</span><span class=\"p\">(</span><span class=\"nv\">minLength</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n                <span class=\"kt\">VStack</span><span class=\"p\">(</span><span class=\"nv\">alignment</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">leading</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n                    <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"s\">\"enekoalonso.com\"</span><span class=\"p\">)</span>\n                        <span class=\"o\">.</span><span class=\"nf\">font</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"nf\">custom</span><span class=\"p\">(</span><span class=\"s\">\"SF Pro Display\"</span><span class=\"p\">,</span> <span class=\"nv\">size</span><span class=\"p\">:</span> <span class=\"mi\">24</span><span class=\"p\">))</span>\n                    <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"n\">title</span><span class=\"p\">)</span>\n                        <span class=\"o\">.</span><span class=\"nf\">font</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"nf\">custom</span><span class=\"p\">(</span><span class=\"s\">\"SF Pro Display\"</span><span class=\"p\">,</span> <span class=\"nv\">size</span><span class=\"p\">:</span> <span class=\"mi\">64</span><span class=\"p\">))</span>\n                        <span class=\"o\">.</span><span class=\"nf\">fontWeight</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">bold</span><span class=\"p\">)</span>\n                <span class=\"p\">}</span>\n                <span class=\"kt\">HStack</span> <span class=\"p\">{</span>\n                    <span class=\"kt\">ForEach</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"o\">..&lt;</span><span class=\"n\">tags</span><span class=\"o\">.</span><span class=\"n\">count</span><span class=\"p\">)</span> <span class=\"p\">{</span> <span class=\"n\">index</span> <span class=\"k\">in</span>\n                        <span class=\"k\">let</span> <span class=\"nv\">tag</span> <span class=\"o\">=</span> <span class=\"n\">tags</span><span class=\"p\">[</span><span class=\"n\">index</span><span class=\"p\">]</span>\n                        <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"n\">tag</span><span class=\"p\">)</span>\n                            <span class=\"o\">.</span><span class=\"nf\">font</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"nf\">custom</span><span class=\"p\">(</span><span class=\"s\">\"SF Pro Display\"</span><span class=\"p\">,</span> <span class=\"nv\">size</span><span class=\"p\">:</span> <span class=\"mi\">24</span><span class=\"p\">))</span>\n                            <span class=\"o\">.</span><span class=\"nf\">fontWeight</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">bold</span><span class=\"p\">)</span>\n                            <span class=\"o\">.</span><span class=\"nf\">padding</span><span class=\"p\">(</span><span class=\"kt\">EdgeInsets</span><span class=\"p\">(</span><span class=\"nv\">top</span><span class=\"p\">:</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"nv\">leading</span><span class=\"p\">:</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"nv\">bottom</span><span class=\"p\">:</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"nv\">trailing</span><span class=\"p\">:</span> <span class=\"mi\">10</span><span class=\"p\">))</span>\n                            <span class=\"o\">.</span><span class=\"nf\">overlay</span><span class=\"p\">(</span>\n                                <span class=\"kt\">RoundedRectangle</span><span class=\"p\">(</span><span class=\"nv\">cornerRadius</span><span class=\"p\">:</span> <span class=\"mi\">10</span><span class=\"p\">)</span>\n                                    <span class=\"o\">.</span><span class=\"nf\">stroke</span><span class=\"p\">(</span><span class=\"n\">textColor</span><span class=\"p\">,</span> <span class=\"nv\">lineWidth</span><span class=\"p\">:</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n                            <span class=\"p\">)</span>\n                    <span class=\"p\">}</span>\n                <span class=\"p\">}</span>\n                <span class=\"kt\">Spacer</span><span class=\"p\">(</span><span class=\"nv\">minLength</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n                <span class=\"kt\">HStack</span><span class=\"p\">(</span><span class=\"nv\">alignment</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">firstTextBaseline</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n                    <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"s\">\"An Over-Engineered Blog\"</span><span class=\"p\">)</span>\n                        <span class=\"o\">.</span><span class=\"nf\">fontWeight</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">semibold</span><span class=\"p\">)</span>\n                    <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"s\">\"—\"</span><span class=\"p\">)</span>\n                    <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"s\">\"Issue #</span><span class=\"se\">\\(</span><span class=\"n\">issueNumber</span><span class=\"se\">)</span><span class=\"s\">\"</span><span class=\"p\">)</span>\n                    <span class=\"kt\">Spacer</span><span class=\"p\">()</span>\n                    <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"n\">dateTemplate</span><span class=\"o\">.</span><span class=\"nf\">localizedString</span><span class=\"p\">(</span><span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">date</span><span class=\"p\">))</span>\n                        <span class=\"o\">.</span><span class=\"nf\">font</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"nf\">system</span><span class=\"p\">(</span><span class=\"nv\">size</span><span class=\"p\">:</span> <span class=\"mi\">18</span><span class=\"p\">))</span>\n                <span class=\"p\">}</span>\n                <span class=\"o\">.</span><span class=\"nf\">font</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"nf\">custom</span><span class=\"p\">(</span><span class=\"s\">\"SF Pro Display\"</span><span class=\"p\">,</span> <span class=\"nv\">size</span><span class=\"p\">:</span> <span class=\"mi\">24</span><span class=\"p\">))</span>\n            <span class=\"p\">}</span>\n            <span class=\"o\">.</span><span class=\"nf\">padding</span><span class=\"p\">(</span><span class=\"mi\">80</span><span class=\"p\">)</span>\n        <span class=\"p\">}</span>\n        <span class=\"o\">.</span><span class=\"nf\">frame</span><span class=\"p\">(</span><span class=\"nv\">maxWidth</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">infinity</span><span class=\"p\">,</span> <span class=\"nv\">maxHeight</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">infinity</span><span class=\"p\">)</span>\n        <span class=\"o\">.</span><span class=\"nf\">foregroundColor</span><span class=\"p\">(</span><span class=\"n\">textColor</span><span class=\"p\">)</span>\n        <span class=\"o\">.</span><span class=\"nf\">background</span><span class=\"p\">(</span><span class=\"n\">brandColor</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"kd\">func</span> <span class=\"nf\">binary</span><span class=\"p\">(</span><span class=\"nv\">title</span><span class=\"p\">:</span> <span class=\"kt\">String</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">String</span> <span class=\"p\">{</span>\n        <span class=\"k\">let</span> <span class=\"nv\">trimmed</span> <span class=\"o\">=</span> <span class=\"kt\">String</span><span class=\"p\">(</span><span class=\"n\">title</span><span class=\"o\">.</span><span class=\"nf\">prefix</span><span class=\"p\">(</span><span class=\"mi\">60</span><span class=\"p\">))</span>\n        <span class=\"k\">let</span> <span class=\"nv\">binary</span> <span class=\"o\">=</span> <span class=\"kt\">Data</span><span class=\"p\">(</span><span class=\"n\">trimmed</span><span class=\"o\">.</span><span class=\"n\">utf8</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">map</span> <span class=\"p\">{</span> <span class=\"n\">byte</span> <span class=\"k\">in</span>\n            <span class=\"kt\">String</span><span class=\"p\">(</span><span class=\"kt\">String</span><span class=\"p\">(</span><span class=\"kt\">String</span><span class=\"p\">(</span><span class=\"n\">byte</span><span class=\"p\">,</span> <span class=\"nv\">radix</span><span class=\"p\">:</span> <span class=\"mi\">2</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">reversed</span><span class=\"p\">())</span><span class=\"o\">.</span><span class=\"nf\">padding</span><span class=\"p\">(</span><span class=\"nv\">toLength</span><span class=\"p\">:</span> <span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"nv\">withPad</span><span class=\"p\">:</span> <span class=\"s\">\"0\"</span><span class=\"p\">,</span> <span class=\"nv\">startingAt</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">reversed</span><span class=\"p\">())</span>\n        <span class=\"p\">}</span>\n        <span class=\"k\">return</span> <span class=\"n\">binary</span><span class=\"o\">.</span><span class=\"nf\">joined</span><span class=\"p\">(</span><span class=\"nv\">separator</span><span class=\"p\">:</span> <span class=\"s\">\" \"</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>I added a method to render the blog post title as binary code. I have many other ideas to decorate the background based on the blog post title and tags, but haven’t get to do it yet. Maybe later.</p>\n\n<p>To rasterize the SwiftUI view into an image, I’m using the same technique I used with <a href=\"https://github.com/eneko/ConsoleUI\">ConsoleUI</a>. Basically, the process is to use an <code class=\"language-plaintext highlighter-rouge\">NSHostingView</code> view, rasterize it’s contents to PNG, and save to disk.</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">SocialPreviewGenerator</span> <span class=\"p\">{</span>\n    <span class=\"kd\">static</span> <span class=\"kd\">func</span> <span class=\"nf\">main</span><span class=\"p\">()</span> <span class=\"k\">throws</span> <span class=\"p\">{</span>\n        <span class=\"k\">let</span> <span class=\"nv\">arguments</span> <span class=\"o\">=</span> <span class=\"kt\">ProcessInfo</span><span class=\"o\">.</span><span class=\"n\">processInfo</span><span class=\"o\">.</span><span class=\"n\">arguments</span>\n        <span class=\"k\">guard</span> <span class=\"n\">arguments</span><span class=\"o\">.</span><span class=\"n\">count</span> <span class=\"o\">==</span> <span class=\"mi\">3</span> <span class=\"k\">else</span> <span class=\"p\">{</span>\n            <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"s\">\"Missing arguments.\"</span><span class=\"p\">)</span>\n            <span class=\"k\">return</span>\n        <span class=\"p\">}</span>\n        <span class=\"k\">let</span> <span class=\"nv\">title</span> <span class=\"o\">=</span> <span class=\"n\">arguments</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n        <span class=\"k\">let</span> <span class=\"nv\">tags</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s\">\"docker\"</span><span class=\"p\">,</span> <span class=\"s\">\"linux\"</span><span class=\"p\">,</span> <span class=\"s\">\"swift\"</span><span class=\"p\">]</span>\n        <span class=\"k\">let</span> <span class=\"nv\">date</span> <span class=\"o\">=</span> <span class=\"kt\">Date</span><span class=\"p\">()</span>\n        <span class=\"k\">let</span> <span class=\"nv\">issueNumber</span> <span class=\"o\">=</span> <span class=\"kt\">Int</span><span class=\"p\">(</span><span class=\"n\">arguments</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">])</span> <span class=\"p\">??</span> <span class=\"mi\">0</span>\n\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"s\">\"Generating Social Preview for issue #\"</span><span class=\"p\">)</span>\n\n        <span class=\"k\">let</span> <span class=\"nv\">view</span> <span class=\"o\">=</span> <span class=\"kt\">SocialPreview</span><span class=\"p\">(</span><span class=\"nv\">title</span><span class=\"p\">:</span> <span class=\"n\">title</span><span class=\"p\">,</span> <span class=\"nv\">tags</span><span class=\"p\">:</span> <span class=\"n\">tags</span><span class=\"p\">,</span> <span class=\"nv\">date</span><span class=\"p\">:</span> <span class=\"n\">date</span><span class=\"p\">,</span> <span class=\"nv\">issueNumber</span><span class=\"p\">:</span> <span class=\"n\">issueNumber</span><span class=\"p\">)</span>\n        <span class=\"k\">let</span> <span class=\"nv\">wrapper</span> <span class=\"o\">=</span> <span class=\"kt\">NSHostingView</span><span class=\"p\">(</span><span class=\"nv\">rootView</span><span class=\"p\">:</span> <span class=\"n\">view</span><span class=\"p\">)</span>\n        <span class=\"n\">wrapper</span><span class=\"o\">.</span><span class=\"n\">frame</span> <span class=\"o\">=</span> <span class=\"kt\">CGRect</span><span class=\"p\">(</span><span class=\"nv\">x</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"nv\">y</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"mi\">1280</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"mi\">640</span><span class=\"p\">)</span>\n\n        <span class=\"k\">let</span> <span class=\"nv\">png</span> <span class=\"o\">=</span> <span class=\"nf\">rasterize</span><span class=\"p\">(</span><span class=\"nv\">view</span><span class=\"p\">:</span> <span class=\"n\">wrapper</span><span class=\"p\">,</span> <span class=\"nv\">format</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">png</span><span class=\"p\">)</span>\n        <span class=\"k\">try</span> <span class=\"n\">png</span><span class=\"p\">?</span><span class=\"o\">.</span><span class=\"nf\">write</span><span class=\"p\">(</span><span class=\"nv\">to</span><span class=\"p\">:</span> <span class=\"kt\">URL</span><span class=\"p\">(</span><span class=\"nv\">fileURLWithPath</span><span class=\"p\">:</span> <span class=\"s\">\"issue-</span><span class=\"se\">\\(</span><span class=\"n\">issueNumber</span><span class=\"se\">)</span><span class=\"s\">.png\"</span><span class=\"p\">))</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"kd\">static</span> <span class=\"kd\">func</span> <span class=\"nf\">rasterize</span><span class=\"p\">(</span><span class=\"nv\">view</span><span class=\"p\">:</span> <span class=\"kt\">NSView</span><span class=\"p\">,</span> <span class=\"nv\">format</span><span class=\"p\">:</span> <span class=\"kt\">NSBitmapImageRep</span><span class=\"o\">.</span><span class=\"kt\">FileType</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">Data</span><span class=\"p\">?</span> <span class=\"p\">{</span>\n        <span class=\"k\">guard</span> <span class=\"k\">let</span> <span class=\"nv\">bitmapRepresentation</span> <span class=\"o\">=</span> <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"nf\">bitmapImageRepForCachingDisplay</span><span class=\"p\">(</span><span class=\"nv\">in</span><span class=\"p\">:</span> <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">bounds</span><span class=\"p\">)</span> <span class=\"k\">else</span> <span class=\"p\">{</span>\n            <span class=\"k\">return</span> <span class=\"kc\">nil</span>\n        <span class=\"p\">}</span>\n        <span class=\"n\">bitmapRepresentation</span><span class=\"o\">.</span><span class=\"n\">size</span> <span class=\"o\">=</span> <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">bounds</span><span class=\"o\">.</span><span class=\"n\">size</span>\n        <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"nf\">cacheDisplay</span><span class=\"p\">(</span><span class=\"nv\">in</span><span class=\"p\">:</span> <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">bounds</span><span class=\"p\">,</span> <span class=\"nv\">to</span><span class=\"p\">:</span> <span class=\"n\">bitmapRepresentation</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">bitmapRepresentation</span><span class=\"o\">.</span><span class=\"nf\">representation</span><span class=\"p\">(</span><span class=\"nv\">using</span><span class=\"p\">:</span> <span class=\"n\">format</span><span class=\"p\">,</span> <span class=\"nv\">properties</span><span class=\"p\">:</span> <span class=\"p\">[:])</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">try</span> <span class=\"kt\">SocialPreviewGenerator</span><span class=\"o\">.</span><span class=\"nf\">main</span><span class=\"p\">()</span>\n</code></pre></div></div>\n\n<p>You can find the full source code on this repo, feel free to use it.</p>\n\n<h2 id=\"setting-up-the-workflow\">Setting up the workflow</h2>\n\n<p>Since SwiftUI only runs on Apple platforms, I decided to run this process in a GitHub Action workflow, using a macOS job.</p>\n\n<p>Here is how it works:</p>\n<ul>\n  <li>I’ve updated my existing <a href=\"https://github.com/eneko/Blog/blob/main/.github/workflows/issue.yml\">issue workflow</a>, adding a new <code class=\"language-plaintext highlighter-rouge\">generateSocialPreview</code> job</li>\n  <li>This job runs on macOS</li>\n  <li>The job checks-out the repo, and runs the Swift command to generate the media preview image.</li>\n  <li>Finally, the workflow uploads the generated image to Amazon S3.</li>\n</ul>\n\n<p>This workflow will run before pushing the issue changes to AWS SQS.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103180848-95a1f400-484e-11eb-9a39-25f06363557f.png\" alt=\"Screen Shot 2020-12-27 at 2 16 06 PM\" /></p>\n\n<h3 id=\"uploading-images-to-amazon-s3\">Uploading images to Amazon S3</h3>\n\n<p>Uploading files to S3 is pretty easy, since we can use AWS CLI in Github Actions. First, we set the credentials, and then we are good to go. Here, I’m hardcoding the file name, but will later be dynamic based in the issue number:</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"pi\">-</span> <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">aws-actions/configure-aws-credentials@v1</span>\n  <span class=\"na\">with</span><span class=\"pi\">:</span>\n    <span class=\"na\">aws-access-key-id</span><span class=\"pi\">:</span> <span class=\"s\">${ { secrets.AWS_ACCESS_KEY_ID } }</span>\n    <span class=\"na\">aws-secret-access-key</span><span class=\"pi\">:</span> <span class=\"s\">${ { secrets.AWS_SECRET_ACCESS_KEY } }</span>\n    <span class=\"na\">aws-region</span><span class=\"pi\">:</span> <span class=\"s\">us-east-2</span>\n<span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Copy to S3</span>\n  <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"pi\">|</span>\n    <span class=\"s\">aws s3 cp issue-25.png s3://eneko-blog-media/social-preview/issue-25.png --acl public-read</span>\n</code></pre></div></div>\n\n<p>To get this working, the user role associated with the credentials must have permissions to put objects in S3, and to update their ACL, so they can be make public-read.</p>\n\n<p>Here is how my policy looks like:</p>\n\n<div class=\"language-json highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"nl\">\"Version\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2012-10-17\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"nl\">\"Statement\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"nl\">\"Sid\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"VisualEditor0\"</span><span class=\"p\">,</span><span class=\"w\">\n            </span><span class=\"nl\">\"Effect\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Allow\"</span><span class=\"p\">,</span><span class=\"w\">\n            </span><span class=\"nl\">\"Action\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                </span><span class=\"s2\">\"s3:PutObject\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"s3:PutObjectAcl\"</span><span class=\"w\">\n            </span><span class=\"p\">],</span><span class=\"w\">\n            </span><span class=\"nl\">\"Resource\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"arn:aws:s3:::eneko-blog-media/*\"</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">]</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<h2 id=\"running-the-workflow\">Running the workflow</h2>\n\n<p>After a couple of runs testing permissions, the workflow completed successfully.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103179788-5ff80d80-4844-11eb-92ec-75321cf7800c.png\" alt=\"Screen Shot 2020-12-27 at 10 24 18 AM\" /></p>\n\n<h2 id=\"unexpected-issue-no-fonts\">Unexpected Issue: No Fonts!</h2>\n\n<p>Well, not that there are no fonts, but the fonts I’m using, “SF Pro Display” and “SF Mono” do not seem to be installed on macOS instances in Github Actions. 😭</p>\n\n<p>Here is how it looks like “out-of-the-box”</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103179779-3b039a80-4844-11eb-9ce4-04d2315107f6.png\" alt=\"issue-25\" /></p>\n\n<h3 id=\"attempt-1-adding-custom-fonts\">Attempt 1: Adding custom fonts</h3>\n\n<p>I downloaded SF Pro Display and SF Mono fonts from Apple website, <a href=\"https://github.com/eneko/Blog/commit/ca39f84c07d06343ddd9bd9da49e3e58ad7a09f6\">added them to this repo</a>, and updated the workflow to copy them to <code class=\"language-plaintext highlighter-rouge\">~/Library/Fonts</code>.</p>\n\n<p>No luck. While the <a href=\"https://github.com/eneko/Blog/runs/1615026612?check_suite_focus=true\">workflow completed successfully</a>, the rendered image looks as before, without custom San Francisco fonts.</p>\n\n<h3 id=\"attempt-2-using-system-fonts\">Attempt 2: Using system fonts</h3>\n\n<p>Instead of trying to install a custom font (might try again later), for now I’m going to use the default system font.</p>\n\n<p>And… there you go! Much better 👏👏</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103181132-76a56100-4852-11eb-8400-99e3a9baf528.png\" alt=\"issue-25-2\" /></p>\n\n<h2 id=\"final-steps\">Final steps</h2>\n\n<p>Now that the workflow is working, there are a few remaining tasks:</p>\n<ul>\n  <li>Configure preview generator to pass all issue arguments (title, tags, creation date and issue number). Since it is a command line tool, I could either pass this info via individual arguments, or passing JSON via stdin or disk.</li>\n  <li>Update post template to use new generated image url for social media previews.</li>\n</ul>\n\n<p>Let’s get to it.</p>\n\n<h3 id=\"processing-event-issues-json\">Processing event issues (JSON)</h3>\n\n<p>Since I already have the <code class=\"language-plaintext highlighter-rouge\">Codable</code> structures for the Lambda to load the event issue JSON, I decide to also use them for the social media preview generator. Here are the two structures I’ll be using:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">public</span> <span class=\"kd\">struct</span> <span class=\"kt\">GitHubIssue</span><span class=\"p\">:</span> <span class=\"kt\">Codable</span> <span class=\"p\">{</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">number</span><span class=\"p\">:</span> <span class=\"kt\">Int</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">state</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">body</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">title</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">labels</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"kt\">GitHubLabel</span><span class=\"p\">]</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">createdAt</span><span class=\"p\">:</span> <span class=\"kt\">Date</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">updatedAt</span><span class=\"p\">:</span> <span class=\"kt\">Date</span>\n<span class=\"p\">}</span>\n\n<span class=\"kd\">public</span> <span class=\"kd\">struct</span> <span class=\"kt\">GitHubLabel</span><span class=\"p\">:</span> <span class=\"kt\">Codable</span> <span class=\"p\">{</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">color</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">name</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>I’m also reusing <code class=\"language-plaintext highlighter-rouge\">IssueParser</code>, since it has the logic for parsing ISO dates and <code class=\"language-plaintext highlighter-rouge\">snake_case</code> JSON keys.</p>\n\n<p>Here is the Yaml action, writing the JSON to disk and loading it to generate the preview:</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Write File</span>\n  <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">DamianReeves/write-file-action@v1.0</span>\n  <span class=\"na\">with</span><span class=\"pi\">:</span>\n    <span class=\"na\">path</span><span class=\"pi\">:</span> <span class=\"s\">issue.json</span>\n    <span class=\"na\">contents</span><span class=\"pi\">:</span> <span class=\"s\">${ { toJSON(github.event.issue) } }</span>\n    <span class=\"na\">write-mode</span><span class=\"pi\">:</span> <span class=\"s\">overwrite</span>\n<span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Generate Preview</span>\n  <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"pi\">|</span>\n    <span class=\"s\">swift run socialpreview issue.json</span>\n</code></pre></div></div>\n\n<h2 id=\"final-result\">Final Result</h2>\n\n<p>While I’m still doing some tweaks and updates, here is the result at the moment:</p>\n\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">Generating Social Media preview images with SwiftUI and GitHub Actions<a href=\"https://t.co/85Sf1ZOQpB\">https://t.co/85Sf1ZOQpB</a><a href=\"https://twitter.com/hashtag/swift?src=hash&amp;ref_src=twsrc%5Etfw\">#swift</a> <a href=\"https://twitter.com/hashtag/SwiftUI?src=hash&amp;ref_src=twsrc%5Etfw\">#SwiftUI</a> <a href=\"https://twitter.com/hashtag/githubactions?src=hash&amp;ref_src=twsrc%5Etfw\">#githubactions</a></p>&mdash; Eneko Alonso (@eneko) <a href=\"https://twitter.com/eneko/status/1343416173380165632?ref_src=twsrc%5Etfw\">December 28, 2020</a></blockquote>\n<script async=\"\" src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/13\">Issue #13</a>)</small></i></p>",
      "summary": "<p>Social Media previews look pretty neat when sharing links to your blog on social media (e.g. Twitter). These can be configured in many ways, and are often defined manually (unique image per post). Some sites use a heading image for the blog post that appears at the top of the article and in social media.</p>\n\n<h3 id=\"manually-picked-preview-images\">Manually picked preview images</h3>\n<p>Here is an example of a shared post from my blog, where the social media preview image has been manually picked:</p>\n\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">Eager to try async/await in Swift? Now you can! Here is how: <a href=\"https://t.co/PMk7E7iLhr\">https://t.co/PMk7E7iLhr</a><a href=\"https://twitter.com/hashtag/swift?src=hash&amp;ref_src=twsrc%5Etfw\">#swift</a> <a href=\"https://twitter.com/hashtag/async?src=hash&amp;ref_src=twsrc%5Etfw\">#async</a> <a href=\"https://twitter.com/hashtag/await?src=hash&amp;ref_src=twsrc%5Etfw\">#await</a></p>&mdash; Eneko Alonso (@eneko) <a href=\"https://twitter.com/eneko/status/1335799626440425472?ref_src=twsrc%5Etfw\">December 7, 2020</a></blockquote>\n<script async=\"\" src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<h3 id=\"templated-or-generated-preview-images\">Templated or generated preview images</h3>\n\n<p>Other sites automatically generate an image programmatically (or with a template). Here are some examples of templated previews, or programmatically generated ones.</p>\n\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">This approach popped up in a recent coaching session I was running. There&#39;s a few trade-offs, but I might be using this technique more in the future.<br /><br />Have you tried something like this? Is there a less obvious downside that I&#39;m missing?<a href=\"https://t.co/PZZC0iXI7L\">https://t.co/PZZC0iXI7L</a></p>&mdash; Joe Masilotti (@joemasilotti) <a href=\"https://twitter.com/joemasilotti/status/1342134689281101826?ref_src=twsrc%5Etfw\">December 24, 2020</a></blockquote>\n<script async=\"\" src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">Get started with Associated Types in Swift<a href=\"https://t.co/Gwe5cSyErr\">https://t.co/Gwe5cSyErr</a><br /><br />🤓 Associated types explained<br />💪🏼 Real case code example shared<br />🚀 Reuse code among multiple types<a href=\"https://twitter.com/hashtag/swiftlang?src=hash&amp;ref_src=twsrc%5Etfw\">#swiftlang</a> <a href=\"https://twitter.com/hashtag/iosdev?src=hash&amp;ref_src=twsrc%5Etfw\">#iosdev</a></p>&mdash; Antoine v.d. SwiftLee 🚀 (@twannl) <a href=\"https://twitter.com/twannl/status/1342802192093356033?ref_src=twsrc%5Etfw\">December 26, 2020</a></blockquote>\n<script async=\"\" src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<h2 id=\"making-a-media-preview-image-for-my-blog-from-scratch\">Making a media preview image for my blog from scratch</h2>\n\n<p>I wanted to generate the image myself, in Swift, and preferably with SwiftUI. I also wanted this to be done in the cloud, instead of my computer. If you’ve been following my posts, you might remember my goal is for me to write GitHub Issues on my <a href=\"https://github.com/eneko/Blog\">Blog</a> repo and have the workflow take it from there.</p>\n\n<h3 id=\"working-with-swiftui-previews\">Working with SwiftUI previews</h3>\n\n<p>This repository is set up as a Swift package. While SwiftUI views can be written and distributed inside Swift packages, Xcode does not support yet generating live previews without an Xcode project 😭</p>\n\n<p>So I made a bogus macOS application with my view on it, so I could code it and preview in real-time. The best thing about SwiftUI previews is being able to set up multiple previews, to try different values for blog post titles, tags, etc.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103179791-6d14fc80-4844-11eb-8875-2467ca555eab.png\" alt=\"Screen Shot 2020-12-27 at 8 50 01 AM\" /></p>\n\n<h3 id=\"swift-code\">Swift code</h3>\n\n<p>Here is the code for my SwiftUI view, as of now (might probably change by the time I finish writing this article)</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">SocialPreview</span><span class=\"p\">:</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n    <span class=\"k\">let</span> <span class=\"nv\">brandColor</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"p\">(</span><span class=\"err\">#</span><span class=\"nf\">colorLiteral</span><span class=\"p\">(</span><span class=\"nv\">red</span><span class=\"p\">:</span> <span class=\"mf\">0.1843137255</span><span class=\"p\">,</span> <span class=\"nv\">green</span><span class=\"p\">:</span> <span class=\"mf\">0.5411764706</span><span class=\"p\">,</span> <span class=\"nv\">blue</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"nv\">alpha</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"k\">let</span> <span class=\"nv\">textColor</span> <span class=\"o\">=</span> <span class=\"kt\">Color</span><span class=\"o\">.</span><span class=\"n\">white</span>\n    <span class=\"k\">let</span> <span class=\"nv\">dateTemplate</span> <span class=\"o\">=</span> <span class=\"kt\">DateTemplate</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"nf\">month</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">full</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">day</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"nf\">year</span><span class=\"p\">()</span>\n\n    <span class=\"k\">let</span> <span class=\"nv\">title</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"k\">let</span> <span class=\"nv\">tags</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"kt\">String</span><span class=\"p\">]</span>\n    <span class=\"k\">let</span> <span class=\"nv\">date</span><span class=\"p\">:</span> <span class=\"kt\">Date</span>\n    <span class=\"k\">let</span> <span class=\"nv\">issueNumber</span><span class=\"p\">:</span> <span class=\"kt\">Int</span>\n\n    <span class=\"k\">var</span> <span class=\"nv\">body</span><span class=\"p\">:</span> <span class=\"kd\">some</span> <span class=\"kt\">View</span> <span class=\"p\">{</span>\n        <span class=\"kt\">ZStack</span><span class=\"p\">{</span>\n            <span class=\"kt\">VStack</span> <span class=\"p\">{</span>\n                <span class=\"kt\">HStack</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n                    <span class=\"kt\">Spacer</span><span class=\"p\">(</span><span class=\"nv\">minLength</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n                    <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"nf\">binary</span><span class=\"p\">(</span><span class=\"nv\">title</span><span class=\"p\">:</span> <span class=\"n\">title</span><span class=\"p\">))</span>\n                        <span class=\"o\">.</span><span class=\"nf\">font</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"nf\">custom</span><span class=\"p\">(</span><span class=\"s\">\"Monaco\"</span><span class=\"p\">,</span> <span class=\"nv\">size</span><span class=\"p\">:</span> <span class=\"mi\">16</span><span class=\"p\">))</span>\n                        <span class=\"o\">.</span><span class=\"nf\">multilineTextAlignment</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">trailing</span><span class=\"p\">)</span>\n                        <span class=\"o\">.</span><span class=\"nf\">frame</span><span class=\"p\">(</span><span class=\"nv\">maxWidth</span><span class=\"p\">:</span> <span class=\"mi\">200</span><span class=\"p\">)</span>\n                <span class=\"p\">}</span>\n                <span class=\"kt\">Spacer</span><span class=\"p\">(</span><span class=\"nv\">minLength</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n            <span class=\"p\">}</span>\n            <span class=\"o\">.</span><span class=\"nf\">padding</span><span class=\"p\">()</span>\n            <span class=\"o\">.</span><span class=\"nf\">opacity</span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"p\">)</span>\n\n            <span class=\"kt\">VStack</span><span class=\"p\">(</span><span class=\"nv\">alignment</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">leading</span><span class=\"p\">,</span> <span class=\"nv\">spacing</span><span class=\"p\">:</span> <span class=\"mi\">10</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n                <span class=\"kt\">Spacer</span><span class=\"p\">(</span><span class=\"nv\">minLength</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n                <span class=\"kt\">VStack</span><span class=\"p\">(</span><span class=\"nv\">alignment</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">leading</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n                    <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"s\">\"enekoalonso.com\"</span><span class=\"p\">)</span>\n                        <span class=\"o\">.</span><span class=\"nf\">font</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"nf\">custom</span><span class=\"p\">(</span><span class=\"s\">\"SF Pro Display\"</span><span class=\"p\">,</span> <span class=\"nv\">size</span><span class=\"p\">:</span> <span class=\"mi\">24</span><span class=\"p\">))</span>\n                    <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"n\">title</span><span class=\"p\">)</span>\n                        <span class=\"o\">.</span><span class=\"nf\">font</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"nf\">custom</span><span class=\"p\">(</span><span class=\"s\">\"SF Pro Display\"</span><span class=\"p\">,</span> <span class=\"nv\">size</span><span class=\"p\">:</span> <span class=\"mi\">64</span><span class=\"p\">))</span>\n                        <span class=\"o\">.</span><span class=\"nf\">fontWeight</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">bold</span><span class=\"p\">)</span>\n                <span class=\"p\">}</span>\n                <span class=\"kt\">HStack</span> <span class=\"p\">{</span>\n                    <span class=\"kt\">ForEach</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"o\">..&lt;</span><span class=\"n\">tags</span><span class=\"o\">.</span><span class=\"n\">count</span><span class=\"p\">)</span> <span class=\"p\">{</span> <span class=\"n\">index</span> <span class=\"k\">in</span>\n                        <span class=\"k\">let</span> <span class=\"nv\">tag</span> <span class=\"o\">=</span> <span class=\"n\">tags</span><span class=\"p\">[</span><span class=\"n\">index</span><span class=\"p\">]</span>\n                        <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"n\">tag</span><span class=\"p\">)</span>\n                            <span class=\"o\">.</span><span class=\"nf\">font</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"nf\">custom</span><span class=\"p\">(</span><span class=\"s\">\"SF Pro Display\"</span><span class=\"p\">,</span> <span class=\"nv\">size</span><span class=\"p\">:</span> <span class=\"mi\">24</span><span class=\"p\">))</span>\n                            <span class=\"o\">.</span><span class=\"nf\">fontWeight</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">bold</span><span class=\"p\">)</span>\n                            <span class=\"o\">.</span><span class=\"nf\">padding</span><span class=\"p\">(</span><span class=\"kt\">EdgeInsets</span><span class=\"p\">(</span><span class=\"nv\">top</span><span class=\"p\">:</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"nv\">leading</span><span class=\"p\">:</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"nv\">bottom</span><span class=\"p\">:</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"nv\">trailing</span><span class=\"p\">:</span> <span class=\"mi\">10</span><span class=\"p\">))</span>\n                            <span class=\"o\">.</span><span class=\"nf\">overlay</span><span class=\"p\">(</span>\n                                <span class=\"kt\">RoundedRectangle</span><span class=\"p\">(</span><span class=\"nv\">cornerRadius</span><span class=\"p\">:</span> <span class=\"mi\">10</span><span class=\"p\">)</span>\n                                    <span class=\"o\">.</span><span class=\"nf\">stroke</span><span class=\"p\">(</span><span class=\"n\">textColor</span><span class=\"p\">,</span> <span class=\"nv\">lineWidth</span><span class=\"p\">:</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n                            <span class=\"p\">)</span>\n                    <span class=\"p\">}</span>\n                <span class=\"p\">}</span>\n                <span class=\"kt\">Spacer</span><span class=\"p\">(</span><span class=\"nv\">minLength</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n                <span class=\"kt\">HStack</span><span class=\"p\">(</span><span class=\"nv\">alignment</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">firstTextBaseline</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n                    <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"s\">\"An Over-Engineered Blog\"</span><span class=\"p\">)</span>\n                        <span class=\"o\">.</span><span class=\"nf\">fontWeight</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"n\">semibold</span><span class=\"p\">)</span>\n                    <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"s\">\"—\"</span><span class=\"p\">)</span>\n                    <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"s\">\"Issue #</span><span class=\"se\">\\(</span><span class=\"n\">issueNumber</span><span class=\"se\">)</span><span class=\"s\">\"</span><span class=\"p\">)</span>\n                    <span class=\"kt\">Spacer</span><span class=\"p\">()</span>\n                    <span class=\"kt\">Text</span><span class=\"p\">(</span><span class=\"n\">dateTemplate</span><span class=\"o\">.</span><span class=\"nf\">localizedString</span><span class=\"p\">(</span><span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">date</span><span class=\"p\">))</span>\n                        <span class=\"o\">.</span><span class=\"nf\">font</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"nf\">system</span><span class=\"p\">(</span><span class=\"nv\">size</span><span class=\"p\">:</span> <span class=\"mi\">18</span><span class=\"p\">))</span>\n                <span class=\"p\">}</span>\n                <span class=\"o\">.</span><span class=\"nf\">font</span><span class=\"p\">(</span><span class=\"o\">.</span><span class=\"nf\">custom</span><span class=\"p\">(</span><span class=\"s\">\"SF Pro Display\"</span><span class=\"p\">,</span> <span class=\"nv\">size</span><span class=\"p\">:</span> <span class=\"mi\">24</span><span class=\"p\">))</span>\n            <span class=\"p\">}</span>\n            <span class=\"o\">.</span><span class=\"nf\">padding</span><span class=\"p\">(</span><span class=\"mi\">80</span><span class=\"p\">)</span>\n        <span class=\"p\">}</span>\n        <span class=\"o\">.</span><span class=\"nf\">frame</span><span class=\"p\">(</span><span class=\"nv\">maxWidth</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">infinity</span><span class=\"p\">,</span> <span class=\"nv\">maxHeight</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">infinity</span><span class=\"p\">)</span>\n        <span class=\"o\">.</span><span class=\"nf\">foregroundColor</span><span class=\"p\">(</span><span class=\"n\">textColor</span><span class=\"p\">)</span>\n        <span class=\"o\">.</span><span class=\"nf\">background</span><span class=\"p\">(</span><span class=\"n\">brandColor</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"kd\">func</span> <span class=\"nf\">binary</span><span class=\"p\">(</span><span class=\"nv\">title</span><span class=\"p\">:</span> <span class=\"kt\">String</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">String</span> <span class=\"p\">{</span>\n        <span class=\"k\">let</span> <span class=\"nv\">trimmed</span> <span class=\"o\">=</span> <span class=\"kt\">String</span><span class=\"p\">(</span><span class=\"n\">title</span><span class=\"o\">.</span><span class=\"nf\">prefix</span><span class=\"p\">(</span><span class=\"mi\">60</span><span class=\"p\">))</span>\n        <span class=\"k\">let</span> <span class=\"nv\">binary</span> <span class=\"o\">=</span> <span class=\"kt\">Data</span><span class=\"p\">(</span><span class=\"n\">trimmed</span><span class=\"o\">.</span><span class=\"n\">utf8</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">map</span> <span class=\"p\">{</span> <span class=\"n\">byte</span> <span class=\"k\">in</span>\n            <span class=\"kt\">String</span><span class=\"p\">(</span><span class=\"kt\">String</span><span class=\"p\">(</span><span class=\"kt\">String</span><span class=\"p\">(</span><span class=\"n\">byte</span><span class=\"p\">,</span> <span class=\"nv\">radix</span><span class=\"p\">:</span> <span class=\"mi\">2</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">reversed</span><span class=\"p\">())</span><span class=\"o\">.</span><span class=\"nf\">padding</span><span class=\"p\">(</span><span class=\"nv\">toLength</span><span class=\"p\">:</span> <span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"nv\">withPad</span><span class=\"p\">:</span> <span class=\"s\">\"0\"</span><span class=\"p\">,</span> <span class=\"nv\">startingAt</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"nf\">reversed</span><span class=\"p\">())</span>\n        <span class=\"p\">}</span>\n        <span class=\"k\">return</span> <span class=\"n\">binary</span><span class=\"o\">.</span><span class=\"nf\">joined</span><span class=\"p\">(</span><span class=\"nv\">separator</span><span class=\"p\">:</span> <span class=\"s\">\" \"</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>I added a method to render the blog post title as binary code. I have many other ideas to decorate the background based on the blog post title and tags, but haven’t get to do it yet. Maybe later.</p>\n\n<p>To rasterize the SwiftUI view into an image, I’m using the same technique I used with <a href=\"https://github.com/eneko/ConsoleUI\">ConsoleUI</a>. Basically, the process is to use an <code class=\"language-plaintext highlighter-rouge\">NSHostingView</code> view, rasterize it’s contents to PNG, and save to disk.</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">struct</span> <span class=\"kt\">SocialPreviewGenerator</span> <span class=\"p\">{</span>\n    <span class=\"kd\">static</span> <span class=\"kd\">func</span> <span class=\"nf\">main</span><span class=\"p\">()</span> <span class=\"k\">throws</span> <span class=\"p\">{</span>\n        <span class=\"k\">let</span> <span class=\"nv\">arguments</span> <span class=\"o\">=</span> <span class=\"kt\">ProcessInfo</span><span class=\"o\">.</span><span class=\"n\">processInfo</span><span class=\"o\">.</span><span class=\"n\">arguments</span>\n        <span class=\"k\">guard</span> <span class=\"n\">arguments</span><span class=\"o\">.</span><span class=\"n\">count</span> <span class=\"o\">==</span> <span class=\"mi\">3</span> <span class=\"k\">else</span> <span class=\"p\">{</span>\n            <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"s\">\"Missing arguments.\"</span><span class=\"p\">)</span>\n            <span class=\"k\">return</span>\n        <span class=\"p\">}</span>\n        <span class=\"k\">let</span> <span class=\"nv\">title</span> <span class=\"o\">=</span> <span class=\"n\">arguments</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n        <span class=\"k\">let</span> <span class=\"nv\">tags</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s\">\"docker\"</span><span class=\"p\">,</span> <span class=\"s\">\"linux\"</span><span class=\"p\">,</span> <span class=\"s\">\"swift\"</span><span class=\"p\">]</span>\n        <span class=\"k\">let</span> <span class=\"nv\">date</span> <span class=\"o\">=</span> <span class=\"kt\">Date</span><span class=\"p\">()</span>\n        <span class=\"k\">let</span> <span class=\"nv\">issueNumber</span> <span class=\"o\">=</span> <span class=\"kt\">Int</span><span class=\"p\">(</span><span class=\"n\">arguments</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">])</span> <span class=\"p\">??</span> <span class=\"mi\">0</span>\n\n        <span class=\"nf\">print</span><span class=\"p\">(</span><span class=\"s\">\"Generating Social Preview for issue #\"</span><span class=\"p\">)</span>\n\n        <span class=\"k\">let</span> <span class=\"nv\">view</span> <span class=\"o\">=</span> <span class=\"kt\">SocialPreview</span><span class=\"p\">(</span><span class=\"nv\">title</span><span class=\"p\">:</span> <span class=\"n\">title</span><span class=\"p\">,</span> <span class=\"nv\">tags</span><span class=\"p\">:</span> <span class=\"n\">tags</span><span class=\"p\">,</span> <span class=\"nv\">date</span><span class=\"p\">:</span> <span class=\"n\">date</span><span class=\"p\">,</span> <span class=\"nv\">issueNumber</span><span class=\"p\">:</span> <span class=\"n\">issueNumber</span><span class=\"p\">)</span>\n        <span class=\"k\">let</span> <span class=\"nv\">wrapper</span> <span class=\"o\">=</span> <span class=\"kt\">NSHostingView</span><span class=\"p\">(</span><span class=\"nv\">rootView</span><span class=\"p\">:</span> <span class=\"n\">view</span><span class=\"p\">)</span>\n        <span class=\"n\">wrapper</span><span class=\"o\">.</span><span class=\"n\">frame</span> <span class=\"o\">=</span> <span class=\"kt\">CGRect</span><span class=\"p\">(</span><span class=\"nv\">x</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"nv\">y</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"nv\">width</span><span class=\"p\">:</span> <span class=\"mi\">1280</span><span class=\"p\">,</span> <span class=\"nv\">height</span><span class=\"p\">:</span> <span class=\"mi\">640</span><span class=\"p\">)</span>\n\n        <span class=\"k\">let</span> <span class=\"nv\">png</span> <span class=\"o\">=</span> <span class=\"nf\">rasterize</span><span class=\"p\">(</span><span class=\"nv\">view</span><span class=\"p\">:</span> <span class=\"n\">wrapper</span><span class=\"p\">,</span> <span class=\"nv\">format</span><span class=\"p\">:</span> <span class=\"o\">.</span><span class=\"n\">png</span><span class=\"p\">)</span>\n        <span class=\"k\">try</span> <span class=\"n\">png</span><span class=\"p\">?</span><span class=\"o\">.</span><span class=\"nf\">write</span><span class=\"p\">(</span><span class=\"nv\">to</span><span class=\"p\">:</span> <span class=\"kt\">URL</span><span class=\"p\">(</span><span class=\"nv\">fileURLWithPath</span><span class=\"p\">:</span> <span class=\"s\">\"issue-</span><span class=\"se\">\\(</span><span class=\"n\">issueNumber</span><span class=\"se\">)</span><span class=\"s\">.png\"</span><span class=\"p\">))</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"kd\">static</span> <span class=\"kd\">func</span> <span class=\"nf\">rasterize</span><span class=\"p\">(</span><span class=\"nv\">view</span><span class=\"p\">:</span> <span class=\"kt\">NSView</span><span class=\"p\">,</span> <span class=\"nv\">format</span><span class=\"p\">:</span> <span class=\"kt\">NSBitmapImageRep</span><span class=\"o\">.</span><span class=\"kt\">FileType</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">Data</span><span class=\"p\">?</span> <span class=\"p\">{</span>\n        <span class=\"k\">guard</span> <span class=\"k\">let</span> <span class=\"nv\">bitmapRepresentation</span> <span class=\"o\">=</span> <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"nf\">bitmapImageRepForCachingDisplay</span><span class=\"p\">(</span><span class=\"nv\">in</span><span class=\"p\">:</span> <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">bounds</span><span class=\"p\">)</span> <span class=\"k\">else</span> <span class=\"p\">{</span>\n            <span class=\"k\">return</span> <span class=\"kc\">nil</span>\n        <span class=\"p\">}</span>\n        <span class=\"n\">bitmapRepresentation</span><span class=\"o\">.</span><span class=\"n\">size</span> <span class=\"o\">=</span> <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">bounds</span><span class=\"o\">.</span><span class=\"n\">size</span>\n        <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"nf\">cacheDisplay</span><span class=\"p\">(</span><span class=\"nv\">in</span><span class=\"p\">:</span> <span class=\"n\">view</span><span class=\"o\">.</span><span class=\"n\">bounds</span><span class=\"p\">,</span> <span class=\"nv\">to</span><span class=\"p\">:</span> <span class=\"n\">bitmapRepresentation</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">bitmapRepresentation</span><span class=\"o\">.</span><span class=\"nf\">representation</span><span class=\"p\">(</span><span class=\"nv\">using</span><span class=\"p\">:</span> <span class=\"n\">format</span><span class=\"p\">,</span> <span class=\"nv\">properties</span><span class=\"p\">:</span> <span class=\"p\">[:])</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">try</span> <span class=\"kt\">SocialPreviewGenerator</span><span class=\"o\">.</span><span class=\"nf\">main</span><span class=\"p\">()</span>\n</code></pre></div></div>\n\n<p>You can find the full source code on this repo, feel free to use it.</p>\n\n<h2 id=\"setting-up-the-workflow\">Setting up the workflow</h2>\n\n<p>Since SwiftUI only runs on Apple platforms, I decided to run this process in a GitHub Action workflow, using a macOS job.</p>\n\n<p>Here is how it works:</p>\n<ul>\n  <li>I’ve updated my existing <a href=\"https://github.com/eneko/Blog/blob/main/.github/workflows/issue.yml\">issue workflow</a>, adding a new <code class=\"language-plaintext highlighter-rouge\">generateSocialPreview</code> job</li>\n  <li>This job runs on macOS</li>\n  <li>The job checks-out the repo, and runs the Swift command to generate the media preview image.</li>\n  <li>Finally, the workflow uploads the generated image to Amazon S3.</li>\n</ul>\n\n<p>This workflow will run before pushing the issue changes to AWS SQS.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103180848-95a1f400-484e-11eb-9a39-25f06363557f.png\" alt=\"Screen Shot 2020-12-27 at 2 16 06 PM\" /></p>\n\n<h3 id=\"uploading-images-to-amazon-s3\">Uploading images to Amazon S3</h3>\n\n<p>Uploading files to S3 is pretty easy, since we can use AWS CLI in Github Actions. First, we set the credentials, and then we are good to go. Here, I’m hardcoding the file name, but will later be dynamic based in the issue number:</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"pi\">-</span> <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">aws-actions/configure-aws-credentials@v1</span>\n  <span class=\"na\">with</span><span class=\"pi\">:</span>\n    <span class=\"na\">aws-access-key-id</span><span class=\"pi\">:</span> <span class=\"s\">${ { secrets.AWS_ACCESS_KEY_ID } }</span>\n    <span class=\"na\">aws-secret-access-key</span><span class=\"pi\">:</span> <span class=\"s\">${ { secrets.AWS_SECRET_ACCESS_KEY } }</span>\n    <span class=\"na\">aws-region</span><span class=\"pi\">:</span> <span class=\"s\">us-east-2</span>\n<span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Copy to S3</span>\n  <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"pi\">|</span>\n    <span class=\"s\">aws s3 cp issue-25.png s3://eneko-blog-media/social-preview/issue-25.png --acl public-read</span>\n</code></pre></div></div>\n\n<p>To get this working, the user role associated with the credentials must have permissions to put objects in S3, and to update their ACL, so they can be make public-read.</p>\n\n<p>Here is how my policy looks like:</p>\n\n<div class=\"language-json highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"nl\">\"Version\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"2012-10-17\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"nl\">\"Statement\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n        </span><span class=\"p\">{</span><span class=\"w\">\n            </span><span class=\"nl\">\"Sid\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"VisualEditor0\"</span><span class=\"p\">,</span><span class=\"w\">\n            </span><span class=\"nl\">\"Effect\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Allow\"</span><span class=\"p\">,</span><span class=\"w\">\n            </span><span class=\"nl\">\"Action\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n                </span><span class=\"s2\">\"s3:PutObject\"</span><span class=\"p\">,</span><span class=\"w\">\n                </span><span class=\"s2\">\"s3:PutObjectAcl\"</span><span class=\"w\">\n            </span><span class=\"p\">],</span><span class=\"w\">\n            </span><span class=\"nl\">\"Resource\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"arn:aws:s3:::eneko-blog-media/*\"</span><span class=\"w\">\n        </span><span class=\"p\">}</span><span class=\"w\">\n    </span><span class=\"p\">]</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<h2 id=\"running-the-workflow\">Running the workflow</h2>\n\n<p>After a couple of runs testing permissions, the workflow completed successfully.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103179788-5ff80d80-4844-11eb-92ec-75321cf7800c.png\" alt=\"Screen Shot 2020-12-27 at 10 24 18 AM\" /></p>\n\n<h2 id=\"unexpected-issue-no-fonts\">Unexpected Issue: No Fonts!</h2>\n\n<p>Well, not that there are no fonts, but the fonts I’m using, “SF Pro Display” and “SF Mono” do not seem to be installed on macOS instances in Github Actions. 😭</p>\n\n<p>Here is how it looks like “out-of-the-box”</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103179779-3b039a80-4844-11eb-9ce4-04d2315107f6.png\" alt=\"issue-25\" /></p>\n\n<h3 id=\"attempt-1-adding-custom-fonts\">Attempt 1: Adding custom fonts</h3>\n\n<p>I downloaded SF Pro Display and SF Mono fonts from Apple website, <a href=\"https://github.com/eneko/Blog/commit/ca39f84c07d06343ddd9bd9da49e3e58ad7a09f6\">added them to this repo</a>, and updated the workflow to copy them to <code class=\"language-plaintext highlighter-rouge\">~/Library/Fonts</code>.</p>\n\n<p>No luck. While the <a href=\"https://github.com/eneko/Blog/runs/1615026612?check_suite_focus=true\">workflow completed successfully</a>, the rendered image looks as before, without custom San Francisco fonts.</p>\n\n<h3 id=\"attempt-2-using-system-fonts\">Attempt 2: Using system fonts</h3>\n\n<p>Instead of trying to install a custom font (might try again later), for now I’m going to use the default system font.</p>\n\n<p>And… there you go! Much better 👏👏</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103181132-76a56100-4852-11eb-8400-99e3a9baf528.png\" alt=\"issue-25-2\" /></p>\n\n<h2 id=\"final-steps\">Final steps</h2>\n\n<p>Now that the workflow is working, there are a few remaining tasks:</p>\n<ul>\n  <li>Configure preview generator to pass all issue arguments (title, tags, creation date and issue number). Since it is a command line tool, I could either pass this info via individual arguments, or passing JSON via stdin or disk.</li>\n  <li>Update post template to use new generated image url for social media previews.</li>\n</ul>\n\n<p>Let’s get to it.</p>\n\n<h3 id=\"processing-event-issues-json\">Processing event issues (JSON)</h3>\n\n<p>Since I already have the <code class=\"language-plaintext highlighter-rouge\">Codable</code> structures for the Lambda to load the event issue JSON, I decide to also use them for the social media preview generator. Here are the two structures I’ll be using:</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">public</span> <span class=\"kd\">struct</span> <span class=\"kt\">GitHubIssue</span><span class=\"p\">:</span> <span class=\"kt\">Codable</span> <span class=\"p\">{</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">number</span><span class=\"p\">:</span> <span class=\"kt\">Int</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">state</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">body</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">title</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">labels</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"kt\">GitHubLabel</span><span class=\"p\">]</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">createdAt</span><span class=\"p\">:</span> <span class=\"kt\">Date</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">updatedAt</span><span class=\"p\">:</span> <span class=\"kt\">Date</span>\n<span class=\"p\">}</span>\n\n<span class=\"kd\">public</span> <span class=\"kd\">struct</span> <span class=\"kt\">GitHubLabel</span><span class=\"p\">:</span> <span class=\"kt\">Codable</span> <span class=\"p\">{</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">color</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n    <span class=\"kd\">public</span> <span class=\"k\">let</span> <span class=\"nv\">name</span><span class=\"p\">:</span> <span class=\"kt\">String</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>I’m also reusing <code class=\"language-plaintext highlighter-rouge\">IssueParser</code>, since it has the logic for parsing ISO dates and <code class=\"language-plaintext highlighter-rouge\">snake_case</code> JSON keys.</p>\n\n<p>Here is the Yaml action, writing the JSON to disk and loading it to generate the preview:</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Write File</span>\n  <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">DamianReeves/write-file-action@v1.0</span>\n  <span class=\"na\">with</span><span class=\"pi\">:</span>\n    <span class=\"na\">path</span><span class=\"pi\">:</span> <span class=\"s\">issue.json</span>\n    <span class=\"na\">contents</span><span class=\"pi\">:</span> <span class=\"s\">${ { toJSON(github.event.issue) } }</span>\n    <span class=\"na\">write-mode</span><span class=\"pi\">:</span> <span class=\"s\">overwrite</span>\n<span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Generate Preview</span>\n  <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"pi\">|</span>\n    <span class=\"s\">swift run socialpreview issue.json</span>\n</code></pre></div></div>\n\n<h2 id=\"final-result\">Final Result</h2>\n\n<p>While I’m still doing some tweaks and updates, here is the result at the moment:</p>\n\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">Generating Social Media preview images with SwiftUI and GitHub Actions<a href=\"https://t.co/85Sf1ZOQpB\">https://t.co/85Sf1ZOQpB</a><a href=\"https://twitter.com/hashtag/swift?src=hash&amp;ref_src=twsrc%5Etfw\">#swift</a> <a href=\"https://twitter.com/hashtag/SwiftUI?src=hash&amp;ref_src=twsrc%5Etfw\">#SwiftUI</a> <a href=\"https://twitter.com/hashtag/githubactions?src=hash&amp;ref_src=twsrc%5Etfw\">#githubactions</a></p>&mdash; Eneko Alonso (@eneko) <a href=\"https://twitter.com/eneko/status/1343416173380165632?ref_src=twsrc%5Etfw\">December 28, 2020</a></blockquote>\n<script async=\"\" src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/13\">Issue #13</a>)</small></i></p>",
      "date_published": "2020-12-27T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-12",
      "url": "https://www.enekoalonso.com/articles/issue-12",
      "title": "Testing Linux Swift packages from macOS terminal with Docker",
      "content_html": "<p>For those of us that write Swift Packages that run on Linux, testing them on that platform before deployment can be a good time saver. Specially when dealing with code that is available on macOS but not on Linux (e.g. <code class=\"language-plaintext highlighter-rouge\">Foundation</code> vs <code class=\"language-plaintext highlighter-rouge\">FoundationNetworking</code>).</p>\n\n<p>Using Docker for testing Swift Packages on Linux from the command line is not a new technique. There are many articles describing how to do this. However, I find myself often searching the web for those articles (or searching across my own projects), when I forget the exact steps to set it up. So I decided to write it down here, as a blog post, and keep it handy.</p>\n\n<p>A few months ago, I set this up on <a href=\"https://github.com/eneko/ProcessRunner\">ProcessRunner</a>, my little library to launch child processes from Swift. Here are the steps.</p>\n\n<h2 id=\"setup-dockerfile\">Setup Dockerfile</h2>\n\n<blockquote>\n  <p>This setup assumes you have <a href=\"https://hub.docker.com/editions/community/docker-ce-desktop-mac/\">Docker Desktop for macOS</a> installed</p>\n</blockquote>\n\n<p>Create a <code class=\"language-plaintext highlighter-rouge\">Dockerfile</code> in the root of your package (next to <code class=\"language-plaintext highlighter-rouge\">Package.swift</code>)</p>\n\n<div class=\"language-Dockerfile highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\">#FROM swiftlang/swift:nightly-master-    &lt;- use this image for the latest nightly build</span>\n<span class=\"c\">#FROM swift:amazonlinux2 &lt;- For testing on Amazon Linux 2</span>\n<span class=\"c\">#FROM swift:ubuntu-latest &lt;- For testing on Ubuntu Linux</span>\n<span class=\"k\">FROM</span><span class=\"s\"> swift:latest &lt;- default Swift image (latest)</span>\n\n<span class=\"k\">WORKDIR</span><span class=\"s\"> /tmp</span>\n\n<span class=\"k\">ADD</span><span class=\"s\"> Sources ./Sources</span>\n<span class=\"k\">ADD</span><span class=\"s\"> Tests ./Tests</span>\n<span class=\"k\">ADD</span><span class=\"s\"> Package.swift ./</span>\n\n<span class=\"k\">CMD</span><span class=\"s\"> swift test --enable-test-discovery</span>\n</code></pre></div></div>\n\n<p>The docker script above configures the file paths available in the docker Linux image, and executes the command to run the tests. If your package uses files from other directories than <code class=\"language-plaintext highlighter-rouge\">Sources</code> and <code class=\"language-plaintext highlighter-rouge\">Tests</code>, you will need to copy those too.</p>\n\n<h2 id=\"run-tests-with-docker\">Run Tests with Docker</h2>\n\n<p>To run the tests you can use the <code class=\"language-plaintext highlighter-rouge\">docker</code> CLI. I personally like putting this command on a <code class=\"language-plaintext highlighter-rouge\">Makefile</code>, so I don’t have to remember it later on.</p>\n\n<pre><code class=\"language-Makefile\">linuxtest:\n\tdocker build -f Dockerfile -t linuxtest .\n\tdocker run linuxtest\n</code></pre>\n\n<p>This script will build and tag the docker image, and then execute it right away.</p>\n\n<p>Example output running unit tests from my <a href=\"https://github.com/eneko/Blog\">Blog</a> package on Linux. In this case my docker configuration file is called <code class=\"language-plaintext highlighter-rouge\">LinuxTest.Dockerfile</code>, since I have another <code class=\"language-plaintext highlighter-rouge\">Dockerfile</code> for building the lambdas:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>$ make linuxtest \ndocker build -f LinuxTest.Dockerfile -t linuxtest .\nSending build context to Docker daemon  460.5MB\nStep 1/6 : FROM swift:amazonlinux2\n ---&gt; ee272321cb22\nStep 2/6 : WORKDIR /tmp\n ---&gt; Using cache\n ---&gt; 829a05bcaf38\nStep 3/6 : ADD Sources ./Sources\n ---&gt; d72020d70e2e\nStep 4/6 : ADD Tests ./Tests\n ---&gt; 5fc9bd86107f\nStep 5/6 : ADD Package.swift ./\n ---&gt; 27ba35153aa8\nStep 6/6 : CMD swift test --enable-test-discovery\n ---&gt; Running in 62ebb976560a\nRemoving intermediate container 62ebb976560a\n ---&gt; 651506ce9efb\nSuccessfully built 651506ce9efb\nSuccessfully tagged linuxtest:latest\ndocker run linuxtest\nFetching https://github.com/swift-server/swift-aws-lambda-runtime\nFetching https://github.com/apple/swift-log.git\nFetching https://github.com/apple/swift-nio.git\nFetching https://github.com/swift-server/swift-backtrace.git\nCloning https://github.com/apple/swift-log.git\nResolving https://github.com/apple/swift-log.git at 1.4.0\nCloning https://github.com/swift-server/swift-aws-lambda-runtime\nResolving https://github.com/swift-server/swift-aws-lambda-runtime at 0.3.0\nCloning https://github.com/swift-server/swift-backtrace.git\nResolving https://github.com/swift-server/swift-backtrace.git at 1.2.0\nCloning https://github.com/apple/swift-nio.git\nResolving https://github.com/apple/swift-nio.git at 2.25.1\n[1/36] Compiling CNIOWindows WSAStartup.c\n[2/36] Compiling CNIODarwin shim.c\n[3/36] Compiling CNIOWindows shim.c\n[4/52] Compiling CNIOLinux shim.c\n[5/52] Compiling CNIOSHA1 c_nio_sha1.c\n[6/52] Compiling CBacktrace state.c\n[7/52] Compiling CBacktrace sort.c\n[8/52] Compiling CNIOHTTPParser c_nio_http_parser.c\n[9/52] Compiling CBacktrace simple.c\n[10/52] Compiling CBacktrace print.c\n[11/52] Compiling CBacktrace posix.c\n[12/52] Compiling CBacktrace mmapio.c\n[13/52] Compiling CBacktrace mmap.c\n[14/52] Compiling CBacktrace fileline.c\n[15/52] Compiling CBacktrace elf.c\n[16/52] Compiling CBacktrace dwarf.c\n[17/52] Compiling CBacktrace backtrace.c\n[18/52] Compiling CBacktrace atomic.c\n[19/54] Compiling Backtrace Backtrace.swift\n[20/54] Compiling Backtrace Demangle.swift\n[21/55] Merging module Backtrace\n[22/55] Wrapping AST for Backtrace for debugging\n[24/55] Compiling AWSLambdaEvents DynamoDB.swift\n[25/55] Compiling AWSLambdaEvents S3.swift\n[26/55] Compiling AWSLambdaEvents SES.swift\n[27/55] Compiling AWSLambdaEvents SNS.swift\n[28/55] Compiling Logging Logging.swift\n[32/55] Compiling AWSLambdaEvents SQS.swift\n[33/55] Compiling AWSLambdaEvents Base64.swift\n[35/56] Compiling AWSLambdaEvents AWSRegion.swift\n[36/56] Compiling AWSLambdaEvents Cloudwatch.swift\n[37/56] Compiling AWSLambdaEvents DateWrappers.swift\n[38/56] Compiling AWSLambdaEvents HTTP.swift\n[39/57] Merging module Logging\n[40/61] Wrapping AST for Logging for debugging\n[41/61] Merging module AWSLambdaEvents\n[42/61] Compiling Blog IssueParser.swift\n[43/61] Wrapping AST for AWSLambdaEvents for debugging\n[44/61] Compiling Blog PostRenderer.swift\n[45/61] Compiling Blog GitHubContext.swift\n[46/61] Compiling Blog IssueProcessor.swift\n[47/62] Merging module Blog\n[48/64] Wrapping AST for Blog for debugging\n[49/64] Compiling c-nioatomics.c\n[50/64] Compiling BlogTests Event.swift\n[51/64] Compiling c-atomics.c\n[52/67] Compiling NIOConcurrencyHelpers NIOAtomic.swift\n[53/68] Merging module BlogTests\n[54/68] Wrapping AST for BlogTests for debugging\n[55/68] /tmp/.build/x86_64-unknown-linux-gnu/debug/BlogPackageTestsTestlist.derived/main.swift\n[56/70] Compiling BlogPackageTests BlogTests.swift\n[57/70] Compiling BlogPackageTests main.swift\n[58/71] Merging module BlogPackageTests\n[59/71] Wrapping AST for BlogPackageTests for debugging\n[60/71] Compiling NIOConcurrencyHelpers lock.swift\n[61/71] Linking BlogPackageTests.xctest\n[64/72] Merging module NIOConcurrencyHelpers\n[65/72] Wrapping AST for NIOConcurrencyHelpers for debugging\n[66/144] Compiling NIO PendingWritesManager.swift\n[67/144] Compiling NIO PipeChannel.swift\n[68/144] Compiling NIO PipePair.swift\n[69/144] Compiling NIO PointerHelpers.swift\n[70/144] Compiling NIO PriorityQueue.swift\n[71/144] Compiling NIO RecvByteBufferAllocator.swift\n[72/144] Compiling NIO Resolver.swift\n[73/144] Compiling NIO Selectable.swift\n[74/144] Compiling NIO SelectableEventLoop.swift\n[75/144] Compiling NIO Selector.swift\n[76/144] Compiling NIO ServerSocket.swift\n[77/144] Compiling NIO SingleStepByteToMessageDecoder.swift\n[78/144] Compiling NIO IOData.swift\n[79/144] Compiling NIO IntegerTypes.swift\n[80/144] Compiling NIO Interfaces.swift\n[81/144] Compiling NIO Linux.swift\n[82/144] Compiling NIO LinuxCPUSet.swift\n[83/144] Compiling NIO MarkedCircularBuffer.swift\n[84/144] Compiling NIO MulticastChannel.swift\n[85/144] Compiling NIO NIOAny.swift\n[86/144] Compiling NIO NIOCloseOnErrorHandler.swift\n[87/144] Compiling NIO NIOThreadPool.swift\n[88/144] Compiling NIO NonBlockingFileIO.swift\n[89/144] Compiling NIO PendingDatagramWritesManager.swift\n[90/144] Compiling NIO Socket.swift\n[91/144] Compiling NIO SocketAddresses.swift\n[92/144] Compiling NIO SocketChannel.swift\n[93/144] Compiling NIO SocketOptionProvider.swift\n[94/144] Compiling NIO SocketProtocols.swift\n[95/144] Compiling NIO System.swift\n[96/144] Compiling NIO Thread.swift\n[97/144] Compiling NIO ThreadPosix.swift\n[98/144] Compiling NIO ThreadWindows.swift\n[99/144] Compiling NIO TypeAssistedChannelHandler.swift\n[100/144] Compiling NIO UniversalBootstrapSupport.swift\n[101/144] Compiling NIO Utilities.swift\n[102/144] Compiling NIO DeadChannel.swift\n[103/144] Compiling NIO DispathQueue+WithFuture.swift\n[104/144] Compiling NIO Embedded.swift\n[105/144] Compiling NIO EventLoop.swift\n[106/144] Compiling NIO EventLoopFuture.swift\n[107/144] Compiling NIO FileDescriptor.swift\n[108/144] Compiling NIO FileHandle.swift\n[109/144] Compiling NIO FileRegion.swift\n[110/144] Compiling NIO GetaddrinfoResolver.swift\n[111/144] Compiling NIO HappyEyeballs.swift\n[112/144] Compiling NIO Heap.swift\n[113/144] Compiling NIO IO.swift\n[114/144] Compiling NIO ByteBuffer-views.swift\n[115/144] Compiling NIO Channel.swift\n[116/144] Compiling NIO ChannelHandler.swift\n[117/144] Compiling NIO ChannelHandlers.swift\n[118/144] Compiling NIO ChannelInvoker.swift\n[119/144] Compiling NIO ChannelOption.swift\n[120/144] Compiling NIO ChannelPipeline.swift\n[121/144] Compiling NIO CircularBuffer.swift\n[122/144] Compiling NIO Codec.swift\n[123/144] Compiling NIO ControlMessage.swift\n[124/144] Compiling NIO ConvenienceOptionSupport.swift\n[125/144] Compiling NIO DatagramVectorReadManager.swift\n[126/144] Compiling NIO AddressedEnvelope.swift\n[127/144] Compiling NIO BSDSocketAPI.swift\n[128/144] Compiling NIO BSDSocketAPIPosix.swift\n[129/144] Compiling NIO BSDSocketAPIWindows.swift\n[130/144] Compiling NIO BaseSocket.swift\n[131/144] Compiling NIO BaseSocketChannel.swift\n[132/144] Compiling NIO BaseStreamSocketChannel.swift\n[133/144] Compiling NIO Bootstrap.swift\n[134/144] Compiling NIO ByteBuffer-aux.swift\n[135/144] Compiling NIO ByteBuffer-conversions.swift\n[136/144] Compiling NIO ByteBuffer-core.swift\n[137/144] Compiling NIO ByteBuffer-int.swift\n[138/145] Merging module NIO\n[139/153] Wrapping AST for NIO for debugging\n[140/157] Compiling NIOHTTP1 HTTPDecoder.swift\n[141/157] Compiling NIOHTTP1 NIOHTTPObjectAggregator.swift\n[142/157] Compiling NIOHTTP1 NIOHTTPClientUpgradeHandler.swift\n[143/157] Compiling NIOHTTP1 HTTPServerPipelineHandler.swift\n[144/157] Compiling NIOHTTP1 HTTPServerProtocolErrorHandler.swift\n[145/157] Compiling NIOHTTP1 ByteCollectionUtils.swift\n[146/158] Compiling NIOHTTP1 HTTPEncoder.swift\n[147/158] Compiling NIOHTTP1 HTTPPipelineSetup.swift\n[148/158] Merging module NIOFoundationCompat\n[149/158] Wrapping AST for NIOFoundationCompat for debugging\n[150/158] Compiling NIOHTTP1 HTTPServerUpgradeHandler.swift\n[151/158] Compiling NIOHTTP1 HTTPTypes.swift\n[154/159] Merging module NIOHTTP1\n[155/165] Wrapping AST for NIOHTTP1 for debugging\n[156/170] Compiling AWSLambdaRuntimeCore Lambda+String.swift\n[157/170] Compiling AWSLambdaRuntimeCore Lambda.swift\n[158/170] Compiling AWSLambdaRuntimeCore LambdaHandler.swift\n[159/170] Compiling AWSLambdaRuntimeCore LambdaLifecycle.swift\n[160/170] Compiling AWSLambdaRuntimeCore LambdaConfiguration.swift\n[161/170] Compiling AWSLambdaRuntimeCore LambdaContext.swift\n[162/170] Compiling AWSLambdaRuntimeCore Utils.swift\n[163/170] Compiling AWSLambdaRuntimeCore LambdaRunner.swift\n[164/170] Compiling AWSLambdaRuntimeCore LambdaRuntimeClient.swift\n[165/170] Compiling AWSLambdaRuntimeCore HTTPClient.swift\n[166/170] Compiling AWSLambdaRuntimeCore Lambda+LocalServer.swift\n[167/171] Merging module AWSLambdaRuntimeCore\n[168/173] Wrapping AST for AWSLambdaRuntimeCore for debugging\n[169/173] Compiling AWSLambdaRuntime Context+Foundation.swift\n[170/173] Compiling AWSLambdaRuntime Lambda+Codable.swift\n[171/174] Merging module AWSLambdaRuntime\n[172/175] Wrapping AST for AWSLambdaRuntime for debugging\n[173/175] Compiling IssueProcessorLambda main.swift\n[174/176] Merging module IssueProcessorLambda\n[175/176] Wrapping AST for IssueProcessorLambda for debugging\n[176/176] Linking IssueProcessorLambda\nTest Suite 'All tests' started at 2020-12-26 04:10:51.668\nTest Suite 'debug.xctest' started at 2020-12-26 04:10:51.698\nTest Suite 'BlogTests' started at 2020-12-26 04:10:51.698\nTest Case 'BlogTests.testParser' started at 2020-12-26 04:10:51.699\nTest Case 'BlogTests.testParser' passed (0.012 seconds)\nTest Case 'BlogTests.testPayload' started at 2020-12-26 04:10:51.711\nTest Case 'BlogTests.testPayload' passed (0.003 seconds)\nTest Case 'BlogTests.testRenderer' started at 2020-12-26 04:10:51.714\nTest Case 'BlogTests.testRenderer' passed (0.004 seconds)\nTest Case 'BlogTests.testRendererFilename' started at 2020-12-26 04:10:51.718\nTest Case 'BlogTests.testRendererFilename' passed (0.002 seconds)\nTest Suite 'BlogTests' passed at 2020-12-26 04:10:51.720\n\t Executed 4 tests, with 0 failures (0 unexpected) in 0.021 (0.021) seconds\nTest Suite 'debug.xctest' passed at 2020-12-26 04:10:51.720\n\t Executed 4 tests, with 0 failures (0 unexpected) in 0.021 (0.021) seconds\nTest Suite 'All tests' passed at 2020-12-26 04:10:51.720\n\t Executed 4 tests, with 0 failures (0 unexpected) in 0.021 (0.021) seconds\n</code></pre></div></div>\n\n<p>Yay! My four tests are passing 😅 Should probably get to write more tests now.</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/12\">Issue #12</a>)</small></i></p>",
      "summary": "<p>For those of us that write Swift Packages that run on Linux, testing them on that platform before deployment can be a good time saver. Specially when dealing with code that is available on macOS but not on Linux (e.g. <code class=\"language-plaintext highlighter-rouge\">Foundation</code> vs <code class=\"language-plaintext highlighter-rouge\">FoundationNetworking</code>).</p>\n\n<p>Using Docker for testing Swift Packages on Linux from the command line is not a new technique. There are many articles describing how to do this. However, I find myself often searching the web for those articles (or searching across my own projects), when I forget the exact steps to set it up. So I decided to write it down here, as a blog post, and keep it handy.</p>\n\n<p>A few months ago, I set this up on <a href=\"https://github.com/eneko/ProcessRunner\">ProcessRunner</a>, my little library to launch child processes from Swift. Here are the steps.</p>\n\n<h2 id=\"setup-dockerfile\">Setup Dockerfile</h2>\n\n<blockquote>\n  <p>This setup assumes you have <a href=\"https://hub.docker.com/editions/community/docker-ce-desktop-mac/\">Docker Desktop for macOS</a> installed</p>\n</blockquote>\n\n<p>Create a <code class=\"language-plaintext highlighter-rouge\">Dockerfile</code> in the root of your package (next to <code class=\"language-plaintext highlighter-rouge\">Package.swift</code>)</p>\n\n<div class=\"language-Dockerfile highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\">#FROM swiftlang/swift:nightly-master-    &lt;- use this image for the latest nightly build</span>\n<span class=\"c\">#FROM swift:amazonlinux2 &lt;- For testing on Amazon Linux 2</span>\n<span class=\"c\">#FROM swift:ubuntu-latest &lt;- For testing on Ubuntu Linux</span>\n<span class=\"k\">FROM</span><span class=\"s\"> swift:latest &lt;- default Swift image (latest)</span>\n\n<span class=\"k\">WORKDIR</span><span class=\"s\"> /tmp</span>\n\n<span class=\"k\">ADD</span><span class=\"s\"> Sources ./Sources</span>\n<span class=\"k\">ADD</span><span class=\"s\"> Tests ./Tests</span>\n<span class=\"k\">ADD</span><span class=\"s\"> Package.swift ./</span>\n\n<span class=\"k\">CMD</span><span class=\"s\"> swift test --enable-test-discovery</span>\n</code></pre></div></div>\n\n<p>The docker script above configures the file paths available in the docker Linux image, and executes the command to run the tests. If your package uses files from other directories than <code class=\"language-plaintext highlighter-rouge\">Sources</code> and <code class=\"language-plaintext highlighter-rouge\">Tests</code>, you will need to copy those too.</p>\n\n<h2 id=\"run-tests-with-docker\">Run Tests with Docker</h2>\n\n<p>To run the tests you can use the <code class=\"language-plaintext highlighter-rouge\">docker</code> CLI. I personally like putting this command on a <code class=\"language-plaintext highlighter-rouge\">Makefile</code>, so I don’t have to remember it later on.</p>\n\n<pre><code class=\"language-Makefile\">linuxtest:\n\tdocker build -f Dockerfile -t linuxtest .\n\tdocker run linuxtest\n</code></pre>\n\n<p>This script will build and tag the docker image, and then execute it right away.</p>\n\n<p>Example output running unit tests from my <a href=\"https://github.com/eneko/Blog\">Blog</a> package on Linux. In this case my docker configuration file is called <code class=\"language-plaintext highlighter-rouge\">LinuxTest.Dockerfile</code>, since I have another <code class=\"language-plaintext highlighter-rouge\">Dockerfile</code> for building the lambdas:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>$ make linuxtest \ndocker build -f LinuxTest.Dockerfile -t linuxtest .\nSending build context to Docker daemon  460.5MB\nStep 1/6 : FROM swift:amazonlinux2\n ---&gt; ee272321cb22\nStep 2/6 : WORKDIR /tmp\n ---&gt; Using cache\n ---&gt; 829a05bcaf38\nStep 3/6 : ADD Sources ./Sources\n ---&gt; d72020d70e2e\nStep 4/6 : ADD Tests ./Tests\n ---&gt; 5fc9bd86107f\nStep 5/6 : ADD Package.swift ./\n ---&gt; 27ba35153aa8\nStep 6/6 : CMD swift test --enable-test-discovery\n ---&gt; Running in 62ebb976560a\nRemoving intermediate container 62ebb976560a\n ---&gt; 651506ce9efb\nSuccessfully built 651506ce9efb\nSuccessfully tagged linuxtest:latest\ndocker run linuxtest\nFetching https://github.com/swift-server/swift-aws-lambda-runtime\nFetching https://github.com/apple/swift-log.git\nFetching https://github.com/apple/swift-nio.git\nFetching https://github.com/swift-server/swift-backtrace.git\nCloning https://github.com/apple/swift-log.git\nResolving https://github.com/apple/swift-log.git at 1.4.0\nCloning https://github.com/swift-server/swift-aws-lambda-runtime\nResolving https://github.com/swift-server/swift-aws-lambda-runtime at 0.3.0\nCloning https://github.com/swift-server/swift-backtrace.git\nResolving https://github.com/swift-server/swift-backtrace.git at 1.2.0\nCloning https://github.com/apple/swift-nio.git\nResolving https://github.com/apple/swift-nio.git at 2.25.1\n[1/36] Compiling CNIOWindows WSAStartup.c\n[2/36] Compiling CNIODarwin shim.c\n[3/36] Compiling CNIOWindows shim.c\n[4/52] Compiling CNIOLinux shim.c\n[5/52] Compiling CNIOSHA1 c_nio_sha1.c\n[6/52] Compiling CBacktrace state.c\n[7/52] Compiling CBacktrace sort.c\n[8/52] Compiling CNIOHTTPParser c_nio_http_parser.c\n[9/52] Compiling CBacktrace simple.c\n[10/52] Compiling CBacktrace print.c\n[11/52] Compiling CBacktrace posix.c\n[12/52] Compiling CBacktrace mmapio.c\n[13/52] Compiling CBacktrace mmap.c\n[14/52] Compiling CBacktrace fileline.c\n[15/52] Compiling CBacktrace elf.c\n[16/52] Compiling CBacktrace dwarf.c\n[17/52] Compiling CBacktrace backtrace.c\n[18/52] Compiling CBacktrace atomic.c\n[19/54] Compiling Backtrace Backtrace.swift\n[20/54] Compiling Backtrace Demangle.swift\n[21/55] Merging module Backtrace\n[22/55] Wrapping AST for Backtrace for debugging\n[24/55] Compiling AWSLambdaEvents DynamoDB.swift\n[25/55] Compiling AWSLambdaEvents S3.swift\n[26/55] Compiling AWSLambdaEvents SES.swift\n[27/55] Compiling AWSLambdaEvents SNS.swift\n[28/55] Compiling Logging Logging.swift\n[32/55] Compiling AWSLambdaEvents SQS.swift\n[33/55] Compiling AWSLambdaEvents Base64.swift\n[35/56] Compiling AWSLambdaEvents AWSRegion.swift\n[36/56] Compiling AWSLambdaEvents Cloudwatch.swift\n[37/56] Compiling AWSLambdaEvents DateWrappers.swift\n[38/56] Compiling AWSLambdaEvents HTTP.swift\n[39/57] Merging module Logging\n[40/61] Wrapping AST for Logging for debugging\n[41/61] Merging module AWSLambdaEvents\n[42/61] Compiling Blog IssueParser.swift\n[43/61] Wrapping AST for AWSLambdaEvents for debugging\n[44/61] Compiling Blog PostRenderer.swift\n[45/61] Compiling Blog GitHubContext.swift\n[46/61] Compiling Blog IssueProcessor.swift\n[47/62] Merging module Blog\n[48/64] Wrapping AST for Blog for debugging\n[49/64] Compiling c-nioatomics.c\n[50/64] Compiling BlogTests Event.swift\n[51/64] Compiling c-atomics.c\n[52/67] Compiling NIOConcurrencyHelpers NIOAtomic.swift\n[53/68] Merging module BlogTests\n[54/68] Wrapping AST for BlogTests for debugging\n[55/68] /tmp/.build/x86_64-unknown-linux-gnu/debug/BlogPackageTestsTestlist.derived/main.swift\n[56/70] Compiling BlogPackageTests BlogTests.swift\n[57/70] Compiling BlogPackageTests main.swift\n[58/71] Merging module BlogPackageTests\n[59/71] Wrapping AST for BlogPackageTests for debugging\n[60/71] Compiling NIOConcurrencyHelpers lock.swift\n[61/71] Linking BlogPackageTests.xctest\n[64/72] Merging module NIOConcurrencyHelpers\n[65/72] Wrapping AST for NIOConcurrencyHelpers for debugging\n[66/144] Compiling NIO PendingWritesManager.swift\n[67/144] Compiling NIO PipeChannel.swift\n[68/144] Compiling NIO PipePair.swift\n[69/144] Compiling NIO PointerHelpers.swift\n[70/144] Compiling NIO PriorityQueue.swift\n[71/144] Compiling NIO RecvByteBufferAllocator.swift\n[72/144] Compiling NIO Resolver.swift\n[73/144] Compiling NIO Selectable.swift\n[74/144] Compiling NIO SelectableEventLoop.swift\n[75/144] Compiling NIO Selector.swift\n[76/144] Compiling NIO ServerSocket.swift\n[77/144] Compiling NIO SingleStepByteToMessageDecoder.swift\n[78/144] Compiling NIO IOData.swift\n[79/144] Compiling NIO IntegerTypes.swift\n[80/144] Compiling NIO Interfaces.swift\n[81/144] Compiling NIO Linux.swift\n[82/144] Compiling NIO LinuxCPUSet.swift\n[83/144] Compiling NIO MarkedCircularBuffer.swift\n[84/144] Compiling NIO MulticastChannel.swift\n[85/144] Compiling NIO NIOAny.swift\n[86/144] Compiling NIO NIOCloseOnErrorHandler.swift\n[87/144] Compiling NIO NIOThreadPool.swift\n[88/144] Compiling NIO NonBlockingFileIO.swift\n[89/144] Compiling NIO PendingDatagramWritesManager.swift\n[90/144] Compiling NIO Socket.swift\n[91/144] Compiling NIO SocketAddresses.swift\n[92/144] Compiling NIO SocketChannel.swift\n[93/144] Compiling NIO SocketOptionProvider.swift\n[94/144] Compiling NIO SocketProtocols.swift\n[95/144] Compiling NIO System.swift\n[96/144] Compiling NIO Thread.swift\n[97/144] Compiling NIO ThreadPosix.swift\n[98/144] Compiling NIO ThreadWindows.swift\n[99/144] Compiling NIO TypeAssistedChannelHandler.swift\n[100/144] Compiling NIO UniversalBootstrapSupport.swift\n[101/144] Compiling NIO Utilities.swift\n[102/144] Compiling NIO DeadChannel.swift\n[103/144] Compiling NIO DispathQueue+WithFuture.swift\n[104/144] Compiling NIO Embedded.swift\n[105/144] Compiling NIO EventLoop.swift\n[106/144] Compiling NIO EventLoopFuture.swift\n[107/144] Compiling NIO FileDescriptor.swift\n[108/144] Compiling NIO FileHandle.swift\n[109/144] Compiling NIO FileRegion.swift\n[110/144] Compiling NIO GetaddrinfoResolver.swift\n[111/144] Compiling NIO HappyEyeballs.swift\n[112/144] Compiling NIO Heap.swift\n[113/144] Compiling NIO IO.swift\n[114/144] Compiling NIO ByteBuffer-views.swift\n[115/144] Compiling NIO Channel.swift\n[116/144] Compiling NIO ChannelHandler.swift\n[117/144] Compiling NIO ChannelHandlers.swift\n[118/144] Compiling NIO ChannelInvoker.swift\n[119/144] Compiling NIO ChannelOption.swift\n[120/144] Compiling NIO ChannelPipeline.swift\n[121/144] Compiling NIO CircularBuffer.swift\n[122/144] Compiling NIO Codec.swift\n[123/144] Compiling NIO ControlMessage.swift\n[124/144] Compiling NIO ConvenienceOptionSupport.swift\n[125/144] Compiling NIO DatagramVectorReadManager.swift\n[126/144] Compiling NIO AddressedEnvelope.swift\n[127/144] Compiling NIO BSDSocketAPI.swift\n[128/144] Compiling NIO BSDSocketAPIPosix.swift\n[129/144] Compiling NIO BSDSocketAPIWindows.swift\n[130/144] Compiling NIO BaseSocket.swift\n[131/144] Compiling NIO BaseSocketChannel.swift\n[132/144] Compiling NIO BaseStreamSocketChannel.swift\n[133/144] Compiling NIO Bootstrap.swift\n[134/144] Compiling NIO ByteBuffer-aux.swift\n[135/144] Compiling NIO ByteBuffer-conversions.swift\n[136/144] Compiling NIO ByteBuffer-core.swift\n[137/144] Compiling NIO ByteBuffer-int.swift\n[138/145] Merging module NIO\n[139/153] Wrapping AST for NIO for debugging\n[140/157] Compiling NIOHTTP1 HTTPDecoder.swift\n[141/157] Compiling NIOHTTP1 NIOHTTPObjectAggregator.swift\n[142/157] Compiling NIOHTTP1 NIOHTTPClientUpgradeHandler.swift\n[143/157] Compiling NIOHTTP1 HTTPServerPipelineHandler.swift\n[144/157] Compiling NIOHTTP1 HTTPServerProtocolErrorHandler.swift\n[145/157] Compiling NIOHTTP1 ByteCollectionUtils.swift\n[146/158] Compiling NIOHTTP1 HTTPEncoder.swift\n[147/158] Compiling NIOHTTP1 HTTPPipelineSetup.swift\n[148/158] Merging module NIOFoundationCompat\n[149/158] Wrapping AST for NIOFoundationCompat for debugging\n[150/158] Compiling NIOHTTP1 HTTPServerUpgradeHandler.swift\n[151/158] Compiling NIOHTTP1 HTTPTypes.swift\n[154/159] Merging module NIOHTTP1\n[155/165] Wrapping AST for NIOHTTP1 for debugging\n[156/170] Compiling AWSLambdaRuntimeCore Lambda+String.swift\n[157/170] Compiling AWSLambdaRuntimeCore Lambda.swift\n[158/170] Compiling AWSLambdaRuntimeCore LambdaHandler.swift\n[159/170] Compiling AWSLambdaRuntimeCore LambdaLifecycle.swift\n[160/170] Compiling AWSLambdaRuntimeCore LambdaConfiguration.swift\n[161/170] Compiling AWSLambdaRuntimeCore LambdaContext.swift\n[162/170] Compiling AWSLambdaRuntimeCore Utils.swift\n[163/170] Compiling AWSLambdaRuntimeCore LambdaRunner.swift\n[164/170] Compiling AWSLambdaRuntimeCore LambdaRuntimeClient.swift\n[165/170] Compiling AWSLambdaRuntimeCore HTTPClient.swift\n[166/170] Compiling AWSLambdaRuntimeCore Lambda+LocalServer.swift\n[167/171] Merging module AWSLambdaRuntimeCore\n[168/173] Wrapping AST for AWSLambdaRuntimeCore for debugging\n[169/173] Compiling AWSLambdaRuntime Context+Foundation.swift\n[170/173] Compiling AWSLambdaRuntime Lambda+Codable.swift\n[171/174] Merging module AWSLambdaRuntime\n[172/175] Wrapping AST for AWSLambdaRuntime for debugging\n[173/175] Compiling IssueProcessorLambda main.swift\n[174/176] Merging module IssueProcessorLambda\n[175/176] Wrapping AST for IssueProcessorLambda for debugging\n[176/176] Linking IssueProcessorLambda\nTest Suite 'All tests' started at 2020-12-26 04:10:51.668\nTest Suite 'debug.xctest' started at 2020-12-26 04:10:51.698\nTest Suite 'BlogTests' started at 2020-12-26 04:10:51.698\nTest Case 'BlogTests.testParser' started at 2020-12-26 04:10:51.699\nTest Case 'BlogTests.testParser' passed (0.012 seconds)\nTest Case 'BlogTests.testPayload' started at 2020-12-26 04:10:51.711\nTest Case 'BlogTests.testPayload' passed (0.003 seconds)\nTest Case 'BlogTests.testRenderer' started at 2020-12-26 04:10:51.714\nTest Case 'BlogTests.testRenderer' passed (0.004 seconds)\nTest Case 'BlogTests.testRendererFilename' started at 2020-12-26 04:10:51.718\nTest Case 'BlogTests.testRendererFilename' passed (0.002 seconds)\nTest Suite 'BlogTests' passed at 2020-12-26 04:10:51.720\n\t Executed 4 tests, with 0 failures (0 unexpected) in 0.021 (0.021) seconds\nTest Suite 'debug.xctest' passed at 2020-12-26 04:10:51.720\n\t Executed 4 tests, with 0 failures (0 unexpected) in 0.021 (0.021) seconds\nTest Suite 'All tests' passed at 2020-12-26 04:10:51.720\n\t Executed 4 tests, with 0 failures (0 unexpected) in 0.021 (0.021) seconds\n</code></pre></div></div>\n\n<p>Yay! My four tests are passing 😅 Should probably get to write more tests now.</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/12\">Issue #12</a>)</small></i></p>",
      "date_published": "2020-12-25T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-11",
      "url": "https://www.enekoalonso.com/articles/issue-11",
      "title": "My 2020 year in review",
      "content_html": "<p>Here are some of the things I did in the tech-sphere on 2020.</p>\n\n<h2 id=\"articles\">Articles</h2>\n<ul>\n  <li><a href=\"https://medium.com/@eneko/solving-sudoku-puzzles-programmatically-with-logic-and-without-brute-force-b4e8b837d796\">Solve sudoku puzzles programmatically without using brute force</a>. It was a pretty fun project to do, as I like doing programming challenges every now and then and this was one that I had pending for a while.</li>\n  <li><a href=\"https://medium.com/@eneko/documenting-swift-packages-with-sourcedocs-3d5f6e110b75\">Documenting Swift Packages with SourceDocs</a>. See <a href=\"https://github.com/eneko/SourceDocs/releases/tag/1.0.0\">SourceDocs 1.0.0</a> for details on new features added.</li>\n  <li><a href=\"https://dev.to/eneko/using-datetemplates-in-swiftui-for-custom-date-formatting-1khn\">Using DateTemplates in SwiftUI for custom date formatting</a></li>\n  <li><a href=\"https://medium.com/@eneko/using-aws-dynamodb-from-a-command-line-swift-application-46d1c4b368df\">Using AWS DynamoDB from a Command Line Swift Application</a></li>\n  <li><a href=\"https://www.enekoalonso.com/2020/12/06/getting-started-with-async-await-in-swift.html\">Getting started with async/await in Swift</a></li>\n  <li><a href=\"https://www.enekoalonso.com/articles/issue-1\">Hello, World! On building an over-engineered blogging solution, for fun!</a></li>\n</ul>\n\n<h2 id=\"swift-on-aws-lambda\">Swift on AWS Lambda</h2>\n<p>Back in May, <a href=\"https://swift.org/blog/aws-lambda-runtime/\">Swift AWS Lambda Runtime</a> package was announced on Swift.org. I was really stoked, since I had been interested in building Lambda functions in Swift for a while, and so far, while doable, the support was limited. With this new package backed by the Swift Server Work Group, everything changed.</p>\n\n<p>Since then, I’ve had the pleasure to work on several projects using AWS Lambda and Swift.</p>\n\n<h2 id=\"wwdc-2020\">WWDC 2020</h2>\n<p>Despite the coronavirus, and despite being online, WWDC was big this year. BigSur and SwiftUI “2.0” looking very promising, and new Apple Silicon!! It was fun month to experiment with Xcode 12 beta, SwiftUI and multi-platform SwiftUI applications for macOS &amp; iOS.</p>\n\n<h2 id=\"carthage-vs-swift-package-manager\">Carthage vs. Swift Package Manager</h2>\n<p>The introduction of ARM processors for macOS caused <a href=\"https://github.com/Carthage/Carthage/issues/3019\">a lot of trouble for Carthage</a>. Swift Package Manager in the other hand, with native support included since Xcode 11, introduced support for embedded resources (<a href=\"https://github.com/apple/swift-evolution/blob/main/proposals/0271-package-manager-resources.md\">SE-0271</a>) and binary framework distribution starting with Swift 5.3.</p>\n\n<h2 id=\"published-open-source\">Published Open Source</h2>\n<p>I released several open-source projects in 2020, here is the list:</p>\n<ul>\n  <li><a href=\"https://github.com/eneko/Blog\">Blog</a> - my new over-engineered blog engine for blogging with GitHub Issues</li>\n  <li><a href=\"https://github.com/eneko/Stripes\">Stripes</a> - configurable SwiftUI stripped background</li>\n  <li><a href=\"https://github.com/eneko/ObjcCrashDemo\">ObjcCrashDemo</a> - to showcase Obj-c interoperability issues with Swift optionals.</li>\n  <li><a href=\"https://github.com/eneko/DateTemplates\">DateTemplates</a> - declarative way for building date templates and no longer worry about <code class=\"language-plaintext highlighter-rouge\">YYYY</code> vs <code class=\"language-plaintext highlighter-rouge\">yyyy</code> and such.</li>\n  <li><a href=\"https://github.com/eneko/dynamodb-demo\">DynamoDB demo</a> - Using DynamoDB from the command line, in Swift</li>\n</ul>\n\n<h2 id=\"open-source-contributions\">Open Source Contributions</h2>\n<p>Own maintained repos:</p>\n<ul>\n  <li><a href=\"https://github.com/mindbody/Conduit/pulls?q=is%3Apr+is%3Aclosed+author%3Aeneko\">Conduit</a></li>\n  <li><a href=\"https://github.com/eneko/SourceDocs/pulls?q=is%3Apr+is%3Aclosed+author%3Aeneko\">SourceDocs</a></li>\n  <li><a href=\"https://github.com/eneko/ProcessRunner/pulls?q=is%3Apr+is%3Aclosed+author%3Aeneko\">ProcessRunner</a></li>\n  <li><a href=\"https://github.com/eneko/MarkdownGenerator/pulls?q=is%3Apr+is%3Aclosed+author%3Aeneko\">MarkdownGenerator</a></li>\n</ul>\n\n<p>Not many contributions to third-party open source repos, to be honest:</p>\n<ul>\n  <li><a href=\"https://github.com/xmartlabs/XLForm/pull/1073\">XLForm</a>, for distribution via Swift Package Manager.</li>\n  <li><a href=\"https://github.com/airbnb/lottie-ios/pulls?q=is%3Apr+is%3Aclosed+author%3Aeneko\">Lottie iOS</a>, minor updates for Swift Package Manager support.</li>\n  <li><a href=\"https://github.com/soto-project/soto-core/pull/408\">Soto for AWS</a>, added support for STS Assume Role operation.</li>\n  <li><a href=\"https://github.com/swagger-api/swagger-ui/pull/6605\">Swagger</a>, some documentation.</li>\n  <li><a href=\"https://github.com/swift-server/swift-aws-lambda-runtime/pulls?q=is%3Apr+is%3Aclosed+author%3Aeneko\">Swift AWS Lambda Runtime</a>, minor documentation.</li>\n</ul>\n\n<h2 id=\"some-github-statistics\">Some GitHub Statistics</h2>\n<p>For 2020, these are some numbers (including both private and public repositories):</p>\n<ul>\n  <li>Submitted ~385 pull requests (the vast majority at work)</li>\n  <li>My most starred repo is <a href=\"https://github.com/eneko/SourceDocs\">SourceDocs</a> with 268 stars</li>\n  <li>Started 11 new (private) projects that didn’t finish, and a couple others that are <em>in progress</em>.</li>\n</ul>\n\n<h2 id=\"amazon-web-services\">Amazon Web Services</h2>\n<p>I’ve been using Amazon Web Services for over a decade. I remember when back in 2009 (or 2010?), <a href=\"https://twitter.com/kwiens\">Kyle Wiens from iFixtit</a> did a talk at Central Coast Code Camp, showcasing how to use EC2 instances behind a load balancer. Back then I had web servers running on Rackspace Cloud, but I was sold on AWS.</p>\n\n<p>This year I did some AWS training and got certified as <a href=\"https://aws.amazon.com/certification/certified-developer-associate/\">AWS Certified Developer - Associate</a>.</p>\n\n<p>It’s been an intensive end of the year, with much training and studying besides day-to-day work.</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/11\">Issue #11</a>)</small></i></p>",
      "summary": "<p>Here are some of the things I did in the tech-sphere on 2020.</p>\n\n<h2 id=\"articles\">Articles</h2>\n<ul>\n  <li><a href=\"https://medium.com/@eneko/solving-sudoku-puzzles-programmatically-with-logic-and-without-brute-force-b4e8b837d796\">Solve sudoku puzzles programmatically without using brute force</a>. It was a pretty fun project to do, as I like doing programming challenges every now and then and this was one that I had pending for a while.</li>\n  <li><a href=\"https://medium.com/@eneko/documenting-swift-packages-with-sourcedocs-3d5f6e110b75\">Documenting Swift Packages with SourceDocs</a>. See <a href=\"https://github.com/eneko/SourceDocs/releases/tag/1.0.0\">SourceDocs 1.0.0</a> for details on new features added.</li>\n  <li><a href=\"https://dev.to/eneko/using-datetemplates-in-swiftui-for-custom-date-formatting-1khn\">Using DateTemplates in SwiftUI for custom date formatting</a></li>\n  <li><a href=\"https://medium.com/@eneko/using-aws-dynamodb-from-a-command-line-swift-application-46d1c4b368df\">Using AWS DynamoDB from a Command Line Swift Application</a></li>\n  <li><a href=\"https://www.enekoalonso.com/2020/12/06/getting-started-with-async-await-in-swift.html\">Getting started with async/await in Swift</a></li>\n  <li><a href=\"https://www.enekoalonso.com/articles/issue-1\">Hello, World! On building an over-engineered blogging solution, for fun!</a></li>\n</ul>\n\n<h2 id=\"swift-on-aws-lambda\">Swift on AWS Lambda</h2>\n<p>Back in May, <a href=\"https://swift.org/blog/aws-lambda-runtime/\">Swift AWS Lambda Runtime</a> package was announced on Swift.org. I was really stoked, since I had been interested in building Lambda functions in Swift for a while, and so far, while doable, the support was limited. With this new package backed by the Swift Server Work Group, everything changed.</p>\n\n<p>Since then, I’ve had the pleasure to work on several projects using AWS Lambda and Swift.</p>\n\n<h2 id=\"wwdc-2020\">WWDC 2020</h2>\n<p>Despite the coronavirus, and despite being online, WWDC was big this year. BigSur and SwiftUI “2.0” looking very promising, and new Apple Silicon!! It was fun month to experiment with Xcode 12 beta, SwiftUI and multi-platform SwiftUI applications for macOS &amp; iOS.</p>\n\n<h2 id=\"carthage-vs-swift-package-manager\">Carthage vs. Swift Package Manager</h2>\n<p>The introduction of ARM processors for macOS caused <a href=\"https://github.com/Carthage/Carthage/issues/3019\">a lot of trouble for Carthage</a>. Swift Package Manager in the other hand, with native support included since Xcode 11, introduced support for embedded resources (<a href=\"https://github.com/apple/swift-evolution/blob/main/proposals/0271-package-manager-resources.md\">SE-0271</a>) and binary framework distribution starting with Swift 5.3.</p>\n\n<h2 id=\"published-open-source\">Published Open Source</h2>\n<p>I released several open-source projects in 2020, here is the list:</p>\n<ul>\n  <li><a href=\"https://github.com/eneko/Blog\">Blog</a> - my new over-engineered blog engine for blogging with GitHub Issues</li>\n  <li><a href=\"https://github.com/eneko/Stripes\">Stripes</a> - configurable SwiftUI stripped background</li>\n  <li><a href=\"https://github.com/eneko/ObjcCrashDemo\">ObjcCrashDemo</a> - to showcase Obj-c interoperability issues with Swift optionals.</li>\n  <li><a href=\"https://github.com/eneko/DateTemplates\">DateTemplates</a> - declarative way for building date templates and no longer worry about <code class=\"language-plaintext highlighter-rouge\">YYYY</code> vs <code class=\"language-plaintext highlighter-rouge\">yyyy</code> and such.</li>\n  <li><a href=\"https://github.com/eneko/dynamodb-demo\">DynamoDB demo</a> - Using DynamoDB from the command line, in Swift</li>\n</ul>\n\n<h2 id=\"open-source-contributions\">Open Source Contributions</h2>\n<p>Own maintained repos:</p>\n<ul>\n  <li><a href=\"https://github.com/mindbody/Conduit/pulls?q=is%3Apr+is%3Aclosed+author%3Aeneko\">Conduit</a></li>\n  <li><a href=\"https://github.com/eneko/SourceDocs/pulls?q=is%3Apr+is%3Aclosed+author%3Aeneko\">SourceDocs</a></li>\n  <li><a href=\"https://github.com/eneko/ProcessRunner/pulls?q=is%3Apr+is%3Aclosed+author%3Aeneko\">ProcessRunner</a></li>\n  <li><a href=\"https://github.com/eneko/MarkdownGenerator/pulls?q=is%3Apr+is%3Aclosed+author%3Aeneko\">MarkdownGenerator</a></li>\n</ul>\n\n<p>Not many contributions to third-party open source repos, to be honest:</p>\n<ul>\n  <li><a href=\"https://github.com/xmartlabs/XLForm/pull/1073\">XLForm</a>, for distribution via Swift Package Manager.</li>\n  <li><a href=\"https://github.com/airbnb/lottie-ios/pulls?q=is%3Apr+is%3Aclosed+author%3Aeneko\">Lottie iOS</a>, minor updates for Swift Package Manager support.</li>\n  <li><a href=\"https://github.com/soto-project/soto-core/pull/408\">Soto for AWS</a>, added support for STS Assume Role operation.</li>\n  <li><a href=\"https://github.com/swagger-api/swagger-ui/pull/6605\">Swagger</a>, some documentation.</li>\n  <li><a href=\"https://github.com/swift-server/swift-aws-lambda-runtime/pulls?q=is%3Apr+is%3Aclosed+author%3Aeneko\">Swift AWS Lambda Runtime</a>, minor documentation.</li>\n</ul>\n\n<h2 id=\"some-github-statistics\">Some GitHub Statistics</h2>\n<p>For 2020, these are some numbers (including both private and public repositories):</p>\n<ul>\n  <li>Submitted ~385 pull requests (the vast majority at work)</li>\n  <li>My most starred repo is <a href=\"https://github.com/eneko/SourceDocs\">SourceDocs</a> with 268 stars</li>\n  <li>Started 11 new (private) projects that didn’t finish, and a couple others that are <em>in progress</em>.</li>\n</ul>\n\n<h2 id=\"amazon-web-services\">Amazon Web Services</h2>\n<p>I’ve been using Amazon Web Services for over a decade. I remember when back in 2009 (or 2010?), <a href=\"https://twitter.com/kwiens\">Kyle Wiens from iFixtit</a> did a talk at Central Coast Code Camp, showcasing how to use EC2 instances behind a load balancer. Back then I had web servers running on Rackspace Cloud, but I was sold on AWS.</p>\n\n<p>This year I did some AWS training and got certified as <a href=\"https://aws.amazon.com/certification/certified-developer-associate/\">AWS Certified Developer - Associate</a>.</p>\n\n<p>It’s been an intensive end of the year, with much training and studying besides day-to-day work.</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/11\">Issue #11</a>)</small></i></p>",
      "date_published": "2020-12-24T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-10",
      "url": "https://www.enekoalonso.com/articles/issue-10",
      "title": "How to quickly type Apple keyboard symbols (⇪⇧⌃⌥⌘) on macOS & iOS",
      "content_html": "<p>There might be better ways to do it, but here is my trick: using system shortcuts.</p>\n\n<p>Here are some of the shortcuts I have, which can be used in most apps on macOS and iOS, thanks to iCloud syncing.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103100498-ac82e500-45c7-11eb-822a-47d0d0e43985.png\" alt=\"Screen Shot 2020-12-24 at 9 02 56 AM\" /></p>\n\n<p>And the table of symbols, for easy copy-pasting:</p>\n\n<ul>\n  <li>Caps Lock: ⇪</li>\n  <li>Shift: ⇧</li>\n  <li>Control (CTRL): ⌃</li>\n  <li>Option (OPT): ⌥</li>\n  <li>Command (CMD): ⌘</li>\n</ul>\n\n<p>Hope you found this helpful!</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/10\">Issue #10</a>)</small></i></p>",
      "summary": "<p>There might be better ways to do it, but here is my trick: using system shortcuts.</p>\n\n<p>Here are some of the shortcuts I have, which can be used in most apps on macOS and iOS, thanks to iCloud syncing.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103100498-ac82e500-45c7-11eb-822a-47d0d0e43985.png\" alt=\"Screen Shot 2020-12-24 at 9 02 56 AM\" /></p>\n\n<p>And the table of symbols, for easy copy-pasting:</p>\n\n<ul>\n  <li>Caps Lock: ⇪</li>\n  <li>Shift: ⇧</li>\n  <li>Control (CTRL): ⌃</li>\n  <li>Option (OPT): ⌥</li>\n  <li>Command (CMD): ⌘</li>\n</ul>\n\n<p>Hope you found this helpful!</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/10\">Issue #10</a>)</small></i></p>",
      "date_published": "2020-12-24T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-9",
      "url": "https://www.enekoalonso.com/articles/issue-9",
      "title": "It works! My over-engineered blog engine is (a)live!",
      "content_html": "<p>If you’ve been following my recent tweets or issues on this my <a href=\"https://github.com/eneko/Blog\">Blog</a> repository, you might be aware that a couple of days ago, I started working on this idea of using GitHub Issues for creating post entries for my <a href=\"https://www.enekoalonso.com\">GitHub Pages Jekyll site</a>.</p>\n\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">I’ve started working on a new event driven, server-less blogging engine for my GitHub Pages blog. <br /><br />100% over-engineered, just for fun.</p>&mdash; Eneko Alonso (@eneko) <a href=\"https://twitter.com/eneko/status/1341249399742029824?ref_src=twsrc%5Etfw\">December 22, 2020</a></blockquote>\n<script async=\"\" src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p>After several hours of super fun work spread over these three days, between bike rides, walks, movies, and other PTO fun, I managed to put together this <em>Frankestein</em> of blogging engine. And this is just the start (or so I believe).</p>\n\n<p>The most important thing is that <strong>it works!</strong></p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103064006-bc6adc80-4567-11eb-974a-4db0b49faca9.gif\" alt=\"itworks\" /></p>\n\n<h2 id=\"current-architecture\">Current Architecture</h2>\n\n<p>As described in my previous articles, I thought of building this using only GitHub Actions. However, I really like working with AWS Services, so this was an opportunity to have some fun and implement a couple of things: an SQS queue, and a Lambda function (in Swift) for processing events.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103064072-f89e3d00-4567-11eb-9e8e-b141da043e02.png\" alt=\"Blog Architecture\" /></p>\n\n<p>If by any chance you find this interesting, and would like to know more details, please <a href=\"https://github.com/eneko/Blog/issues/9\">leave a comment</a> or <a href=\"https://twitter.com/eneko\">ping me on Twitter</a>.</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/9\">Issue #9</a>)</small></i></p>",
      "summary": "<p>If you’ve been following my recent tweets or issues on this my <a href=\"https://github.com/eneko/Blog\">Blog</a> repository, you might be aware that a couple of days ago, I started working on this idea of using GitHub Issues for creating post entries for my <a href=\"https://www.enekoalonso.com\">GitHub Pages Jekyll site</a>.</p>\n\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">I’ve started working on a new event driven, server-less blogging engine for my GitHub Pages blog. <br /><br />100% over-engineered, just for fun.</p>&mdash; Eneko Alonso (@eneko) <a href=\"https://twitter.com/eneko/status/1341249399742029824?ref_src=twsrc%5Etfw\">December 22, 2020</a></blockquote>\n<script async=\"\" src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p>After several hours of super fun work spread over these three days, between bike rides, walks, movies, and other PTO fun, I managed to put together this <em>Frankestein</em> of blogging engine. And this is just the start (or so I believe).</p>\n\n<p>The most important thing is that <strong>it works!</strong></p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103064006-bc6adc80-4567-11eb-974a-4db0b49faca9.gif\" alt=\"itworks\" /></p>\n\n<h2 id=\"current-architecture\">Current Architecture</h2>\n\n<p>As described in my previous articles, I thought of building this using only GitHub Actions. However, I really like working with AWS Services, so this was an opportunity to have some fun and implement a couple of things: an SQS queue, and a Lambda function (in Swift) for processing events.</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103064072-f89e3d00-4567-11eb-9e8e-b141da043e02.png\" alt=\"Blog Architecture\" /></p>\n\n<p>If by any chance you find this interesting, and would like to know more details, please <a href=\"https://github.com/eneko/Blog/issues/9\">leave a comment</a> or <a href=\"https://twitter.com/eneko\">ping me on Twitter</a>.</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/9\">Issue #9</a>)</small></i></p>",
      "date_published": "2020-12-23T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-8",
      "url": "https://www.enekoalonso.com/articles/issue-8",
      "title": "Notes from my AWS training",
      "content_html": "<p>A couple of weeks ago, on December 8-10, I took a three day class for AWS training. Really intensive, but definitely worth it. The week after, I got the AWS Developer Associate certificate 🎉</p>\n\n<p>I took some notes during training that I don’t want to lose, so I decided to write them on a post, for future review and in hopes that they can help someone else. Please beware these notes are pretty scarce and might not make much sense without the presentation slides and videos from the training.</p>\n\n<hr />\n\n<h2 id=\"day-one\">Day One</h2>\n\n<p>AWS offers solutions for IaaS, PaaS and SaaS. Some examples are:</p>\n<ul>\n  <li>IaaS (<a href=\"https://docs.aws.amazon.com/ec2/\">EC2</a>, <a href=\"https://docs.aws.amazon.com/ecs/\">ECS</a>)</li>\n  <li>PaaS (<a href=\"https://docs.aws.amazon.com/dynamodb/\">DynamoDB</a>, <a href=\"https://docs.aws.amazon.com/lambda/\">Lambda</a>)</li>\n  <li>SaaS (<a href=\"https://aws.amazon.com/marketplace/\">AWS Marketplace</a> apps)</li>\n</ul>\n\n<p>On cloud hosting:</p>\n<ul>\n  <li>VMs need a guest OS to run (slow boot times, and resource overhead)</li>\n  <li>Containers need orchestration (non-trivial)</li>\n  <li>Server-less -&gt; 🚀</li>\n</ul>\n\n<p>AWS launched in 2006 with only 3 services: <a href=\"https://docs.aws.amazon.com/ec2\">EC2</a>, <a href=\"https://docs.aws.amazon.com/s3\">S3</a>, and <a href=\"https://docs.aws.amazon.com/sqs\">SQS</a></p>\n\n<p>All services provide an API to perform any tasks.</p>\n<ul>\n  <li><a href=\"https://docs.aws.amazon.com/cli/index.html\">AWS CLI</a> and <a href=\"https://docs.aws.amazon.com/awsconsolehelpdocs/latest/gsg/getting-started.html\">AWS management console</a> both use the REST API</li>\n  <li><strong>Everything</strong> you can do in the AWS console can be done via API</li>\n  <li>API requests must be signed (<a href=\"https://docs.aws.amazon.com/general/latest/gr/signing_aws_api_requests.html\">Signature Version 4</a>)</li>\n</ul>\n\n<h3 id=\"observability\">Observability</h3>\n<ul>\n  <li>Monitoring, logging, tracing</li>\n  <li><a href=\"https://docs.aws.amazon.com/cloudwatch\">CloudWatch</a> -&gt; logs, events</li>\n  <li><a href=\"https://docs.aws.amazon.com/cloudtrail\">CloudTrail</a> -&gt; auditing tool, not real-time</li>\n  <li><a href=\"https://docs.aws.amazon.com/xray\">X-Ray</a> -&gt; service maps, identify performance bottlenecks</li>\n</ul>\n\n<h2 id=\"iam-policies\"><a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction.html\">IAM Policies</a></h2>\n<ul>\n  <li>Only three services support inline policies: S3, SQS, OpsWorks</li>\n  <li>Use managed policies when possible</li>\n  <li>With IAM, everything is <em>deny</em> by default\n    <ol>\n      <li>Explicit deny</li>\n      <li>Explicit allow</li>\n    </ol>\n  </li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_testing-policies.html\">IAM Policy Simulator</a> -&gt; Troubleshooting of permission issues</p>\n\n<p>IAM Role === Identity (cannot have two identities at once)</p>\n\n<p><a href=\"https://docs.aws.amazon.com/aws-support\">Trusted Advisor</a> (support)</p>\n<ul>\n  <li>Save money</li>\n  <li>Security tips</li>\n  <li>Identify security risks</li>\n</ul>\n\n<p>Identities:</p>\n<ul>\n  <li>User</li>\n  <li>Role</li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/STS/latest/APIReference/API_GetSessionToken.html\"><code class=\"language-plaintext highlighter-rouge\">GetSessionToken</code></a> API call for MFA (multi-factor authentication)</p>\n\n<p><a href=\"https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html\">STS AssumeRole</a> operation -&gt; no MFA</p>\n\n<h2 id=\"s3\"><a href=\"https://docs.aws.amazon.com/s3\">S3</a></h2>\n<ul>\n  <li>11 nines -&gt; durability</li>\n  <li>4 nines -&gt; availability</li>\n  <li>S3 is an object store (not files)</li>\n  <li>Bucket names must be globally unique, always lowercase\n    <ul>\n      <li>1024 characters max</li>\n      <li>Must be DNS compatible</li>\n    </ul>\n  </li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/ObjectVersioning.html\">S3 versioning</a>:</p>\n<ul>\n  <li>Must delete all versions one by one</li>\n  <li>Deleting a file inserts a “delete mark”</li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/s3-glacier-select-sql-reference-select.html\">S3 select</a>:</p>\n<ul>\n  <li>individual document basis</li>\n  <li>query data inside documents (eg. JSON documents)</li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/athena/latest/ug/what-is.html\">Athena</a> -&gt; cross-document queries with actual SQL statements</p>\n\n<p><a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/PresignedUrlUploadObject.html\">S3 pre-signed urls</a></p>\n<ul>\n  <li>avoid leechers</li>\n  <li>temporary urls that expire after a threshold</li>\n</ul>\n\n<hr />\n\n<h2 id=\"day-two\">Day Two</h2>\n\n<p><a href=\"https://docs.aws.amazon.com/neptune/latest/userguide/intro.html\">Neptune</a> -&gt; Graph database</p>\n\n<p><a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/CHAP_AuroraOverview.html\">Aurora</a> -&gt; Serverless relational database (MySQL or Postgres)</p>\n\n<h3 id=\"dynamodb\"><a href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Introduction.html\">DynamoDB</a></h3>\n<ul>\n  <li>Partitions up to 10GB</li>\n  <li>Primary Key -&gt; Partition Key + Sort Key (optional)</li>\n  <li>400Kb per item max, including attribute names</li>\n  <li>Throughput is divided among partitions</li>\n  <li>5 max Local Secondary Indexes (LSI) before table creation</li>\n  <li>20 max Global Secondary Indexes (GSI) -&gt; new PK/SK, can be added at any time</li>\n  <li>Sparse index: when GSI PK does not exist on an item in the table</li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/streamsmain.html\">DynamoDB Streams</a></p>\n<ul>\n  <li>DynamoDB Streams -&gt; S3 (JSON)</li>\n  <li>DynamoDB Streams -&gt; SNS</li>\n  <li>DynamoDB Streams -&gt; Lambda</li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GlobalTables.html\">Global tables</a> -&gt; multi-master arrangement</p>\n\n<p><a href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/transactions.html\">DynamoDB Transactions</a></p>\n<ul>\n  <li>10 items max</li>\n  <li>4MB max</li>\n</ul>\n\n<p>Batch -&gt; 16MB</p>\n\n<p><a href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DAX.html\">DynamoDB Accelerator (DAX)</a></p>\n<ul>\n  <li>write-through cache (latency)</li>\n  <li>write around for heavy write applications</li>\n</ul>\n\n<h3 id=\"aws-secrets-manager\"><a href=\"https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html\">AWS Secrets Manager</a></h3>\n<ul>\n  <li>key/value store</li>\n  <li>rotate secrets</li>\n</ul>\n\n<h3 id=\"aws-lambda\"><a href=\"https://docs.aws.amazon.com/lambda/latest/dg/welcome.html\">AWS Lambda</a></h3>\n<ul>\n  <li>Max duration: 15 min</li>\n  <li>Lambda Service (managed)\n    <ul>\n      <li>poll for events</li>\n      <li>pull invokation</li>\n    </ul>\n  </li>\n  <li>Reserved concurrency\n    <ul>\n      <li>limit number of concurrent invocations</li>\n      <li>max concurrent invocations</li>\n    </ul>\n  </li>\n  <li>Provisioned concurrency\n    <ul>\n      <li>warm lambda instances</li>\n      <li>avoid cold starts</li>\n      <li>runs continuously</li>\n    </ul>\n  </li>\n  <li>Canary deploys with aliases and versions\n    <ul>\n      <li>1% - 99%, 10% - 90%, etc</li>\n    </ul>\n  </li>\n  <li>Lambda destination for async invocations: success / failure</li>\n  <li>Initial burst: 500-3000 cus\n    <ul>\n      <li>+500/minute afterwards</li>\n      <li>1000 cus max/region by default</li>\n    </ul>\n  </li>\n</ul>\n\n<h3 id=\"salad\">SALAD</h3>\n<p>Remember LAMP (Linux, Apache, MySQL, and PHP)?</p>\n\n<p>SALAD is the new stack:</p>\n<ul>\n  <li>S3</li>\n  <li>API Gateway</li>\n  <li>Lambda</li>\n  <li>?</li>\n  <li>DynamoDB</li>\n</ul>\n\n<h3 id=\"api-gateway-rest\"><a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-rest-api.html\">API Gateway (REST)</a></h3>\n<ul>\n  <li>Sell API keys on AWS marketplace</li>\n  <li>10k requests/sec</li>\n  <li>Throttle + daily quotes</li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/cloudformation/?id=docs_gateway\">Cloud Formation</a> -&gt; Infrastructure as code</p>\n\n<h3 id=\"sqs\"><a href=\"https://docs.aws.amazon.com/sqs\">SQS</a></h3>\n<ul>\n  <li>Idempotence -&gt; write consumers for no issues if duplicate messages are received</li>\n  <li>14 days max time for messages to stay in queue</li>\n  <li>SQS -&gt; 1:1 only one consumer can get a message</li>\n  <li>Dead Letter Queue (DQL) for failed messages</li>\n  <li>SQS FIFO -&gt; MessageDeduplicationId + SendMsg</li>\n  <li>When using Lambda consumers, polling is handled by Lambda Service</li>\n</ul>\n\n<h3 id=\"sns\"><a href=\"https://docs.aws.amazon.com/sns\">SNS</a></h3>\n<ul>\n  <li>1:N multiple subscribers per topic</li>\n  <li>Retry policy</li>\n  <li>SNS filters -&gt; avoid invocations</li>\n  <li>Order of messages is not guaranteed</li>\n  <li>FIFO supported on SNS since Dec 2020 re:Invent</li>\n  <li>No persistence</li>\n  <li>256Kb max per message</li>\n</ul>\n\n<p>Use SNS to <em>fanout</em>:</p>\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>                                      ┌───────────┐       ┌───────────┐\n                                      │           │       │           │\n                                 ┌───▶│    SQS    │──────▶│Consumer A │\n┌───────────┐   ┌───────────┐    │    │           │       │           │\n│           │   │           │    │    └───────────┘       └───────────┘\n│ Producer  │──▶│    SNS    │────┤                                     \n│           │   │           │    │    ┌───────────┐       ┌───────────┐\n└───────────┘   └───────────┘    │    │           │       │           │\n                                 └───▶│    SQS    │──────▶│Consumer B │\n                                      │           │       │           │\n                                      └───────────┘       └───────────┘\n</code></pre></div></div>\n\n<h3 id=\"amazon-mq\"><a href=\"https://docs.aws.amazon.com/amazon-mq\">Amazon MQ</a></h3>\n<ul>\n  <li>Runs Apache MQ</li>\n  <li>Managed service</li>\n  <li>MQTT for IoT\n    <ul>\n      <li>AWS IoT Broker message -&gt; MQTT</li>\n    </ul>\n  </li>\n</ul>\n\n<h3 id=\"step-functions\"><a href=\"https://docs.aws.amazon.com/step-functions/latest/dg/welcome.html\">Step Functions</a></h3>\n<ul>\n  <li>Allow for manual approval steps</li>\n  <li>State saved for one year max</li>\n</ul>\n\n<h3 id=\"elasticache\">ElastiCache</h3>\n<ul>\n  <li><a href=\"https://docs.aws.amazon.com/AmazonElastiCache/latest/mem-ug/index.html\">Memcached</a>: multi-threaded, single availability zone</li>\n  <li><a href=\"https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/index.html\">Redis</a>: multi-az</li>\n</ul>\n\n<h3 id=\"containers\">Containers</h3>\n<ul>\n  <li>Docker: only one process per container</li>\n  <li>Container = runtime engine + dependencies + code + configuration</li>\n  <li><a href=\"https://docs.aws.amazon.com/AmazonECR/latest/userguide/what-is-ecr.html\">ECR</a>\n    <ul>\n      <li>Public images since Dec 2020</li>\n      <li>Integrated with Docker CLI</li>\n      <li>ECR ~= Docker Hub</li>\n    </ul>\n  </li>\n</ul>\n\n<h3 id=\"container-orchestration\">Container Orchestration</h3>\n<ul>\n  <li><a href=\"https://docs.aws.amazon.com/eks/latest/userguide/index.html\">Kubernetes</a> &amp; <a href=\"https://docs.aws.amazon.com/AmazonECS/latest/developerguide/index.html\">ECS</a></li>\n  <li>Provide them with a fleet of EC2 instances</li>\n</ul>\n\n<p>Container -&gt; Task (auto-scaling) -&gt; ECS -&gt; EC2 instance (auto-scaling)</p>\n\n<h3 id=\"aws-fargate\"><a href=\"https://docs.aws.amazon.com/AmazonECS/latest/userguide/what-is-fargate.html\">AWS Fargate</a></h3>\n<ul>\n  <li>Forget about managing EC2 instances.</li>\n  <li>No choice of instance type</li>\n  <li>No ssh into EC2 instance</li>\n  <li>Server-less provision of containers</li>\n</ul>\n\n<h3 id=\"eks\"><a href=\"https://docs.aws.amazon.com/eks/latest/userguide/index.html\">EKS</a></h3>\n<ul>\n  <li>Elastic Kubernetes Cluster</li>\n</ul>\n\n<hr />\n\n<h2 id=\"day-three\">Day Three</h2>\n\n<h3 id=\"cloud-9\"><a href=\"https://docs.aws.amazon.com/cloud9/latest/user-guide/index.html\">Cloud 9</a></h3>\n<p>Web based editor</p>\n\n<h3 id=\"aws-certificate-manager\"><a href=\"https://docs.aws.amazon.com/acm/latest/userguide/acm-overview.html\">AWS Certificate Manager</a></h3>\n<ul>\n  <li>SSL, TLS certificates</li>\n</ul>\n\n<h3 id=\"aws-secrets-manager-1\"><a href=\"https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html\">AWS Secrets Manager</a></h3>\n<ul>\n  <li>store keys, passwords</li>\n  <li>manage and rotate</li>\n</ul>\n\n<h3 id=\"aws-secure-token-service-sts\"><a href=\"https://docs.aws.amazon.com/STS/latest/APIReference/welcome.html\">AWS Secure Token Service (STS)</a></h3>\n<ul>\n  <li>Assume role via broker to authenticate</li>\n  <li>Assume role with SAML</li>\n  <li>Assume role with JWT</li>\n</ul>\n\n<h3 id=\"aws-cognito-user-pool\"><a href=\"https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-identity-pools.html\">AWS Cognito User Pool</a></h3>\n<ul>\n  <li>Hosted web-ui for login, signup, change password, etc</li>\n  <li>User dierectory</li>\n  <li>User profiles</li>\n  <li>User groups</li>\n  <li>MFA</li>\n  <li>Trusted Identity Providers</li>\n  <li>Login with user/pwd -&gt; JWT</li>\n  <li>Login with SAML -&gt; JWT</li>\n  <li>Login with OpenID -&gt; JWT</li>\n  <li>No IAM roles</li>\n</ul>\n\n<h3 id=\"aws-cognito-identity-pool\"><a href=\"https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-identity.html\">AWS Cognito Identity Pool</a></h3>\n<ul>\n  <li>Identity federation (identity pool == federated identities)</li>\n  <li>Support for anonymous login</li>\n  <li>Storage for each identity (profile state)</li>\n  <li>STS -&gt; IAM credentials</li>\n  <li>Social IDP (OpenID) -&gt; JWT</li>\n  <li>SAML -&gt; JWT</li>\n  <li>JWT (from user pool)</li>\n</ul>\n\n<p>=&gt; Use Cognito User Pool JWT auth token to authenticate against Cognito Identity Pool</p>\n\n<p>User Pool -&gt; Identity Pool -&gt; IAM Assume Role</p>\n\n<h3 id=\"deployments\">Deployments</h3>\n<ul>\n  <li>Black/Red: 0 -&gt; 100% (all or nothing)</li>\n  <li>Blue/Green: 20% green, 80% blue\n    <ul>\n      <li>Canary deployments</li>\n      <li>Linear increments</li>\n    </ul>\n  </li>\n</ul>\n\n<h3 id=\"elastic-beanstalk\"><a href=\"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/index.html\">Elastic Beanstalk</a></h3>\n<ul>\n  <li>Deploy code</li>\n  <li>Provisions infrastructure for you</li>\n  <li>Uses Cloud Formation</li>\n</ul>\n\n<h3 id=\"codestar\"><a href=\"https://docs.aws.amazon.com/codestar/latest/userguide/welcome.html\">CodeStar</a></h3>\n<ul>\n  <li>Wizard to build pipeline</li>\n</ul>\n\n<h3 id=\"amazon-polly\"><a href=\"https://docs.aws.amazon.com/polly/latest/dg/what-is.html\">Amazon Polly</a></h3>\n<ul>\n  <li>Text-to-speech</li>\n</ul>\n\n<hr />\n\n<p>And that is it. As mentioned, not the best notes ever, but better than nothing :)</p>\n\n<h3 id=\"update-dec-30-2020\">Update (Dec 30, 2020)</h3>\n<p>I’ve updated the notes above adding links to service documentation where relevant.</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/8\">Issue #8</a>)</small></i></p>",
      "summary": "<p>A couple of weeks ago, on December 8-10, I took a three day class for AWS training. Really intensive, but definitely worth it. The week after, I got the AWS Developer Associate certificate 🎉</p>\n\n<p>I took some notes during training that I don’t want to lose, so I decided to write them on a post, for future review and in hopes that they can help someone else. Please beware these notes are pretty scarce and might not make much sense without the presentation slides and videos from the training.</p>\n\n<hr />\n\n<h2 id=\"day-one\">Day One</h2>\n\n<p>AWS offers solutions for IaaS, PaaS and SaaS. Some examples are:</p>\n<ul>\n  <li>IaaS (<a href=\"https://docs.aws.amazon.com/ec2/\">EC2</a>, <a href=\"https://docs.aws.amazon.com/ecs/\">ECS</a>)</li>\n  <li>PaaS (<a href=\"https://docs.aws.amazon.com/dynamodb/\">DynamoDB</a>, <a href=\"https://docs.aws.amazon.com/lambda/\">Lambda</a>)</li>\n  <li>SaaS (<a href=\"https://aws.amazon.com/marketplace/\">AWS Marketplace</a> apps)</li>\n</ul>\n\n<p>On cloud hosting:</p>\n<ul>\n  <li>VMs need a guest OS to run (slow boot times, and resource overhead)</li>\n  <li>Containers need orchestration (non-trivial)</li>\n  <li>Server-less -&gt; 🚀</li>\n</ul>\n\n<p>AWS launched in 2006 with only 3 services: <a href=\"https://docs.aws.amazon.com/ec2\">EC2</a>, <a href=\"https://docs.aws.amazon.com/s3\">S3</a>, and <a href=\"https://docs.aws.amazon.com/sqs\">SQS</a></p>\n\n<p>All services provide an API to perform any tasks.</p>\n<ul>\n  <li><a href=\"https://docs.aws.amazon.com/cli/index.html\">AWS CLI</a> and <a href=\"https://docs.aws.amazon.com/awsconsolehelpdocs/latest/gsg/getting-started.html\">AWS management console</a> both use the REST API</li>\n  <li><strong>Everything</strong> you can do in the AWS console can be done via API</li>\n  <li>API requests must be signed (<a href=\"https://docs.aws.amazon.com/general/latest/gr/signing_aws_api_requests.html\">Signature Version 4</a>)</li>\n</ul>\n\n<h3 id=\"observability\">Observability</h3>\n<ul>\n  <li>Monitoring, logging, tracing</li>\n  <li><a href=\"https://docs.aws.amazon.com/cloudwatch\">CloudWatch</a> -&gt; logs, events</li>\n  <li><a href=\"https://docs.aws.amazon.com/cloudtrail\">CloudTrail</a> -&gt; auditing tool, not real-time</li>\n  <li><a href=\"https://docs.aws.amazon.com/xray\">X-Ray</a> -&gt; service maps, identify performance bottlenecks</li>\n</ul>\n\n<h2 id=\"iam-policies\"><a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction.html\">IAM Policies</a></h2>\n<ul>\n  <li>Only three services support inline policies: S3, SQS, OpsWorks</li>\n  <li>Use managed policies when possible</li>\n  <li>With IAM, everything is <em>deny</em> by default\n    <ol>\n      <li>Explicit deny</li>\n      <li>Explicit allow</li>\n    </ol>\n  </li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_testing-policies.html\">IAM Policy Simulator</a> -&gt; Troubleshooting of permission issues</p>\n\n<p>IAM Role === Identity (cannot have two identities at once)</p>\n\n<p><a href=\"https://docs.aws.amazon.com/aws-support\">Trusted Advisor</a> (support)</p>\n<ul>\n  <li>Save money</li>\n  <li>Security tips</li>\n  <li>Identify security risks</li>\n</ul>\n\n<p>Identities:</p>\n<ul>\n  <li>User</li>\n  <li>Role</li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/STS/latest/APIReference/API_GetSessionToken.html\"><code class=\"language-plaintext highlighter-rouge\">GetSessionToken</code></a> API call for MFA (multi-factor authentication)</p>\n\n<p><a href=\"https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html\">STS AssumeRole</a> operation -&gt; no MFA</p>\n\n<h2 id=\"s3\"><a href=\"https://docs.aws.amazon.com/s3\">S3</a></h2>\n<ul>\n  <li>11 nines -&gt; durability</li>\n  <li>4 nines -&gt; availability</li>\n  <li>S3 is an object store (not files)</li>\n  <li>Bucket names must be globally unique, always lowercase\n    <ul>\n      <li>1024 characters max</li>\n      <li>Must be DNS compatible</li>\n    </ul>\n  </li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/ObjectVersioning.html\">S3 versioning</a>:</p>\n<ul>\n  <li>Must delete all versions one by one</li>\n  <li>Deleting a file inserts a “delete mark”</li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/s3-glacier-select-sql-reference-select.html\">S3 select</a>:</p>\n<ul>\n  <li>individual document basis</li>\n  <li>query data inside documents (eg. JSON documents)</li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/athena/latest/ug/what-is.html\">Athena</a> -&gt; cross-document queries with actual SQL statements</p>\n\n<p><a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/PresignedUrlUploadObject.html\">S3 pre-signed urls</a></p>\n<ul>\n  <li>avoid leechers</li>\n  <li>temporary urls that expire after a threshold</li>\n</ul>\n\n<hr />\n\n<h2 id=\"day-two\">Day Two</h2>\n\n<p><a href=\"https://docs.aws.amazon.com/neptune/latest/userguide/intro.html\">Neptune</a> -&gt; Graph database</p>\n\n<p><a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/CHAP_AuroraOverview.html\">Aurora</a> -&gt; Serverless relational database (MySQL or Postgres)</p>\n\n<h3 id=\"dynamodb\"><a href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Introduction.html\">DynamoDB</a></h3>\n<ul>\n  <li>Partitions up to 10GB</li>\n  <li>Primary Key -&gt; Partition Key + Sort Key (optional)</li>\n  <li>400Kb per item max, including attribute names</li>\n  <li>Throughput is divided among partitions</li>\n  <li>5 max Local Secondary Indexes (LSI) before table creation</li>\n  <li>20 max Global Secondary Indexes (GSI) -&gt; new PK/SK, can be added at any time</li>\n  <li>Sparse index: when GSI PK does not exist on an item in the table</li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/streamsmain.html\">DynamoDB Streams</a></p>\n<ul>\n  <li>DynamoDB Streams -&gt; S3 (JSON)</li>\n  <li>DynamoDB Streams -&gt; SNS</li>\n  <li>DynamoDB Streams -&gt; Lambda</li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GlobalTables.html\">Global tables</a> -&gt; multi-master arrangement</p>\n\n<p><a href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/transactions.html\">DynamoDB Transactions</a></p>\n<ul>\n  <li>10 items max</li>\n  <li>4MB max</li>\n</ul>\n\n<p>Batch -&gt; 16MB</p>\n\n<p><a href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DAX.html\">DynamoDB Accelerator (DAX)</a></p>\n<ul>\n  <li>write-through cache (latency)</li>\n  <li>write around for heavy write applications</li>\n</ul>\n\n<h3 id=\"aws-secrets-manager\"><a href=\"https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html\">AWS Secrets Manager</a></h3>\n<ul>\n  <li>key/value store</li>\n  <li>rotate secrets</li>\n</ul>\n\n<h3 id=\"aws-lambda\"><a href=\"https://docs.aws.amazon.com/lambda/latest/dg/welcome.html\">AWS Lambda</a></h3>\n<ul>\n  <li>Max duration: 15 min</li>\n  <li>Lambda Service (managed)\n    <ul>\n      <li>poll for events</li>\n      <li>pull invokation</li>\n    </ul>\n  </li>\n  <li>Reserved concurrency\n    <ul>\n      <li>limit number of concurrent invocations</li>\n      <li>max concurrent invocations</li>\n    </ul>\n  </li>\n  <li>Provisioned concurrency\n    <ul>\n      <li>warm lambda instances</li>\n      <li>avoid cold starts</li>\n      <li>runs continuously</li>\n    </ul>\n  </li>\n  <li>Canary deploys with aliases and versions\n    <ul>\n      <li>1% - 99%, 10% - 90%, etc</li>\n    </ul>\n  </li>\n  <li>Lambda destination for async invocations: success / failure</li>\n  <li>Initial burst: 500-3000 cus\n    <ul>\n      <li>+500/minute afterwards</li>\n      <li>1000 cus max/region by default</li>\n    </ul>\n  </li>\n</ul>\n\n<h3 id=\"salad\">SALAD</h3>\n<p>Remember LAMP (Linux, Apache, MySQL, and PHP)?</p>\n\n<p>SALAD is the new stack:</p>\n<ul>\n  <li>S3</li>\n  <li>API Gateway</li>\n  <li>Lambda</li>\n  <li>?</li>\n  <li>DynamoDB</li>\n</ul>\n\n<h3 id=\"api-gateway-rest\"><a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-rest-api.html\">API Gateway (REST)</a></h3>\n<ul>\n  <li>Sell API keys on AWS marketplace</li>\n  <li>10k requests/sec</li>\n  <li>Throttle + daily quotes</li>\n</ul>\n\n<p><a href=\"https://docs.aws.amazon.com/cloudformation/?id=docs_gateway\">Cloud Formation</a> -&gt; Infrastructure as code</p>\n\n<h3 id=\"sqs\"><a href=\"https://docs.aws.amazon.com/sqs\">SQS</a></h3>\n<ul>\n  <li>Idempotence -&gt; write consumers for no issues if duplicate messages are received</li>\n  <li>14 days max time for messages to stay in queue</li>\n  <li>SQS -&gt; 1:1 only one consumer can get a message</li>\n  <li>Dead Letter Queue (DQL) for failed messages</li>\n  <li>SQS FIFO -&gt; MessageDeduplicationId + SendMsg</li>\n  <li>When using Lambda consumers, polling is handled by Lambda Service</li>\n</ul>\n\n<h3 id=\"sns\"><a href=\"https://docs.aws.amazon.com/sns\">SNS</a></h3>\n<ul>\n  <li>1:N multiple subscribers per topic</li>\n  <li>Retry policy</li>\n  <li>SNS filters -&gt; avoid invocations</li>\n  <li>Order of messages is not guaranteed</li>\n  <li>FIFO supported on SNS since Dec 2020 re:Invent</li>\n  <li>No persistence</li>\n  <li>256Kb max per message</li>\n</ul>\n\n<p>Use SNS to <em>fanout</em>:</p>\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>                                      ┌───────────┐       ┌───────────┐\n                                      │           │       │           │\n                                 ┌───▶│    SQS    │──────▶│Consumer A │\n┌───────────┐   ┌───────────┐    │    │           │       │           │\n│           │   │           │    │    └───────────┘       └───────────┘\n│ Producer  │──▶│    SNS    │────┤                                     \n│           │   │           │    │    ┌───────────┐       ┌───────────┐\n└───────────┘   └───────────┘    │    │           │       │           │\n                                 └───▶│    SQS    │──────▶│Consumer B │\n                                      │           │       │           │\n                                      └───────────┘       └───────────┘\n</code></pre></div></div>\n\n<h3 id=\"amazon-mq\"><a href=\"https://docs.aws.amazon.com/amazon-mq\">Amazon MQ</a></h3>\n<ul>\n  <li>Runs Apache MQ</li>\n  <li>Managed service</li>\n  <li>MQTT for IoT\n    <ul>\n      <li>AWS IoT Broker message -&gt; MQTT</li>\n    </ul>\n  </li>\n</ul>\n\n<h3 id=\"step-functions\"><a href=\"https://docs.aws.amazon.com/step-functions/latest/dg/welcome.html\">Step Functions</a></h3>\n<ul>\n  <li>Allow for manual approval steps</li>\n  <li>State saved for one year max</li>\n</ul>\n\n<h3 id=\"elasticache\">ElastiCache</h3>\n<ul>\n  <li><a href=\"https://docs.aws.amazon.com/AmazonElastiCache/latest/mem-ug/index.html\">Memcached</a>: multi-threaded, single availability zone</li>\n  <li><a href=\"https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/index.html\">Redis</a>: multi-az</li>\n</ul>\n\n<h3 id=\"containers\">Containers</h3>\n<ul>\n  <li>Docker: only one process per container</li>\n  <li>Container = runtime engine + dependencies + code + configuration</li>\n  <li><a href=\"https://docs.aws.amazon.com/AmazonECR/latest/userguide/what-is-ecr.html\">ECR</a>\n    <ul>\n      <li>Public images since Dec 2020</li>\n      <li>Integrated with Docker CLI</li>\n      <li>ECR ~= Docker Hub</li>\n    </ul>\n  </li>\n</ul>\n\n<h3 id=\"container-orchestration\">Container Orchestration</h3>\n<ul>\n  <li><a href=\"https://docs.aws.amazon.com/eks/latest/userguide/index.html\">Kubernetes</a> &amp; <a href=\"https://docs.aws.amazon.com/AmazonECS/latest/developerguide/index.html\">ECS</a></li>\n  <li>Provide them with a fleet of EC2 instances</li>\n</ul>\n\n<p>Container -&gt; Task (auto-scaling) -&gt; ECS -&gt; EC2 instance (auto-scaling)</p>\n\n<h3 id=\"aws-fargate\"><a href=\"https://docs.aws.amazon.com/AmazonECS/latest/userguide/what-is-fargate.html\">AWS Fargate</a></h3>\n<ul>\n  <li>Forget about managing EC2 instances.</li>\n  <li>No choice of instance type</li>\n  <li>No ssh into EC2 instance</li>\n  <li>Server-less provision of containers</li>\n</ul>\n\n<h3 id=\"eks\"><a href=\"https://docs.aws.amazon.com/eks/latest/userguide/index.html\">EKS</a></h3>\n<ul>\n  <li>Elastic Kubernetes Cluster</li>\n</ul>\n\n<hr />\n\n<h2 id=\"day-three\">Day Three</h2>\n\n<h3 id=\"cloud-9\"><a href=\"https://docs.aws.amazon.com/cloud9/latest/user-guide/index.html\">Cloud 9</a></h3>\n<p>Web based editor</p>\n\n<h3 id=\"aws-certificate-manager\"><a href=\"https://docs.aws.amazon.com/acm/latest/userguide/acm-overview.html\">AWS Certificate Manager</a></h3>\n<ul>\n  <li>SSL, TLS certificates</li>\n</ul>\n\n<h3 id=\"aws-secrets-manager-1\"><a href=\"https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html\">AWS Secrets Manager</a></h3>\n<ul>\n  <li>store keys, passwords</li>\n  <li>manage and rotate</li>\n</ul>\n\n<h3 id=\"aws-secure-token-service-sts\"><a href=\"https://docs.aws.amazon.com/STS/latest/APIReference/welcome.html\">AWS Secure Token Service (STS)</a></h3>\n<ul>\n  <li>Assume role via broker to authenticate</li>\n  <li>Assume role with SAML</li>\n  <li>Assume role with JWT</li>\n</ul>\n\n<h3 id=\"aws-cognito-user-pool\"><a href=\"https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-identity-pools.html\">AWS Cognito User Pool</a></h3>\n<ul>\n  <li>Hosted web-ui for login, signup, change password, etc</li>\n  <li>User dierectory</li>\n  <li>User profiles</li>\n  <li>User groups</li>\n  <li>MFA</li>\n  <li>Trusted Identity Providers</li>\n  <li>Login with user/pwd -&gt; JWT</li>\n  <li>Login with SAML -&gt; JWT</li>\n  <li>Login with OpenID -&gt; JWT</li>\n  <li>No IAM roles</li>\n</ul>\n\n<h3 id=\"aws-cognito-identity-pool\"><a href=\"https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-identity.html\">AWS Cognito Identity Pool</a></h3>\n<ul>\n  <li>Identity federation (identity pool == federated identities)</li>\n  <li>Support for anonymous login</li>\n  <li>Storage for each identity (profile state)</li>\n  <li>STS -&gt; IAM credentials</li>\n  <li>Social IDP (OpenID) -&gt; JWT</li>\n  <li>SAML -&gt; JWT</li>\n  <li>JWT (from user pool)</li>\n</ul>\n\n<p>=&gt; Use Cognito User Pool JWT auth token to authenticate against Cognito Identity Pool</p>\n\n<p>User Pool -&gt; Identity Pool -&gt; IAM Assume Role</p>\n\n<h3 id=\"deployments\">Deployments</h3>\n<ul>\n  <li>Black/Red: 0 -&gt; 100% (all or nothing)</li>\n  <li>Blue/Green: 20% green, 80% blue\n    <ul>\n      <li>Canary deployments</li>\n      <li>Linear increments</li>\n    </ul>\n  </li>\n</ul>\n\n<h3 id=\"elastic-beanstalk\"><a href=\"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/index.html\">Elastic Beanstalk</a></h3>\n<ul>\n  <li>Deploy code</li>\n  <li>Provisions infrastructure for you</li>\n  <li>Uses Cloud Formation</li>\n</ul>\n\n<h3 id=\"codestar\"><a href=\"https://docs.aws.amazon.com/codestar/latest/userguide/welcome.html\">CodeStar</a></h3>\n<ul>\n  <li>Wizard to build pipeline</li>\n</ul>\n\n<h3 id=\"amazon-polly\"><a href=\"https://docs.aws.amazon.com/polly/latest/dg/what-is.html\">Amazon Polly</a></h3>\n<ul>\n  <li>Text-to-speech</li>\n</ul>\n\n<hr />\n\n<p>And that is it. As mentioned, not the best notes ever, but better than nothing :)</p>\n\n<h3 id=\"update-dec-30-2020\">Update (Dec 30, 2020)</h3>\n<p>I’ve updated the notes above adding links to service documentation where relevant.</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/8\">Issue #8</a>)</small></i></p>",
      "date_published": "2020-12-23T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-7",
      "url": "https://www.enekoalonso.com/articles/issue-7",
      "title": "Blog Engine - Triggering a GitHub Actions workflow via REST API",
      "content_html": "<p>So, as the title says, here is my plan for getting my GitHub Pages site updated: trigger a workflow from Lambda, and have the workflow pull the new updates (either from a remote repo in CodeCommit, an S3 bucket, or maybe an API Gateway). For this last part, I’ll probably use <a href=\"https://github.com/marketplace/actions/github-push\">GitHub Push</a>, or a similar action, to commit and push the changes to the GitHub Pages repo.</p>\n\n<h2 id=\"manually-triggering-a-github-actions-workflow\">Manually triggering a GitHub Actions workflow</h2>\n\n<p>Using <a href=\"https://docs.github.com/en/free-pro-team@latest/actions/reference/events-that-trigger-workflows#workflow_dispatch\"><code class=\"language-plaintext highlighter-rouge\">on: workflow_dispatch</code></a> we can manually trigger a workflow, either from the GitHub site, or via REST API. We can also provide input values, which is perfect for my plan: publish a new post or update an existing one.</p>\n\n<blockquote>\n  <p>You can manually trigger a workflow run using the GitHub API and from GitHub. For more information, see “<a href=\"https://docs.github.com/en/free-pro-team@latest/actions/managing-workflow-runs/manually-running-a-workflow\">Manually running a workflow.</a>”\n[…]\nTo trigger the custom workflow_dispatch webhook event using the REST API, you must send a POST request to a GitHub API endpoint and provide the ref and any required inputs. For more information, see the “<a href=\"https://docs.github.com/en/free-pro-team@latest/rest/reference/actions/#create-a-workflow-dispatch-event\">Create a workflow dispatch event</a>” REST API endpoint.</p>\n</blockquote>\n\n<p>To test this, I’ve added the example workflow from the documentation to my GitHub Pages repo.</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Manually triggered workflow</span>\n<span class=\"na\">on</span><span class=\"pi\">:</span>\n  <span class=\"na\">workflow_dispatch</span><span class=\"pi\">:</span>\n    <span class=\"na\">inputs</span><span class=\"pi\">:</span>\n      <span class=\"na\">name</span><span class=\"pi\">:</span>\n        <span class=\"na\">description</span><span class=\"pi\">:</span> <span class=\"s1\">'</span><span class=\"s\">Person</span><span class=\"nv\"> </span><span class=\"s\">to</span><span class=\"nv\"> </span><span class=\"s\">greet'</span>\n        <span class=\"na\">required</span><span class=\"pi\">:</span> <span class=\"no\">true</span>\n        <span class=\"na\">default</span><span class=\"pi\">:</span> <span class=\"s1\">'</span><span class=\"s\">Mona</span><span class=\"nv\"> </span><span class=\"s\">the</span><span class=\"nv\"> </span><span class=\"s\">Octocat'</span>\n      <span class=\"na\">home</span><span class=\"pi\">:</span>\n        <span class=\"na\">description</span><span class=\"pi\">:</span> <span class=\"s1\">'</span><span class=\"s\">location'</span>\n        <span class=\"na\">required</span><span class=\"pi\">:</span> <span class=\"no\">false</span>\n        <span class=\"na\">default</span><span class=\"pi\">:</span> <span class=\"s1\">'</span><span class=\"s\">The</span><span class=\"nv\"> </span><span class=\"s\">Octoverse'</span>\n\n<span class=\"na\">jobs</span><span class=\"pi\">:</span>\n  <span class=\"na\">say_hello</span><span class=\"pi\">:</span>\n    <span class=\"na\">runs-on</span><span class=\"pi\">:</span> <span class=\"s\">ubuntu-latest</span>\n    <span class=\"na\">steps</span><span class=\"pi\">:</span>\n    <span class=\"pi\">-</span> <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"pi\">|</span>\n        <span class=\"s\">echo \"Hello $!\"</span>\n        <span class=\"s\">echo \"- in $!\"</span>\n</code></pre></div></div>\n\n<h3 id=\"trigger-from-github-console\">Trigger from GitHub console</h3>\n\n<p>Input parameters can be defined when running the workflow from the GitHub console:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103031646-17beaf80-4513-11eb-947f-db581101eb7b.png\" alt=\"Screen Shot 2020-12-23 at 11 35 52 AM\" /></p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103031742-43da3080-4513-11eb-9a7a-83fbc31b84c6.png\" alt=\"Screen Shot 2020-12-23 at 11 37 31 AM\" /></p>\n\n<h3 id=\"trigger-via-rest-api\">Trigger via REST API</h3>\n\n<p>And here is a <code class=\"language-plaintext highlighter-rouge\">curl</code> request to trigger the workflow via REST API, with the parameters needed (PAT token omitted).</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>curl \\\n    -X POST \\\n    -H \"Accept: application/vnd.github.v3+json\" \\\n    https://api.github.com/repos/eneko/eneko.github.io/actions/workflows/4476169/dispatches \\\n    -d '{\"ref\":\"main\", \"inputs\": { \"name\":\"Command Line User\", \"home\":\"CLI\" }}'\n</code></pre></div></div>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103032501-04acdf00-4515-11eb-9b3e-c180afccd1e3.png\" alt=\"Screen Shot 2020-12-23 at 11 49 46 AM\" /></p>\n\n<p>And voila! We can now trigger a workflow via API 🎉</p>\n\n<h2 id=\"next-steps\">Next steps</h2>\n\n<p>The flow is getting close to complete:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103033057-6f124f00-4516-11eb-9a28-8904f9e90e9a.png\" alt=\"flow\" /></p>\n\n<ul>\n  <li>Configure GitHub action to push Issue updates to Amazon SQS (#1) ✅</li>\n  <li>Configure an AWS Lambda to process the incoming messages (#2) ✅</li>\n  <li>Retrieve entire issue details via GitHub Graph API, or embed in message (#3 &amp; #4) ✅</li>\n  <li>Automate creation of blog post on GitHub pages (via direct commit, or pull request)</li>\n  <li>Send me a notification via email or SMS with the url of the new blog post (using AWS SNS)</li>\n  <li>Potentially store a mapping of GitHub issues to blog URLs (and file paths) on a DynamoDB table</li>\n</ul>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/7\">Issue #7</a>)</small></i></p>",
      "summary": "<p>So, as the title says, here is my plan for getting my GitHub Pages site updated: trigger a workflow from Lambda, and have the workflow pull the new updates (either from a remote repo in CodeCommit, an S3 bucket, or maybe an API Gateway). For this last part, I’ll probably use <a href=\"https://github.com/marketplace/actions/github-push\">GitHub Push</a>, or a similar action, to commit and push the changes to the GitHub Pages repo.</p>\n\n<h2 id=\"manually-triggering-a-github-actions-workflow\">Manually triggering a GitHub Actions workflow</h2>\n\n<p>Using <a href=\"https://docs.github.com/en/free-pro-team@latest/actions/reference/events-that-trigger-workflows#workflow_dispatch\"><code class=\"language-plaintext highlighter-rouge\">on: workflow_dispatch</code></a> we can manually trigger a workflow, either from the GitHub site, or via REST API. We can also provide input values, which is perfect for my plan: publish a new post or update an existing one.</p>\n\n<blockquote>\n  <p>You can manually trigger a workflow run using the GitHub API and from GitHub. For more information, see “<a href=\"https://docs.github.com/en/free-pro-team@latest/actions/managing-workflow-runs/manually-running-a-workflow\">Manually running a workflow.</a>”\n[…]\nTo trigger the custom workflow_dispatch webhook event using the REST API, you must send a POST request to a GitHub API endpoint and provide the ref and any required inputs. For more information, see the “<a href=\"https://docs.github.com/en/free-pro-team@latest/rest/reference/actions/#create-a-workflow-dispatch-event\">Create a workflow dispatch event</a>” REST API endpoint.</p>\n</blockquote>\n\n<p>To test this, I’ve added the example workflow from the documentation to my GitHub Pages repo.</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Manually triggered workflow</span>\n<span class=\"na\">on</span><span class=\"pi\">:</span>\n  <span class=\"na\">workflow_dispatch</span><span class=\"pi\">:</span>\n    <span class=\"na\">inputs</span><span class=\"pi\">:</span>\n      <span class=\"na\">name</span><span class=\"pi\">:</span>\n        <span class=\"na\">description</span><span class=\"pi\">:</span> <span class=\"s1\">'</span><span class=\"s\">Person</span><span class=\"nv\"> </span><span class=\"s\">to</span><span class=\"nv\"> </span><span class=\"s\">greet'</span>\n        <span class=\"na\">required</span><span class=\"pi\">:</span> <span class=\"no\">true</span>\n        <span class=\"na\">default</span><span class=\"pi\">:</span> <span class=\"s1\">'</span><span class=\"s\">Mona</span><span class=\"nv\"> </span><span class=\"s\">the</span><span class=\"nv\"> </span><span class=\"s\">Octocat'</span>\n      <span class=\"na\">home</span><span class=\"pi\">:</span>\n        <span class=\"na\">description</span><span class=\"pi\">:</span> <span class=\"s1\">'</span><span class=\"s\">location'</span>\n        <span class=\"na\">required</span><span class=\"pi\">:</span> <span class=\"no\">false</span>\n        <span class=\"na\">default</span><span class=\"pi\">:</span> <span class=\"s1\">'</span><span class=\"s\">The</span><span class=\"nv\"> </span><span class=\"s\">Octoverse'</span>\n\n<span class=\"na\">jobs</span><span class=\"pi\">:</span>\n  <span class=\"na\">say_hello</span><span class=\"pi\">:</span>\n    <span class=\"na\">runs-on</span><span class=\"pi\">:</span> <span class=\"s\">ubuntu-latest</span>\n    <span class=\"na\">steps</span><span class=\"pi\">:</span>\n    <span class=\"pi\">-</span> <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"pi\">|</span>\n        <span class=\"s\">echo \"Hello $!\"</span>\n        <span class=\"s\">echo \"- in $!\"</span>\n</code></pre></div></div>\n\n<h3 id=\"trigger-from-github-console\">Trigger from GitHub console</h3>\n\n<p>Input parameters can be defined when running the workflow from the GitHub console:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103031646-17beaf80-4513-11eb-947f-db581101eb7b.png\" alt=\"Screen Shot 2020-12-23 at 11 35 52 AM\" /></p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103031742-43da3080-4513-11eb-9a7a-83fbc31b84c6.png\" alt=\"Screen Shot 2020-12-23 at 11 37 31 AM\" /></p>\n\n<h3 id=\"trigger-via-rest-api\">Trigger via REST API</h3>\n\n<p>And here is a <code class=\"language-plaintext highlighter-rouge\">curl</code> request to trigger the workflow via REST API, with the parameters needed (PAT token omitted).</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>curl \\\n    -X POST \\\n    -H \"Accept: application/vnd.github.v3+json\" \\\n    https://api.github.com/repos/eneko/eneko.github.io/actions/workflows/4476169/dispatches \\\n    -d '{\"ref\":\"main\", \"inputs\": { \"name\":\"Command Line User\", \"home\":\"CLI\" }}'\n</code></pre></div></div>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103032501-04acdf00-4515-11eb-9b3e-c180afccd1e3.png\" alt=\"Screen Shot 2020-12-23 at 11 49 46 AM\" /></p>\n\n<p>And voila! We can now trigger a workflow via API 🎉</p>\n\n<h2 id=\"next-steps\">Next steps</h2>\n\n<p>The flow is getting close to complete:</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103033057-6f124f00-4516-11eb-9a28-8904f9e90e9a.png\" alt=\"flow\" /></p>\n\n<ul>\n  <li>Configure GitHub action to push Issue updates to Amazon SQS (#1) ✅</li>\n  <li>Configure an AWS Lambda to process the incoming messages (#2) ✅</li>\n  <li>Retrieve entire issue details via GitHub Graph API, or embed in message (#3 &amp; #4) ✅</li>\n  <li>Automate creation of blog post on GitHub pages (via direct commit, or pull request)</li>\n  <li>Send me a notification via email or SMS with the url of the new blog post (using AWS SNS)</li>\n  <li>Potentially store a mapping of GitHub issues to blog URLs (and file paths) on a DynamoDB table</li>\n</ul>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/7\">Issue #7</a>)</small></i></p>",
      "date_published": "2020-12-23T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-4",
      "url": "https://www.enekoalonso.com/articles/issue-4",
      "title": "Blog Engine - Sending entire GitHub Actions contexts to SQS",
      "content_html": "<p>Rather than digging through the <a href=\"https://docs.github.com/en/free-pro-team@latest/actions/reference/context-and-expression-syntax-for-github-actions#github-context\"><code class=\"language-plaintext highlighter-rouge\">github</code> context</a> in YAML, I decided to use <a href=\"https://docs.github.com/en/free-pro-team@latest/actions/reference/context-and-expression-syntax-for-github-actions#tojson\"><code class=\"language-plaintext highlighter-rouge\">toJSON()</code></a> to encode the entire context and send it to Amazon SQS.</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"na\">message</span><span class=\"pi\">:</span> <span class=\"s\">${ { toJSON(github) }}</span>\n</code></pre></div></div>\n\n<p>Still not sure if that will provide enough information to identify the <a href=\"https://docs.github.com/en/free-pro-team@latest/actions/reference/events-that-trigger-workflows#issues\">Activity Type</a> being performed in the issue.</p>\n\n<h4 id=\"update\">Update</h4>\n<p>It’s been a busy day, but now I’m back at it. After testing this new flow, sending the entire JSON payload to SQS, looks like <code class=\"language-plaintext highlighter-rouge\">github.event.action</code> contains the Activity Type. This means that with a single workflow, I can control on the AWS side how to react depending if action being taken in the issue (<code class=\"language-plaintext highlighter-rouge\">opened</code>, <code class=\"language-plaintext highlighter-rouge\">edited</code>, <code class=\"language-plaintext highlighter-rouge\">closed</code>, <code class=\"language-plaintext highlighter-rouge\">labeled</code>, <code class=\"language-plaintext highlighter-rouge\">unlabeled</code>…).</p>\n\n<p>Eventually I want to look into issue comments, but for that, I’ll probably define a separate workflow. We will see.</p>\n\n<h4 id=\"update-2\">Update 2</h4>\n<p>It seems I won’t be using my <a href=\"https://github.com/eneko/github\">GitHub Graph API client</a>, at least not for now, since the SQS message will contain the entire event, including all issue details.</p>\n\n<h2 id=\"next-steps\">Next steps</h2>\n\n<ul>\n  <li>Configure GitHub action to push Issue updates to Amazon SQS (<a href=\"https://github.com/eneko/Blog/issues/1\">#1</a>) ✅</li>\n  <li>Configure an AWS Lambda to process the incoming messages (<a href=\"https://github.com/eneko/Blog/issues/2\">#2</a>) ✅</li>\n  <li>Retrieve entire issue details via GitHub Graph API, or embed in message (<a href=\"https://github.com/eneko/Blog/issues/3\">#3</a> &amp; <a href=\"https://github.com/eneko/Blog/issues/4\">#4</a>) ✅</li>\n  <li>Automate creation of blog post on GitHub pages (via direct commit, or pull request) (<a href=\"https://github.com/eneko/Blog/issues/7\">#7</a> &amp; <a href=\"https://github.com/eneko/Blog/issues/9\">#9</a>) ✅</li>\n  <li>Send me a notification via email or SMS with the url of the new blog post (using AWS SNS)</li>\n  <li>Potentially store a mapping of GitHub issues to blog URLs (and file paths) on a DynamoDB table</li>\n</ul>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/4\">Issue #4</a>)</p>\n    <p>First draft: 2020-12-22</p>\n    <p>Published on: 2020-12-23</p>\n    <p>Last update: 2021-01-05</p>\n</div>",
      "summary": "<p>Rather than digging through the <a href=\"https://docs.github.com/en/free-pro-team@latest/actions/reference/context-and-expression-syntax-for-github-actions#github-context\"><code class=\"language-plaintext highlighter-rouge\">github</code> context</a> in YAML, I decided to use <a href=\"https://docs.github.com/en/free-pro-team@latest/actions/reference/context-and-expression-syntax-for-github-actions#tojson\"><code class=\"language-plaintext highlighter-rouge\">toJSON()</code></a> to encode the entire context and send it to Amazon SQS.</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"na\">message</span><span class=\"pi\">:</span> <span class=\"s\">${ { toJSON(github) }}</span>\n</code></pre></div></div>\n\n<p>Still not sure if that will provide enough information to identify the <a href=\"https://docs.github.com/en/free-pro-team@latest/actions/reference/events-that-trigger-workflows#issues\">Activity Type</a> being performed in the issue.</p>\n\n<h4 id=\"update\">Update</h4>\n<p>It’s been a busy day, but now I’m back at it. After testing this new flow, sending the entire JSON payload to SQS, looks like <code class=\"language-plaintext highlighter-rouge\">github.event.action</code> contains the Activity Type. This means that with a single workflow, I can control on the AWS side how to react depending if action being taken in the issue (<code class=\"language-plaintext highlighter-rouge\">opened</code>, <code class=\"language-plaintext highlighter-rouge\">edited</code>, <code class=\"language-plaintext highlighter-rouge\">closed</code>, <code class=\"language-plaintext highlighter-rouge\">labeled</code>, <code class=\"language-plaintext highlighter-rouge\">unlabeled</code>…).</p>\n\n<p>Eventually I want to look into issue comments, but for that, I’ll probably define a separate workflow. We will see.</p>\n\n<h4 id=\"update-2\">Update 2</h4>\n<p>It seems I won’t be using my <a href=\"https://github.com/eneko/github\">GitHub Graph API client</a>, at least not for now, since the SQS message will contain the entire event, including all issue details.</p>\n\n<h2 id=\"next-steps\">Next steps</h2>\n\n<ul>\n  <li>Configure GitHub action to push Issue updates to Amazon SQS (<a href=\"https://github.com/eneko/Blog/issues/1\">#1</a>) ✅</li>\n  <li>Configure an AWS Lambda to process the incoming messages (<a href=\"https://github.com/eneko/Blog/issues/2\">#2</a>) ✅</li>\n  <li>Retrieve entire issue details via GitHub Graph API, or embed in message (<a href=\"https://github.com/eneko/Blog/issues/3\">#3</a> &amp; <a href=\"https://github.com/eneko/Blog/issues/4\">#4</a>) ✅</li>\n  <li>Automate creation of blog post on GitHub pages (via direct commit, or pull request) (<a href=\"https://github.com/eneko/Blog/issues/7\">#7</a> &amp; <a href=\"https://github.com/eneko/Blog/issues/9\">#9</a>) ✅</li>\n  <li>Send me a notification via email or SMS with the url of the new blog post (using AWS SNS)</li>\n  <li>Potentially store a mapping of GitHub issues to blog URLs (and file paths) on a DynamoDB table</li>\n</ul>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/4\">Issue #4</a>)</p>\n    <p>First draft: 2020-12-22</p>\n    <p>Published on: 2020-12-23</p>\n    <p>Last update: 2021-01-05</p>\n</div>",
      "date_published": "2020-12-23T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-3",
      "url": "https://www.enekoalonso.com/articles/issue-3",
      "title": "Blog Engine - Updating my Github Actions workflow to push more content to SQS",
      "content_html": "<p>Following with my blog engine project (see #1 and #2), I’ve updated my GitHub Actions trigger as follows:</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">New Issue</span>\n\n<span class=\"na\">on</span><span class=\"pi\">:</span>\n  <span class=\"na\">issues</span><span class=\"pi\">:</span>\n    <span class=\"na\">types</span><span class=\"pi\">:</span> <span class=\"pi\">[</span><span class=\"nv\">opened</span><span class=\"pi\">,</span> <span class=\"nv\">edited</span><span class=\"pi\">]</span>\n\n  <span class=\"c1\"># Allows you to run this workflow manually from the Actions tab</span>\n  <span class=\"na\">workflow_dispatch</span><span class=\"pi\">:</span>\n\n<span class=\"na\">jobs</span><span class=\"pi\">:</span>\n  <span class=\"na\">pushToSNS</span><span class=\"pi\">:</span>\n    <span class=\"na\">runs-on</span><span class=\"pi\">:</span> <span class=\"s\">ubuntu-latest</span>\n    <span class=\"na\">if</span><span class=\"pi\">:</span> <span class=\"s\">${ { github.event.issue.user.login == github.repository_owner }}</span> <span class=\"c1\"># only owner issues</span>\n    <span class=\"na\">steps</span><span class=\"pi\">:</span>\n      <span class=\"pi\">-</span> <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">aws-actions/configure-aws-credentials@v1</span>\n        <span class=\"na\">with</span><span class=\"pi\">:</span>\n          <span class=\"na\">aws-access-key-id</span><span class=\"pi\">:</span> <span class=\"s\">${ { secrets.AWS_ACCESS_KEY_ID }}</span>\n          <span class=\"na\">aws-secret-access-key</span><span class=\"pi\">:</span> <span class=\"s\">${ { secrets.AWS_SECRET_ACCESS_KEY }}</span>\n          <span class=\"na\">aws-region</span><span class=\"pi\">:</span> <span class=\"s\">us-east-2</span>\n\n      <span class=\"pi\">-</span> <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">isbang/sqs-action@v0.1.1</span>\n        <span class=\"na\">with</span><span class=\"pi\">:</span>\n          <span class=\"na\">sqs-url</span><span class=\"pi\">:</span> <span class=\"s\">https://sqs.us-west-2.amazonaws.com/855037544458/blog-issue-updates</span>\n          <span class=\"na\">message</span><span class=\"pi\">:</span> <span class=\"s1\">'</span><span class=\"s\">{</span><span class=\"nv\"> </span><span class=\"s\">\"issueId\":</span><span class=\"nv\"> </span><span class=\"s\">${</span><span class=\"nv\"> </span><span class=\"s\">{github.event.issue.number}},</span><span class=\"nv\"> </span><span class=\"s\">\"user\":</span><span class=\"nv\"> </span><span class=\"s\">\"${</span><span class=\"nv\"> </span><span class=\"s\">{github.event.issue.user.login}}\",</span><span class=\"nv\"> </span><span class=\"s\">\"event\":</span><span class=\"nv\"> </span><span class=\"s\">\"$\",</span><span class=\"nv\"> </span><span class=\"s\">\"action\":</span><span class=\"nv\"> </span><span class=\"s\">\"${</span><span class=\"nv\"> </span><span class=\"s\">{github.action}}\"</span><span class=\"nv\"> </span><span class=\"s\">}'</span>\n</code></pre></div></div>\n\n<p>First, I’ve added a check to ensure the issue author is the same as the repository owner. This means only issues I create will trigger the workflow and end up on my blog. This is achieved by the following line:</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"na\">if</span><span class=\"pi\">:</span> <span class=\"s\">${ { github.event.issue.user.login == github.repository_owner }}</span> <span class=\"c1\"># only owner issues</span>\n</code></pre></div></div>\n\n<p>Next, I’ve updated the JSON payload to include the event name and the action. The event name matches the expected <code class=\"language-plaintext highlighter-rouge\">issues</code> event, but the action is not what I expected:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code> body: \"{ \\\"issueId\\\": 2, \\\"user\\\": \\\"eneko\\\", \\\"event\\\": \\\"issues\\\", \\\"action\\\": \\\"isbangsqs-action\\\" }\"\n</code></pre></div></div>\n\n<p>I’m trying to identify if the issue is being created or updated. I could have two separate workflows instead, and hardcode the value, but I would expect the <a href=\"https://docs.github.com/en/free-pro-team@latest/actions/reference/events-that-trigger-workflows#issues\">event activity type</a> to be somewhere in the <a href=\"https://docs.github.com/en/free-pro-team@latest/actions/reference/context-and-expression-syntax-for-github-actions#github-context\">event object</a>.</p>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/3\">Issue #3</a>)</p>\n    <p>First draft: 2020-12-21</p>\n    <p>Published on: 2020-12-23</p>\n    <p>Last update: 2021-01-05</p>\n</div>",
      "summary": "<p>Following with my blog engine project (see #1 and #2), I’ve updated my GitHub Actions trigger as follows:</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">New Issue</span>\n\n<span class=\"na\">on</span><span class=\"pi\">:</span>\n  <span class=\"na\">issues</span><span class=\"pi\">:</span>\n    <span class=\"na\">types</span><span class=\"pi\">:</span> <span class=\"pi\">[</span><span class=\"nv\">opened</span><span class=\"pi\">,</span> <span class=\"nv\">edited</span><span class=\"pi\">]</span>\n\n  <span class=\"c1\"># Allows you to run this workflow manually from the Actions tab</span>\n  <span class=\"na\">workflow_dispatch</span><span class=\"pi\">:</span>\n\n<span class=\"na\">jobs</span><span class=\"pi\">:</span>\n  <span class=\"na\">pushToSNS</span><span class=\"pi\">:</span>\n    <span class=\"na\">runs-on</span><span class=\"pi\">:</span> <span class=\"s\">ubuntu-latest</span>\n    <span class=\"na\">if</span><span class=\"pi\">:</span> <span class=\"s\">${ { github.event.issue.user.login == github.repository_owner }}</span> <span class=\"c1\"># only owner issues</span>\n    <span class=\"na\">steps</span><span class=\"pi\">:</span>\n      <span class=\"pi\">-</span> <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">aws-actions/configure-aws-credentials@v1</span>\n        <span class=\"na\">with</span><span class=\"pi\">:</span>\n          <span class=\"na\">aws-access-key-id</span><span class=\"pi\">:</span> <span class=\"s\">${ { secrets.AWS_ACCESS_KEY_ID }}</span>\n          <span class=\"na\">aws-secret-access-key</span><span class=\"pi\">:</span> <span class=\"s\">${ { secrets.AWS_SECRET_ACCESS_KEY }}</span>\n          <span class=\"na\">aws-region</span><span class=\"pi\">:</span> <span class=\"s\">us-east-2</span>\n\n      <span class=\"pi\">-</span> <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">isbang/sqs-action@v0.1.1</span>\n        <span class=\"na\">with</span><span class=\"pi\">:</span>\n          <span class=\"na\">sqs-url</span><span class=\"pi\">:</span> <span class=\"s\">https://sqs.us-west-2.amazonaws.com/855037544458/blog-issue-updates</span>\n          <span class=\"na\">message</span><span class=\"pi\">:</span> <span class=\"s1\">'</span><span class=\"s\">{</span><span class=\"nv\"> </span><span class=\"s\">\"issueId\":</span><span class=\"nv\"> </span><span class=\"s\">${</span><span class=\"nv\"> </span><span class=\"s\">{github.event.issue.number}},</span><span class=\"nv\"> </span><span class=\"s\">\"user\":</span><span class=\"nv\"> </span><span class=\"s\">\"${</span><span class=\"nv\"> </span><span class=\"s\">{github.event.issue.user.login}}\",</span><span class=\"nv\"> </span><span class=\"s\">\"event\":</span><span class=\"nv\"> </span><span class=\"s\">\"$\",</span><span class=\"nv\"> </span><span class=\"s\">\"action\":</span><span class=\"nv\"> </span><span class=\"s\">\"${</span><span class=\"nv\"> </span><span class=\"s\">{github.action}}\"</span><span class=\"nv\"> </span><span class=\"s\">}'</span>\n</code></pre></div></div>\n\n<p>First, I’ve added a check to ensure the issue author is the same as the repository owner. This means only issues I create will trigger the workflow and end up on my blog. This is achieved by the following line:</p>\n\n<div class=\"language-yaml highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"na\">if</span><span class=\"pi\">:</span> <span class=\"s\">${ { github.event.issue.user.login == github.repository_owner }}</span> <span class=\"c1\"># only owner issues</span>\n</code></pre></div></div>\n\n<p>Next, I’ve updated the JSON payload to include the event name and the action. The event name matches the expected <code class=\"language-plaintext highlighter-rouge\">issues</code> event, but the action is not what I expected:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code> body: \"{ \\\"issueId\\\": 2, \\\"user\\\": \\\"eneko\\\", \\\"event\\\": \\\"issues\\\", \\\"action\\\": \\\"isbangsqs-action\\\" }\"\n</code></pre></div></div>\n\n<p>I’m trying to identify if the issue is being created or updated. I could have two separate workflows instead, and hardcode the value, but I would expect the <a href=\"https://docs.github.com/en/free-pro-team@latest/actions/reference/events-that-trigger-workflows#issues\">event activity type</a> to be somewhere in the <a href=\"https://docs.github.com/en/free-pro-team@latest/actions/reference/context-and-expression-syntax-for-github-actions#github-context\">event object</a>.</p>\n\n<hr />\n\n<div class=\"post-closure\">\n    <p>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/3\">Issue #3</a>)</p>\n    <p>First draft: 2020-12-21</p>\n    <p>Published on: 2020-12-23</p>\n    <p>Last update: 2021-01-05</p>\n</div>",
      "date_published": "2020-12-23T00:00:00.000Z"
    },
    {
      "guid": "https://www.enekoalonso.com/articles/issue-6",
      "url": "https://www.enekoalonso.com/articles/issue-6",
      "title": "Blog Engine - Rendering Jekyll posts in Swift",
      "content_html": "<p>Now that we have a <a href=\"#5\">Lambda with the details of the GitHub issue loaded</a>, we can render the content into a post for GitHub Pages.</p>\n\n<h3 id=\"post-renderer\">Post Renderer</h3>\n\n<p><code class=\"language-plaintext highlighter-rouge\">PostRenderer</code> handles generation of the Markdown content for the GitHub Pages (Jekyll) blog post. Currently, it looks like this, though I’ll probably update the template as needed. Note I’m including GitHub issue tags both as keywords and <a href=\"https://jekyllrb.com/docs/posts/#tags\">Jekyll tags</a>, which have slightly different formatting. Since GitHub labels can have spaces, I’m replacing those with hyphens.</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">public</span> <span class=\"kd\">struct</span> <span class=\"kt\">PostRenderer</span> <span class=\"p\">{</span>\n\n    <span class=\"kd\">static</span> <span class=\"k\">let</span> <span class=\"nv\">formatter</span><span class=\"p\">:</span> <span class=\"kt\">DateFormatter</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n        <span class=\"k\">let</span> <span class=\"nv\">dateFormatter</span> <span class=\"o\">=</span> <span class=\"kt\">DateFormatter</span><span class=\"p\">()</span>\n        <span class=\"n\">dateFormatter</span><span class=\"o\">.</span><span class=\"n\">locale</span> <span class=\"o\">=</span> <span class=\"kt\">Locale</span><span class=\"p\">(</span><span class=\"nv\">identifier</span><span class=\"p\">:</span> <span class=\"s\">\"en_US_POSIX\"</span><span class=\"p\">)</span>\n        <span class=\"n\">dateFormatter</span><span class=\"o\">.</span><span class=\"n\">timeZone</span> <span class=\"o\">=</span> <span class=\"kt\">TimeZone</span><span class=\"p\">(</span><span class=\"nv\">secondsFromGMT</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n        <span class=\"n\">dateFormatter</span><span class=\"o\">.</span><span class=\"n\">dateFormat</span> <span class=\"o\">=</span> <span class=\"s\">\"yyyy-MM-dd'T'HH:mm:ssZ\"</span>\n        <span class=\"k\">return</span> <span class=\"n\">dateFormatter</span>\n    <span class=\"p\">}()</span>\n\n    <span class=\"kd\">public</span> <span class=\"nf\">init</span><span class=\"p\">()</span> <span class=\"p\">{}</span>\n\n    <span class=\"kd\">public</span> <span class=\"kd\">func</span> <span class=\"nf\">render</span><span class=\"p\">(</span><span class=\"nv\">issue</span><span class=\"p\">:</span> <span class=\"kt\">GitHubIssue</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">String</span> <span class=\"p\">{</span>\n        <span class=\"k\">let</span> <span class=\"nv\">labels</span> <span class=\"o\">=</span> <span class=\"n\">issue</span><span class=\"o\">.</span><span class=\"n\">labels</span><span class=\"o\">.</span><span class=\"n\">map</span> <span class=\"p\">{</span> <span class=\"nv\">$0</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"o\">.</span><span class=\"nf\">replacingOccurrences</span><span class=\"p\">(</span><span class=\"nv\">of</span><span class=\"p\">:</span> <span class=\"s\">\" \"</span><span class=\"p\">,</span> <span class=\"nv\">with</span><span class=\"p\">:</span> <span class=\"s\">\"-\"</span><span class=\"p\">)</span> <span class=\"p\">}</span>\n        <span class=\"k\">let</span> <span class=\"nv\">tags</span> <span class=\"o\">=</span> <span class=\"n\">labels</span><span class=\"o\">.</span><span class=\"nf\">joined</span><span class=\"p\">(</span><span class=\"nv\">separator</span><span class=\"p\">:</span> <span class=\"s\">\" \"</span><span class=\"p\">)</span>\n        <span class=\"k\">let</span> <span class=\"nv\">keywords</span> <span class=\"o\">=</span> <span class=\"n\">labels</span><span class=\"o\">.</span><span class=\"nf\">joined</span><span class=\"p\">(</span><span class=\"nv\">separator</span><span class=\"p\">:</span> <span class=\"s\">\", \"</span><span class=\"p\">)</span>\n        <span class=\"k\">let</span> <span class=\"nv\">post</span> <span class=\"o\">=</span> <span class=\"s\">\"\"\"\n                  ---\n                  layout: post\n                  title: </span><span class=\"se\">\\(</span><span class=\"n\">issue</span><span class=\"o\">.</span><span class=\"n\">title</span><span class=\"se\">)</span><span class=\"s\">\n                  permalink: /articles/:title\n                  date: </span><span class=\"se\">\\(</span><span class=\"k\">Self</span><span class=\"o\">.</span><span class=\"n\">formatter</span><span class=\"o\">.</span><span class=\"nf\">string</span><span class=\"p\">(</span><span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">issue</span><span class=\"o\">.</span><span class=\"n\">createdAt</span><span class=\"p\">)</span><span class=\"se\">)</span><span class=\"s\">\n                  keywords: </span><span class=\"se\">\\(</span><span class=\"n\">keywords</span><span class=\"se\">)</span><span class=\"s\">\n                  tags: </span><span class=\"se\">\\(</span><span class=\"n\">tags</span><span class=\"se\">)</span><span class=\"s\">\n                  issue: </span><span class=\"se\">\\(</span><span class=\"n\">issue</span><span class=\"o\">.</span><span class=\"n\">number</span><span class=\"se\">)</span><span class=\"s\">\n                  ---\n\n                  </span><span class=\"se\">\\(</span><span class=\"n\">issue</span><span class=\"o\">.</span><span class=\"n\">body</span><span class=\"se\">)</span><span class=\"s\">\n\n                  ---\n\n                  &lt;i&gt;&lt;small&gt;This article was written as an issue on my Blog repository on GitHub (see &lt;a target=\"</span><span class=\"n\">_blank</span><span class=\"s\">\" href=\"</span><span class=\"nv\">https</span><span class=\"p\">:</span><span class=\"c1\">//github.com/eneko/Blog/issues/\\(issue.number)\"&gt;Issue #\\(issue.number)&lt;/a&gt;)&lt;/small&gt;&lt;/i&gt;</span>\n                  <span class=\"s\">\"\"\"\n        return post\n    }\n}\n</span></code></pre></div></div>\n\n<h3 id=\"next-steps\">Next Steps</h3>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103015904-0b782980-44f6-11eb-87e8-62ff7e3648a5.png\" alt=\"flow\" /></p>\n\n<p>Still need to find a way to push the new/updated file to the GitHub repo. Some options are:</p>\n<ul>\n  <li>Use <code class=\"language-plaintext highlighter-rouge\">git</code> shell commands on Lambda (not trivial, and quite messy)</li>\n  <li>Start a container job to run the shell commands</li>\n  <li>Submit the file via GitHub REST API (as blob, and then commit)</li>\n  <li>Use <a href=\"https://docs.aws.amazon.com/codecommit/latest/APIReference/API_PutFile.html\"><code class=\"language-plaintext highlighter-rouge\">PutFile</code></a> on AWS CodeCommit API (pretty clean!) to commit the updates, then have GitHub sync from upstream/remote via Webhook.</li>\n</ul>\n\n<p>Will keep working on it and figure out the best approach.</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/6\">Issue #6</a>)</small></i></p>",
      "summary": "<p>Now that we have a <a href=\"#5\">Lambda with the details of the GitHub issue loaded</a>, we can render the content into a post for GitHub Pages.</p>\n\n<h3 id=\"post-renderer\">Post Renderer</h3>\n\n<p><code class=\"language-plaintext highlighter-rouge\">PostRenderer</code> handles generation of the Markdown content for the GitHub Pages (Jekyll) blog post. Currently, it looks like this, though I’ll probably update the template as needed. Note I’m including GitHub issue tags both as keywords and <a href=\"https://jekyllrb.com/docs/posts/#tags\">Jekyll tags</a>, which have slightly different formatting. Since GitHub labels can have spaces, I’m replacing those with hyphens.</p>\n\n<div class=\"language-swift highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kd\">public</span> <span class=\"kd\">struct</span> <span class=\"kt\">PostRenderer</span> <span class=\"p\">{</span>\n\n    <span class=\"kd\">static</span> <span class=\"k\">let</span> <span class=\"nv\">formatter</span><span class=\"p\">:</span> <span class=\"kt\">DateFormatter</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n        <span class=\"k\">let</span> <span class=\"nv\">dateFormatter</span> <span class=\"o\">=</span> <span class=\"kt\">DateFormatter</span><span class=\"p\">()</span>\n        <span class=\"n\">dateFormatter</span><span class=\"o\">.</span><span class=\"n\">locale</span> <span class=\"o\">=</span> <span class=\"kt\">Locale</span><span class=\"p\">(</span><span class=\"nv\">identifier</span><span class=\"p\">:</span> <span class=\"s\">\"en_US_POSIX\"</span><span class=\"p\">)</span>\n        <span class=\"n\">dateFormatter</span><span class=\"o\">.</span><span class=\"n\">timeZone</span> <span class=\"o\">=</span> <span class=\"kt\">TimeZone</span><span class=\"p\">(</span><span class=\"nv\">secondsFromGMT</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n        <span class=\"n\">dateFormatter</span><span class=\"o\">.</span><span class=\"n\">dateFormat</span> <span class=\"o\">=</span> <span class=\"s\">\"yyyy-MM-dd'T'HH:mm:ssZ\"</span>\n        <span class=\"k\">return</span> <span class=\"n\">dateFormatter</span>\n    <span class=\"p\">}()</span>\n\n    <span class=\"kd\">public</span> <span class=\"nf\">init</span><span class=\"p\">()</span> <span class=\"p\">{}</span>\n\n    <span class=\"kd\">public</span> <span class=\"kd\">func</span> <span class=\"nf\">render</span><span class=\"p\">(</span><span class=\"nv\">issue</span><span class=\"p\">:</span> <span class=\"kt\">GitHubIssue</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">String</span> <span class=\"p\">{</span>\n        <span class=\"k\">let</span> <span class=\"nv\">labels</span> <span class=\"o\">=</span> <span class=\"n\">issue</span><span class=\"o\">.</span><span class=\"n\">labels</span><span class=\"o\">.</span><span class=\"n\">map</span> <span class=\"p\">{</span> <span class=\"nv\">$0</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"o\">.</span><span class=\"nf\">replacingOccurrences</span><span class=\"p\">(</span><span class=\"nv\">of</span><span class=\"p\">:</span> <span class=\"s\">\" \"</span><span class=\"p\">,</span> <span class=\"nv\">with</span><span class=\"p\">:</span> <span class=\"s\">\"-\"</span><span class=\"p\">)</span> <span class=\"p\">}</span>\n        <span class=\"k\">let</span> <span class=\"nv\">tags</span> <span class=\"o\">=</span> <span class=\"n\">labels</span><span class=\"o\">.</span><span class=\"nf\">joined</span><span class=\"p\">(</span><span class=\"nv\">separator</span><span class=\"p\">:</span> <span class=\"s\">\" \"</span><span class=\"p\">)</span>\n        <span class=\"k\">let</span> <span class=\"nv\">keywords</span> <span class=\"o\">=</span> <span class=\"n\">labels</span><span class=\"o\">.</span><span class=\"nf\">joined</span><span class=\"p\">(</span><span class=\"nv\">separator</span><span class=\"p\">:</span> <span class=\"s\">\", \"</span><span class=\"p\">)</span>\n        <span class=\"k\">let</span> <span class=\"nv\">post</span> <span class=\"o\">=</span> <span class=\"s\">\"\"\"\n                  ---\n                  layout: post\n                  title: </span><span class=\"se\">\\(</span><span class=\"n\">issue</span><span class=\"o\">.</span><span class=\"n\">title</span><span class=\"se\">)</span><span class=\"s\">\n                  permalink: /articles/:title\n                  date: </span><span class=\"se\">\\(</span><span class=\"k\">Self</span><span class=\"o\">.</span><span class=\"n\">formatter</span><span class=\"o\">.</span><span class=\"nf\">string</span><span class=\"p\">(</span><span class=\"nv\">from</span><span class=\"p\">:</span> <span class=\"n\">issue</span><span class=\"o\">.</span><span class=\"n\">createdAt</span><span class=\"p\">)</span><span class=\"se\">)</span><span class=\"s\">\n                  keywords: </span><span class=\"se\">\\(</span><span class=\"n\">keywords</span><span class=\"se\">)</span><span class=\"s\">\n                  tags: </span><span class=\"se\">\\(</span><span class=\"n\">tags</span><span class=\"se\">)</span><span class=\"s\">\n                  issue: </span><span class=\"se\">\\(</span><span class=\"n\">issue</span><span class=\"o\">.</span><span class=\"n\">number</span><span class=\"se\">)</span><span class=\"s\">\n                  ---\n\n                  </span><span class=\"se\">\\(</span><span class=\"n\">issue</span><span class=\"o\">.</span><span class=\"n\">body</span><span class=\"se\">)</span><span class=\"s\">\n\n                  ---\n\n                  &lt;i&gt;&lt;small&gt;This article was written as an issue on my Blog repository on GitHub (see &lt;a target=\"</span><span class=\"n\">_blank</span><span class=\"s\">\" href=\"</span><span class=\"nv\">https</span><span class=\"p\">:</span><span class=\"c1\">//github.com/eneko/Blog/issues/\\(issue.number)\"&gt;Issue #\\(issue.number)&lt;/a&gt;)&lt;/small&gt;&lt;/i&gt;</span>\n                  <span class=\"s\">\"\"\"\n        return post\n    }\n}\n</span></code></pre></div></div>\n\n<h3 id=\"next-steps\">Next Steps</h3>\n\n<p><img src=\"https://user-images.githubusercontent.com/32922/103015904-0b782980-44f6-11eb-87e8-62ff7e3648a5.png\" alt=\"flow\" /></p>\n\n<p>Still need to find a way to push the new/updated file to the GitHub repo. Some options are:</p>\n<ul>\n  <li>Use <code class=\"language-plaintext highlighter-rouge\">git</code> shell commands on Lambda (not trivial, and quite messy)</li>\n  <li>Start a container job to run the shell commands</li>\n  <li>Submit the file via GitHub REST API (as blob, and then commit)</li>\n  <li>Use <a href=\"https://docs.aws.amazon.com/codecommit/latest/APIReference/API_PutFile.html\"><code class=\"language-plaintext highlighter-rouge\">PutFile</code></a> on AWS CodeCommit API (pretty clean!) to commit the updates, then have GitHub sync from upstream/remote via Webhook.</li>\n</ul>\n\n<p>Will keep working on it and figure out the best approach.</p>\n\n<hr />\n\n<p><i><small>This article was written as an issue on my Blog repository on GitHub (see <a target=\"_blank\" href=\"https://github.com/eneko/Blog/issues/6\">Issue #6</a>)</small></i></p>",
      "date_published": "2020-12-22T00:00:00.000Z"
    }
  ]
}